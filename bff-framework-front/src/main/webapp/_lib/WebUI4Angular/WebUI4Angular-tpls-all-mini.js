angular.module("ui.wisoft",["ui.wisoft.tpls","ui.wisoft.position","ui.wisoft.transition","ui.wisoft.bindHtml","ui.wisoft.popup","ui.wisoft.resizelistener","ui.wisoft.dialog","ui.wisoft.collapse","ui.wisoft.menu","ui.wisoft.imageview","ui.wisoft.progress","ui.wisoft.common","ui.wisoft.alert","ui.wisoft.fileupload","ui.wisoft.carousel","ui.wisoft.accordion","ui.wisoft.messagetip","ui.wisoft.my97datepicker","ui.wisoft.panel","ui.wisoft.combobox","ui.wisoft.popupbutton","ui.wisoft.button","ui.wisoft.datagrid","ui.wisoft.camerascanner","ui.wisoft.searchinput","ui.wisoft.tabset","ui.wisoft.tilelist","ui.wisoft.tooltip","ui.wisoft.dividedbox","ui.wisoft.tree"]),angular.module("ui.wisoft.tpls",["template/accordion/wi-accordion-group.html","template/accordion/wi-accordion.html","template/button/wi-button.html","template/camerascanner/camerascannerTemplate.html","template/imageview/imageviewTemplate.html","template/carousel/carousel.html","template/carousel/slide.html","template/combobox/comboboxTemplate.html","template/datagrid/datagridTemplate.html","template/dividedbox/wi-dividedbox-group.html","template/dividedbox/wi-dividedbox.html","template/fileupload/wi-fileupload.html","template/imageview/imageviewTemplate.html","template/menu/wi-menu.html","template/panel/wi-panel.html","template/popupbutton/popupbuttonTemplate.html","template/tree/treeTemplate.html","template/progress/wi-progress.html","template/searchinput/wi-searchinput.html","template/tebset/tabsetTemplate.html","template/tebset/tabTemplate.html","template/tilelist/tilelistTemplate.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/tree/treeTemplate.html"]),angular.module("ui.wisoft.alert",["ui.wisoft.dialog"]).factory("wiAlert",["$q","wiDialog",function(e,t){var i={showAlert:function(i,n){var o,a,l;o=angular.isString(i)?i:i.content,a={info:"icon-info-sign",error:"icon-remove-sign",warn:"icon-exclamation-sign",success:"icon-ok-sign",confirm:"icon-question-sign"},l={info:"提示",warn:"警告",error:"失败",success:"成功",confirm:"提示"};var r=['<div class="wi-clearf">','<div class="wi-alert-icon" ><span class="'+(i.iconClass||a[n])+'"></span></div>','<div class="wi-alert-simple-cont" >'+o+"</div></div>",'<div class="wi-alert-toolbar">','<input type="button" value='+(i.yesLabel||"确定")+' ng-click=confirm("YES") class="wi-btn" /></div>'];"confirm"===n&&r.splice(4,0,'<input type="button" value='+(i.noLabel||"取消")+' ng-click=confirm("NO") class="wi-btn wi-dialog-okClose" />');var s={closeByEscape:!1,closeByDocument:!1,overlay:!0,dialogInIframe:!1,plain:!0,title:i.title||l[n],withoutHead:!1,width:i.width||300,template:r.join("")},c=e.defer(),d=angular.noop,p=angular.noop;return c.promise=t.openConfirm(s),c.promise.yes=function(e){return d=e,c.promise},c.promise.no=function(e){return p=e,c.promise},c.promise.then(function(e){"YES"===e?d():"NO"===e?p():angular.noop()}),c.promise}},n={info:function(e){return i.showAlert(e,"info")},warn:function(e){return i.showAlert(e,"warn")},error:function(e){return i.showAlert(e,"error")},success:function(e){return i.showAlert(e,"success")},confirm:function(e){return i.showAlert(e,"confirm")}};return n}]),angular.module("ui.wisoft.accordion",["ui.wisoft.collapse","ui.wisoft.resizelistener"]).constant("accordionConfig",{emptyHeight:2,headHeight:32}).controller("AccordionController",["$scope","$attrs","$element","$log","accordionConfig",function(e,t,i,n,o){var a=this,l=void 0;!function(){var i=function(t){if(t){var i;return i=/^(?:[1-9]\d*|0)(?:.\d+)?/.test(t)?t:e.$eval(t),Number(i)&&(i+="px"),i}};e.ac_width=i(t.width,'warn: accordion 的 width="'+t.width+'"定义不合法!'),l=e.ac_height=i(t.height,'warn: accordion 的 height="'+t.height+'"定义不合法!'),l&&l.indexOf("%")>0&&(e.ac_hIsPCT=!0)}(),a.headHeight=e.$eval(t.headheight),!angular.isNumber(a.headHeight)&&(a.headHeight=o.headHeight);var r=l?!0:e.$eval(t.oneopen)||!1;a.groups=[],a.panelStyle={};var s=[];a.closeOthers=function(e){r&&1!=e.byOther&&angular.forEach(a.groups,function(t){t!==e&&t.isOpen&&(t.isOpen=!1,t.byOther=!0)})},a.adjust=function(e){if(l){var t=a.groups.indexOf(e);t==a.groups.length-1?a.groups[t-1].isOpen||(a.groups[t-1].isOpen=!0,a.groups[t-1].byOther=!0):a.groups[t+1].isOpen||(a.groups[t+1].isOpen=!0,a.groups[t+1].byOther=!0)}},a.addGroup=function(e,t){e.panelStyle=a.panelStyle,angular.isDefined(t)?a.groups.splice(t,0,e):a.groups.push(e),e.isOpen&&s.push(e),r&&s.length>1&&(s[0].isOpen&&(s[0].isOpen=!1,s[0].byOther=!0),s.shift()),l&&0==s.length&&(a.groups[0].isOpen||(a.groups[0].isOpen=!0,a.groups.length>1&&(a.groups[0].byOther=!0)),s.push(a.groups[0])),c()},a.removeGroup=function(e){var t=a.groups.indexOf(e);-1!==t&&a.groups.splice(t,1),c()};var c=l?function(){var t=a.groups.length;if(e.ac_hIsPCT){var n=.01*parseInt(l)*i[0].parentElement.clientHeight;a.panelStyle.cheight=n-(t*a.headHeight+o.emptyHeight)+"px"}else a.panelStyle.cheight="calc("+l+" - "+(t*a.headHeight+o.emptyHeight)+"px)"}:angular.noop;a.resizeH=function(){c(),a.groups.map(function(e){e.panelStyle.cheight=a.panelStyle.cheight})}}]).directive("wiAccordion",["wiResizeListener","$timeout",function(e,t){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!0,scope:{wiid:"=",onselect:"&",onunselect:"&"},templateUrl:"template/accordion/wi-accordion.html",link:function(i,n,o,a){a.onSelect=i.onselect(),a.onUnselect=i.onunselect(),i.ac_width&&n.css("width",i.ac_width),t(a.resizeH,0);var l=function(){e.addResizeListener(n[0].parentElement,function(){i.$evalAsync(a.resizeH)})};i.ac_hIsPCT&&l(),o.wiid&&angular.isObject(i.wiid)&&angular.extend(i.wiid,{element:function(){return n},options:function(){return{width:i.ac_width,height:i.ac_height}},panels:function(){return a.groups},getSelect:function(){for(var e=a.groups,t=0;t<e.length;t++)if(e[t].isOpen)return e[t]},getGroup:function(e){var t=a.groups;if(angular.isNumber(e))return t[e];for(var i=0;i<t.length;i++)if(t[i].heading==e)return t[i]},toggle:function(e){var t=a.groups;if(angular.isNumber(e))return t[e].isOpen=!t[e].isOpen,void 0;for(var i=0;i<t.length;i++)if(t[i].heading==e)return t[i].isOpen=!t[i].isOpen,void 0},reCompute:i.ac_hIsPCT?function(){l()}:angular.noop}),a.acLinked=!0}}}]).directive("wiAccordionGroup",function(){return{require:"^wiAccordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/wi-accordion-group.html",scope:{heading:"@",isOpen:"=?"},controller:function(){var e=this;e.setHeading=function(t){e.heading=t}},link:function(e,t,i,n){angular.isUndefined(e.isOpen)&&(e.isOpen=!1),e.byOther=!1,e.style={headheight:n.headHeight?n.headHeight+"px":void 0};var o=void 0;n.acLinked&&angular.forEach(t[0].parentElement.children,function(e,i){e==t[0]&&(o=i)}),n.addGroup(e,o),e.$watch("isOpen",function(t,i){var o=n.groups.indexOf(e);t?n.onSelect&&n.onSelect(o,e):n.onUnselect&&n.onUnselect(o,e),e.byOther?e.byOther=!1:t!==i&&(t?n.closeOthers(e):n.adjust(e))}),e.toggleOpen=function(){e.isOpen=!e.isOpen},e.$on("$destroy",function(){n.removeGroup(e)})}}}).directive("wiAccordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^wiAccordionGroup",link:function(e,t,i,n,o){n.setHeading(o(e,function(){}))}}}).directive("wiAccordionTransclude",function(){return{require:"^wiAccordionGroup",link:function(e,t,i,n){e.$watch(function(){return n[i.wiAccordionTransclude]},function(e){e&&(t.html(""),t.append(e))})}}}),angular.module("ui.wisoft.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(e,t,i){t.addClass("ng-binding").data("$binding",i.bindHtmlUnsafe),e.$watch(i.bindHtmlUnsafe,function(e){e&&("string"==typeof e?t.html(e||""):t.empty().append(e))})}}),angular.module("ui.wisoft.button",[]).directive("wiButton",[function(){return{restrict:"E",templateUrl:"template/button/wi-button.html",replace:!0,transclude:!0,scope:{},link:function(e,t,i){var n=e.$parent,o=function(e){if(e){var t;return t=/^(?:[1-9]\d*|0)(?:.\d+)?/.test(e)?e:n.$eval(e),Number(t)&&(t+="px"),t}};e.btnOptions={label:i.label||"",width:o(i.width)||null,height:o(i.height)||null,iconl:i.iconl||"",iconr:i.iconr||"",type:i.witype||"button"},e.btnOptions.width&&e.btnOptions.height&&t.css("overflow","hidden"),i.hasOwnProperty("disabled")&&"false"!=i.disabled&&(t[0].disabled=!0),t[0].setAttribute("type",e.btnOptions.type)}}}]),angular.module("ui.wisoft.camerascanner",["ui.wisoft.alert","ui.wisoft.dialog","ui.wisoft.imageview"]).directive("wiCamerascanner",["wiAlert","wiDialog",function(e,t){return{restrict:"E",transclude:!0,templateUrl:"template/camerascanner/camerascannerTemplate.html",replace:!0,scope:{url:"@",uploadcomplete:"&",topdf:"@"},link:function(i,n){function o(e){h=document.createElement("select");for(var t=e.length-1;t>=0;t--){var i=e[t];i=i.substring(0,i.indexOf(" ("));var n=new Option(i,t);h.add(n)}h.onchange=function(){var e=h.options[h.options.selectedIndex].value;s.selectCamera(e)},u.appendChild(h),u.style.visibility="visible"}function a(){if(20===v)e.warn("不能超过20张，请分批操作");else{var t=s.prepareCapture();f.style.width="222px",f.style.height=220/t[0]*t[1]+2+"px",p.insertBefore(f,p.firstChild),setTimeout(function(){l(s.capture(null,null,100))},0)}}function l(e){p.removeChild(f);var t=document.createElement("div");t.setAttribute("class","wi-camerascanner-photo"),t.setAttribute("index",v+""),t.setAttribute("id","_cam_list_div_"+v),t.setAttribute("_width",e[1]),t.setAttribute("_height",e[2]);var n=document.createElement("canvas"),o=n.getContext("2d");n.setAttribute("width",e[1]),n.setAttribute("height",e[2]);var a=new Image;a.onload=function(){o.drawImage(a,0,0,e[1],e[2]),n.style.width="220px",n.style.height=220/e[1]*e[2]+"px",t.style.width="222px",t.style.height=220/e[1]*e[2]+2+"px",o.drawImage(o.canvas,0,0),n.onclick=function(){i.$apply(function(){m=Number(t.getAttribute("index")),r(e[1],e[2]),s.style.visibility="hidden"})},t.appendChild(n);var l=document.createElement("a");l.setAttribute("href","javascript:void(0);"),l.setAttribute("class","icon-remove"),l.onclick=function(){i.$apply(function(){var e=Number(t.getAttribute("index"));s.removeImg(e),p.removeChild(t);for(var i=p.children[e];i;)i.setAttribute("index",e),i.setAttribute("id","_cam_list_div_"+e),i=p.children[++e];v--})},t.appendChild(l);var c=document.createElement("div");c.innerHTML="img"+v,c.setAttribute("contenteditable",!0),t.appendChild(c),t.onmouseover=function(){c.style.display="block"},t.onmouseout=function(){c.style.display="none"},p.insertBefore(t,p.firstChild),v++},a.src="data:image/jpg;base64,"+e[0]}function r(){var e=document.getElementById("_cam_list_div_"+m),t=Number(e.getAttribute("_width")),n=Number(e.getAttribute("_height"));i.imagedata=p.children[m].children[0].getContext("2d").getImageData(0,0,t,n)}var s=n.find("OBJECT")[0],c=document.querySelector(".wi-camerascanner-main"),d=angular.element(document.querySelector(".wi-camerascanner")),p=document.querySelector(".wi-camerascanner-list"),u=document.querySelector(".wi-camerascanner-head-select"),f=document.createElement("div");f.setAttribute("class","wi-camerascanner-photo wi-camerascanner-wait");var g=document.querySelector(".wi-camerascanner-btn");window._webcam_={debug:function(e,t){"cams"===e?o(t):i.debug(e,t)}};var h;i.debug=function(t,n){switch(t){case 1:e.error(n);break;case 2:e.error(n);break;case 3:e.error(n);break;case 4:break;case 5:i.close(),e.success("上传成功").yes(function(){i.uploadcomplete()&&i.uploadcomplete()(n)});break;case 6:break;default:console.log(t+": "+n)}},i.open=function(){var e=document.documentElement.clientHeight;c.style["margin-top"]=(e>592?(e-592)/2:2)+"px",d.removeClass("wi-camerascanner-hide");var t;h&&(t=h.options[h.options.selectedIndex].value),s.openCamera(t)},i.close=function(){for(s.closeCamera&&s.closeCamera();p.hasChildNodes();)p.removeChild(p.lastChild);d.addClass("wi-camerascanner-hide"),v=0},i.rotate=function(e){s.rotate(e)},i.resetCut=function(){s.resetCut()},i.camResolution="1200*1600",i.resolution=function(){var e=i.camResolution.split("*");s.resolution(e[0],e[1])},g.addEventListener("click",a,!1);var m,v=0;i.previous=function(){m>0?m--:m=v-1,r()},i.next=function(){v-1>m?m++:m=0,r()},i.viewClose=function(){s.style.visibility="visible"},i.upload=function(){s.style.visibility="hidden",t.openConfirm({template:"cameraScannerConfirm",width:300,title:"请输入文件名"}).then(function(e){e?s.upload&&s.upload(i.url,e,!i.topdf||"false"!=i.topdf):s.style.visibility="visible"},function(){s.style.visibility="visible"})}}}}]),angular.module("ui.wisoft.carousel",["ui.wisoft.transition"]).controller("CarouselController",["$scope","$timeout","$transition",function(e,t,i){function n(){o();var i=+e.interval;!isNaN(i)&&i>=0&&(l=t(a,i))}function o(){l&&(t.cancel(l),l=null)}function a(){r?(e.next(),n()):e.pause()}var l,r,s=this,c=s.slides=e.slides=[],d=-1;s.currentSlide=null;var p=!1;s.select=e.select=function(o,a){function l(){if(!p){if(s.currentSlide&&angular.isString(a)&&!e.noTransition&&o.$element){o.$element.addClass("wi-slide-"+a);{o.$element[0].offsetWidth}angular.forEach(c,function(e){angular.extend(e,{direction:"",entering:!1,leaving:!1,active:!1})}),angular.extend(o,{direction:a,active:!0,entering:!0}),angular.extend(s.currentSlide||{},{direction:a,leaving:!0}),e.$currentTransition=i(o.$element,{}),function(t,i){e.$currentTransition.then(function(){r(t,i)},function(){r(t,i)})}(o,s.currentSlide)}else r(o,s.currentSlide);s.currentSlide=o,d=u,n()}}function r(t,i){angular.extend(t,{direction:"",active:!0,leaving:!1,entering:!1}),angular.extend(i||{},{direction:"",active:!1,leaving:!1,entering:!1}),e.$currentTransition=null}var u=c.indexOf(o);void 0===a&&(a=u>d?"next":"prev"),o&&o!==s.currentSlide&&(e.$currentTransition?(e.$currentTransition.cancel(),t(l)):l())},e.$on("$destroy",function(){p=!0}),s.indexOfSlide=function(e){return c.indexOf(e)},e.next=function(){var t=(d+1)%c.length;return e.$currentTransition?void 0:s.select(c[t],"next")},e.prev=function(){var t=0>d-1?c.length-1:d-1;return e.$currentTransition?void 0:s.select(c[t],"prev")},e.isActive=function(e){return s.currentSlide===e},e.$watch("interval",n),e.$on("$destroy",o),e.play=function(){r||(r=!0,n())},e.pause=function(){e.noPause||(r=!1,o())},s.addSlide=function(t,i){t.$element=i,c.push(t),1===c.length||t.active?(s.select(c[c.length-1]),1==c.length&&e.play()):t.active=!1},s.removeSlide=function(e){var t=c.indexOf(e);c.splice(t,1),c.length>0&&e.active?t>=c.length?s.select(c[t-1]):s.select(c[t]):d>t&&d--}}]).directive("wiCarousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"wiCarousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("wiSlide",function(){return{require:"^wiCarousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?"},link:function(e,t,i,n){n.addSlide(e,t),e.$on("$destroy",function(){n.removeSlide(e)}),e.$watch("active",function(t){t&&n.select(e)})}}}),angular.module("ui.wisoft.collapse",["ui.wisoft.transition"]).directive("wiCollapse",["$transition",function(e){return{link:function(t,i,n){function o(t){function n(){d===o&&(d=void 0)}var o=e(i,t);return d&&d.cancel(),d=o,o.then(n,n),o}function a(){var e=i[0].style.height;return(""==e||"0px"==e)&&(e="auto"),e}function l(){!p&&(p=a()),u||p.indexOf("calc")>=0?(u=!1,r()):(i.removeClass("wi-collapse").addClass("wi-collapsing"),o({height:"auto"==p?i[0].scrollHeight+"px":p}).then(r))}function r(){i.removeClass("wi-collapsing wi-collapse"),i.css({height:p})}function s(){if(!p&&(p=a()),u||p.indexOf("calc")>=0)u=!1,c();else{"auto"==p&&i.css({height:i[0].scrollHeight+"px"});{i[0].offsetWidth}i.addClass("wi-collapsing"),o({height:0}).then(c)}}function c(){i.removeClass("wi-collapsing").addClass("wi-collapse"),i.css({height:0})}var d,p,u=!0;t.$watch(n.wiCollapse,function(e){e?s():l()})}}}]),angular.module("ui.wisoft.combobox",["ui.wisoft.popup"]).constant("comboboxConfig",{liHeight:18,emptyMenuHeight:12}).filter("comboboxFilter",["comboboxService",function(e){return function(t,i,n,o){var a;return i&&0!==i.length?(a=[],angular.forEach(t,function(e){0===e[n].toLowerCase().indexOf(i.toLowerCase())&&a.push(e)})):a=t,o&&(a=e.initData(a,n,o)),a}}]).factory("comboboxService",function(){var e={};return e.initData=function(e,t,i){var n=[],o={};return angular.forEach(e,function(e){if(e[i]&&!o[e[i]]){var a={};a[t]=e[i],a.isGroup=!0,n.push(a),n.push(e),o[e[i]]=a}else n.push(e)}),n},e}).directive("wiCombobox",["$filter","$timeout","comboboxService","comboboxConfig",function(e,t,i,n){return{restrict:"E",templateUrl:"template/combobox/comboboxTemplate.html",replace:!0,scope:{dataprovider:"=",itemrenderer:"@",labelfield:"@",valuefield:"@",groupfield:"@",wimodel:"=",labelfunction:"&",prompt:"@",rowcount:"@",rowheight:"@",selecteditem:"=",editable:"@",multiselect:"@",enable:"@",itemchange:"&"},require:"wiPopup",link:function(o,a,l,r){function s(e){p.isopen||o.$apply(function(){p.isopen=!0,g=!0}),e.stopPropagation()}function c(e){g&&p.isopen&&(g=!1,e.stopPropagation())}var d=o.$parent,p=o.vm={},u=a.find("INPUT");p.labelfield=o.labelfield||"name",p.valuefield=o.valuefield||"value",p.prompt=o.prompt||"--请选择--",p.editable="false"!==o.editable,p.enable=o.enable,p.selecteditem=o.selecteditem||null,p.dataprovider=o.groupfield?i.initData(o.dataprovider,p.labelfield,o.groupfield):o.dataprovider,p.rowcount=Math.min(p.dataprovider.length,o.rowcount||5),o.multiselect&&u.attr("readOnly","true"),!p.editable&&u.attr("readOnly","true"),p.selectedindex=p.selecteditem?p.dataprovider.indexOf(p.selecteditem):-1;var f=d.$eval(l.dropdownwidth);!angular.isNumber(f)&&(f=void 0),function(e){if(e){var t;t=/^(?:[1-9]\d*|0)(?:.\d+)?/.test(e)?e:d.$eval(e),Number(t)?(a.css("width",t+"px"),!f&&(f=t)):a.css("width",t)}}(l.width),r.popupOptions.height=n.emptyMenuHeight+n.liHeight*p.rowcount,r.popupOptions.width=f,p.selecteditem&&(p._text=p.selecteditem[p.labelfield]),void 0!=o.wimodel&&angular.forEach(p.dataprovider,function(e,t){e[p.valuefield]==o.wimodel&&(p._text=e[p.labelfield],p.selectedindex=t)}),l.hasOwnProperty("enable")&&o.$watch("enable",function(e,t){e!==t&&(p.enable="false"===e)});var g=!1;u[0].addEventListener("focus",s),a[0].addEventListener("blur",function(){g=!1}),u[0].addEventListener("click",c),p.itemClickHandler=function(e,t){if(e.isGroup)return t.stopPropagation(),void 0;if(o.multiselect){t.stopPropagation(),e._checked=!e._checked;var i=[],n=[];angular.forEach(o.dataprovider,function(e){e._checked&&(i.push(e[p.labelfield]),n.push(e))}),p.selecteditem=n,p._text=i.join("; ")}else e!=p.selecteditem&&o.itemchange()&&o.itemchange()(e),p.selecteditem=e,p.selectedindex=p.dataprovider.indexOf(p.selecteditem),p._text=e[p.labelfield],o.wimodel=e[p.valuefield]},p.inputChange=function(){t(function(){for(p.dataprovider=e("comboboxFilter")(o.dataprovider,p._text,p.labelfield,o.groupfield),p.isopen||(p.isopen=!0),p.selectedindex=p.dataprovider.length>0&&p._text.length>0?0:-1;p.dataprovider[p.selectedindex]&&p.dataprovider[p.selectedindex].isGroup&&p.selectedindex<p.dataprovider.length;)p.selectedindex++},0)},p.keydownHandler=function(i){var a=i.keyCode;if(38===a){do 0!==p.selectedindex&&-1!==p.selectedindex?p.selectedindex--:p.selectedindex=p.dataprovider.length-1;while(p.dataprovider[p.selectedindex].isGroup&&p.selectedindex>=0)}else if(40===a){do p.selectedindex<p.dataprovider.length-1?p.selectedindex++:p.selectedindex=0;while(p.dataprovider[p.selectedindex].isGroup&&p.selectedindex<p.dataprovider.length)}else{if(13!==a)return;if(p.isopen)p.dataprovider=e("comboboxFilter")(o.dataprovider,"",p.labelfield,o.groupfield),p.selectedindex=p.dataprovider.indexOf(p.selecteditem);else{var l=p.dataprovider[p.selectedindex];p.selecteditem!=l&&o.itemchange()&&o.itemchange()(l),p.selecteditem=l,p.selecteditem&&(p._text=p.selecteditem[p.labelfield])&&(o.wimodel=p.selecteditem[p.valuefield])}}t(function(){r.popupOptions.elem[0].scrollTop=n.liHeight*p.selectedindex})},p.clickHandler=function(){r.popupOptions.elem[0].scrollTop=n.liHeight*p.selectedindex,p.isopen&&(p.dataprovider=e("comboboxFilter")(o.dataprovider,"",p.labelfield,o.groupfield))}}}}]);var wiResetHttpProvider=["$httpProvider",function(e){e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";var t=function(e){var i,n,o,a,l,r,s,c="";for(i in e)if(n=e[i],n instanceof Array)for(s=0;s<n.length;++s)l=n[s],o=i+"["+s+"]",r={},r[o]=l,c+=t(r)+"&";else if(n instanceof Object)for(a in n)l=n[a],o=i+"["+a+"]",r={},r[o]=l,c+=t(r)+"&";else void 0!==n&&null!==n&&(c+=encodeURIComponent(i)+"="+encodeURIComponent(n)+"&");return c.length?c.substr(0,c.length-1):c};e.defaults.transformRequest=[function(e){return angular.isObject(e)&&"[object File]"!==String(e)?t(e):e}]}];angular.module("ui.wisoft.common",[]).config(wiResetHttpProvider).factory("wiCommonSev",[function(){return{getSizeFromAttr:function(e,t){if(e){var i;return/^(?:[1-9]\d*|0)(?:.\d+)?/.test(e)?i=e:t&&(i=t.$eval(e)),Number(i)&&(i+="px"),i}}}}]),angular.module("ui.wisoft.datagrid",["ui.wisoft.bindHtml","ui.wisoft.resizelistener"]).constant("dgConf",{defaultColWidth:120,miniColWidth:60,pageBarHeight:30,headerHeight:50,rowHeight:40,scrollBarSize:17,leftColWidth:30,dragDivWidth:3,dgBorder:1,treeIndent:16}).value("excelTemplate",{worksheet_template:'<?xml version="1.0"?><?mso-application progid="Excel.Sheet"?><Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:html="http://www.w3.org/TR/REC-html40"><Styles><Style ss:ID="Default" ss:Name="Normal"><Alignment ss:Vertical="Center"/><Borders/><Font ss:FontName="宋体" x:CharSet="134" ss:Size="11" ss:Color="#000000"/><Interior/><NumberFormat/><Protection/></Style><Style ss:ID="s62"><NumberFormat ss:Format="Short Date"/></Style><Style ss:ID="s63"><Font ss:FontName="宋体" x:CharSet="134" ss:Size="11" ss:Color="#000000" ss:Bold="1"/></Style></Styles><Worksheet ss:Name="Sheet1"><Table>{{COLUMNS}}{{ROWS}}</Table><WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel"><PageSetup><Header x:Margin="0.3"/><Footer x:Margin="0.3"/><PageMargins x:Bottom="0.75" x:Left="0.7" x:Right="0.7" x:Top="0.75"/></PageSetup><Unsynced/><Selected/><FreezePanes/><FrozenNoSplit/><SplitHorizontal>1</SplitHorizontal><TopRowBottomPane>1</TopRowBottomPane><ActivePane>2</ActivePane><Panes><Pane><Number>3</Number><ActiveRow>2</ActiveRow><ActiveCol>1</ActiveCol></Pane></Panes><ProtectObjects>False</ProtectObjects><ProtectScenarios>False</ProtectScenarios></WorksheetOptions></Worksheet></Workbook>',column_template:'<Column ss:Width="{{WIDTH}}"/>',head_template:'<Row ss:Height="14.25" ss:StyleID="s63">{{CELL}}</Row>',row_template:'<Row ss:AutoFitHeight="0">{{CELL}}</Row>',cell_template:'<Cell><Data ss:Type="String">{{NAME}}</Data></Cell>',cell_template_date:'<Cell ss:StyleID="s62"><Data ss:Type="DateTime">{{NAME}}</Data></Cell>',cell_template_number:'<Cell><Data ss:Type="Number">{{NAME}}</Data></Cell>'}).factory("dgService",["excelTemplate",function(e){return{isEmptyRow:function(e){for(var t in e)return!1;return!0},allChecked:function(e){if(e&&e.length>0)for(var t,i=0;i<e.length;i++)if(t=e[i],!this.isEmptyRow(t)&&!t.__ischecked)return!1;return!0},uncheckAll:function(e){angular.forEach(e,function(e){e.__ischecked=!1})},base64:function(e){return window.btoa(unescape(encodeURIComponent(e)))},isDate:function(e){var t=e+"",i=t.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(null==i)return!1;var n=new Date(i[1],i[3]-1,i[4]);return n.getFullYear()==i[1]&&n.getMonth()+1==i[3]&&n.getDate()==i[4]},table2excel:function(t,i){var n="",o="";angular.forEach(i,function(t){n+=e.column_template.replace("{{WIDTH}}",3*t/4)});for(var a=0,l=t.length;l>a;a++){for(var r=t[a],s="",c=0,d=r.length;d>c;c++)s+=this.isDate(r[c])?e.cell_template_date.replace("{{NAME}}",r[c]+"T00:00:00.000"):angular.isNumber(r[c])?e.cell_template_number.replace("{{NAME}}",r[c]):e.cell_template.replace("{{NAME}}",r[c]);o+=0===a?e.head_template.replace("{{CELL}}",s):e.row_template.replace("{{CELL}}",s)}return e.worksheet_template.replace("{{COLUMNS}}",n).replace("{{ROWS}}",o)},table2excelByIE:function(e,t){var i=null;try{i=new ActiveXObject("Excel.Application")}catch(n){i=new ActiveXObject("ET.Application")}try{var o=i.Workbooks.Add(),a=o.ActiveSheet;angular.forEach(t,function(e,t){a.Columns(t+1).ColumnWidth=e/8});for(var l=0,r=e.length;r>l;l++)for(var s=0,c=e[l].length;c>s;s++)0===l&&(a.Cells(l+1,s+1).Font.Bold=!0,a.Cells(l+1,s+1).Font.Size=11),this.isDate(e[l][s])||angular.isNumber(e[l][s])||(a.Cells(l+1,s+1).NumberFormatLocal="@"),a.Cells(l+1,s+1).value=e[l][s];i.Visible=!0,i.UserControl=!0}catch(n){i.Application.Quit(),console.error(n)}finally{i=null}}}}]).directive("wiDatagrid",["$compile","$templateCache","$http","$timeout","$q","$parse","wiResizeListener","dgService","dgConf",function(e,t,i,n,o,a,l,r,s){return{restrict:"E",transclude:!0,replace:!0,scope:{wiid:"=",columns:"=",itemclick:"&",itemdoubleclick:"&",treefield:"@",itemopen:"&",rowheight:"@",hscrollpolicy:"@",vscrollpolicy:"@",rowcolorfunction:"&",pageselect:"=",dataurl:"@",params:"=",success:"&",error:"&",showexcel:"@",excelexport:"&",showrefresh:"@",pagemode:"@",pagebarrenderer:"@"},templateUrl:"template/datagrid/datagridTemplate.html",controller:["$scope",function(e){e.maxLevel=0,e.heads=[],e.columnDefs=[],this.addColumnDef=function(t){e.columnDefs.push(t)};var t=[];this.addChildCol=function(e){t.push(e)},this.getChildCol=function(){return t.shift()},this.addHeadDef=function(t,i){e.heads.push(t),i>e.maxLevel&&(e.maxLevel=i)}}],link:function(t,c,d,p){var u=c.children(),f=u.eq(0),g=u.eq(1),h=u.eq(2),m=u.eq(3),v=u.eq(4),w=u.eq(5),b=u.eq(6),x=u.eq(7),_=t.columnDefs,y=s.defaultColWidth,C=window.document,$=c[0].parentElement,k=t.params||{},E=[],S=[],z=void 0,O=t.pagedata=[],T=d.width,D=d.height;angular.isNumber(T)||(Number(T)?T=Number(T):angular.isString(T)&&-1!=T.indexOf("%")||(T="100%")),angular.isNumber(D)||(Number(D)?D=Number(D):angular.isString(D)&&-1!=D.indexOf("%")||(D="100%")),c.css({width:T+(angular.isNumber(T)?"px":""),height:D+(angular.isNumber(D)?"px":"")});var H={topHeight:t.$eval(d.headerheight)||s.headerHeight,pagebarHeight:t.$eval(d.pagebarHeight)||s.pageBarHeight,leftWidth:0,rightWidth:0},N=angular.isNumber(T)&&angular.isNumber(D),A=r.isEmptyRow,P=function(){if(t.columns){var e,i=function(t,n){angular.forEach(t,function(t){var o;t.children?(o={level:n.level+1,parent:n,type:"childGroup",text:t.headtext||"",colspan:0,children:[]},i(t.children,o),0==o.colspan&&(o.colspan=1),n.colspan+=o.colspan):(o={level:n.level+1,parent:n,type:"childColumn",text:t.headtext||"",colspan:1,datafield:t.datafield,itemrenderer:t.itemrenderer,headrenderer:t.headrenderer,width:t.width,sortable:t.sortable,align:t.align||"center"},n.colspan++,p.addColumnDef(o)),o.level>e&&(e=o.level),n.children.push(o)})};angular.forEach(t.columns,function(t){var n;t.children?(e=1,n={level:1,type:"topGroup",text:t.headtext||"",colspan:0,children:[]},i(t.children,n),n.maxLevel=e,0==n.colspan&&(n.colspan=1)):(n={level:1,type:"topColumn",text:t.headtext||"",colspan:1,datafield:t.datafield,itemrenderer:t.itemrenderer,headrenderer:t.headrenderer,width:t.width,sortable:t.sortable,align:t.align||"center"},p.addColumnDef(n),e=1),p.addHeadDef(n,e)})}},G=function(){if(t.rightW=0,t.lockcolumns=Math.min(t.$eval(d.lockcolumns)||0,_.length),t._wordwrap=t.lockcolumns>0?!1:t.$eval(d.wordwrap),t.isCheckAll=!1,t.showno=t.$eval(d.showno)||!1,t.multiselect=t.$eval(d.multiselect)||!1,t.selectedPageSize=t.pageselect?t.pageselect[0]:20,t.pageNum=1,t.pageStart=(t.pageNum-1)*t.selectedPageSize+1,t.pageCount=1,t.dataCount=0,t.$watch("selectedPageSize",function(e,t){e!=t&&n(function(){q()})}),t.collapse="false"!=d.collapse,t._rowheight=t.rowheight||s.rowHeight,t.lblFuns=function(){var e={};return angular.forEach(_,function(t){t.labfunction&&(e[t.datafield]=t.labfunction())}),e}(),t.dataurl)t.dataprovider=void 0;else{var e,i=t.$parent;if(d.dataprovider){var o=a(d.dataprovider);e=o.assign,t.dataprovider=o(i),e&&i.$watch(o,function(e,i){e!==i&&(t.dataprovider=e)})}else t.dataprovider=[];t.$watchCollection("dataprovider",function(n,o){n!=o&&(t.dataprovider||(t.dataprovider=[]),0==t.dataprovider.length?(t.isclear=!0,O.length=0):(q(),t.isclear?t.dataCount=0:null,t.isclear=!1),e&&e(i,n))})}},M=function(){for(var e=[],i=0;i<t.maxLevel;)e[i++]=[];return e},R=function(e,i){angular.forEach(e,function(e){switch(e.type){case"topColumn":e.datafield==t.treefield&&(e.align="left"),e.colindex=J++,e.rowspan=t.maxLevel;break;case"topGroup":e.colindex=J,e.rowspan=t.maxLevel-e.maxLevel+1,R(e.children,i+e.rowspan);break;case"childColumn":e.datafield==t.treefield&&(e.align="left"),e.colindex=J++,e.rowspan=t.maxLevel-i;break;case"childGroup":e.colindex=J,e.rowspan=1,R(e.children,i+e.rowspan)}Z[i].push(e)})},L=function(){var i,n,o=t.treefield,a=s.treeIndent,l=0,r=function(e,t){for(var l="",r=e;t>r;r++)i=_[r],l+='<td style="text-align:'+i.align+'">',i.itemrenderer?l+="<span ng-include src=\"'"+i.itemrenderer+"'\"></span></td>":(o&&i.datafield==o&&(l+='<span ng-if="pdata[\'__level\']" style="display:inline-block;" ng-style="{width:('+a+"*pdata['__level'])+'px'}\"></span>",l+="<span ng-if=\"!!pdata['children']\" class=\"treespan icon-{{pdata['__close']?'plus':'minus'}}\"></span>",l+='<span ng-if="pdata[\'__loading\']" class="wi-datagrid-tree-loading"></span>'),i.labfunction?(n=i.datafield+"_lblFun",l+='<span bind-html-unsafe=lblFuns["'+i.datafield+'"](pdata)></span></td>'):l+="<span>{{pdata['"+i.datafield+"']}}</span></td>");return l},d=function(){var e="";return t.showno&&(l++,e+='<td class="wi-datagrid-keycol"><span ng-if="pdata">{{pdata["__index"]}}</span></td>'),t.multiselect&&(l++,e+='<td class="wi-datagrid-keycol"><input ng-if="pdata[\'__level\']==0" type="checkbox" class="wi-checkbox" ng-checked="pdata.__ischecked" /></td>'),l+=t.lockcolumns,e+=r(0,t.lockcolumns)},p=function(){var e="",i=0;return t.lockcolumns?i=t.lockcolumns:(t.showno&&(e+='<td class="wi-datagrid-keycol"><span ng-if="pdata">{{pdata["__index"]}}</span></td>'),t.multiselect&&(e+='<td class="wi-datagrid-keycol"><input ng-if="pdata[\'__level\']==0" type="checkbox" class="wi-checkbox" ng-checked="pdata.__ischecked" /></td>')),e+=r(i,_.length)};t.lockcolumns>0&&(h.find("tr").eq(0).attr("ng-repeat","pdata in pagedata track by $index").attr("ng-if",'!pdata["__hide"]').attr("data-dg-pindex","{{::$index}}").html(d()),h.find("tr").eq(1).find("td").attr("colspan",l)),m.find("tr").eq(0).attr("ng-repeat","pdata in pagedata track by $index").attr("ng-if",'!pdata["__hide"]').attr("data-dg-pindex","{{::$index}}").html(p()),x.remove(),e(c)(t)},W=function(e){if(e!==!0&&(e=!1),e||!N){var i=function(){var i,n,o=0,a=0,l=0;if(angular.forEach(_,function(i,n){if(e){var a=i.width;angular.isNumber(a)?E.push(a):angular.isString(a)?/^\s*\d+\.?\d*%\s*$/.test(a)?E.push(a):/^\s*\d+\.?\d*\s*$/.test(a)?(a=Number(a),E.push(a)):(a=void 0,E.push(a),S.push(n)):(a=void 0,E.push(a),S.push(n))}var l=E[n];angular.isString(l)&&(l=Math.round(t._width*Number(l.replace("%",""))/100)),angular.isDefined(l)&&(i.width=l,o+=l)}),t.multiselect&&(a+=s.leftColWidth),t.showno&&(a+=s.leftColWidth),o+=a,n=t._width-s.scrollBarSize-o,i=Math.floor(n/S.length),y>i?angular.forEach(S,function(e){_[e].width=y,o+=y,n-=y}):angular.forEach(S,function(e,t){t==S.length-1?(_[e].width=n,o+=n,n=0):(_[e].width=i,o+=i,n-=i)}),t.lockcolumns){l+=a;for(var r=t.lockcolumns-1;r>-1;r--)l+=Number(_[r].width)}H.leftWidth=l,H.rightWidth=t._width-l,t.rightW=o-l};e?(t._width=(angular.isString(T)?Math.round($.clientWidth*Number(T.replace("%",""))/100):T)-2*s.dgBorder,t._height=(angular.isString(D)?Math.round($.clientHeight*Number(D.replace("%",""))/100):D)-2*s.dgBorder,i(),m.css("overflow-x",t.hscrollpolicy||"auto")):(angular.isString(T)&&(t._width=Math.round($.clientWidth*Number(T.replace("%",""))/100)-2*s.dgBorder,i()),angular.isString(D)&&(t._height=Math.round($.clientHeight*Number(D.replace("%",""))/100)-2*s.dgBorder));
var n=H.topHeight,o=H.leftWidth,a=H.pagebarHeight,l=t._height-n-a;f.css({width:o+"px",height:n+"px"}),g.css({width:H.rightWidth+"px",height:n+"px",left:o+"px"}),h.css({width:o+"px",height:l+"px",top:n+"px"}),m.css({width:H.rightWidth+"px",height:l+"px",top:n+"px",left:o+"px"}),v.css({height:a+"px",lineHeight:a-5+"px",top:t._height-a+"px"})}},B=function(){m[0].scrollLeft=0,m[0].scrollTop=0},I=function(e){var i=t.pageNum,n=t.selectedPageSize;t.pageStart=(i-1)*n+1;var o=[];if(O.length=0,"none"===t.pagemode||"server"===t.pagemode)o=z;else{var a=(i-1)*n;o=z.slice(a,a+n)}if(t.treefield?!function s(e,i){for(var n=0;n<e.length;n++){var o=e[n];if(A(o))return;i?(o.__hide=t.collapse,o.__level=i):(o.__index=t.pageStart+n,o.__level=0),O.push(o),o.children&&(o.__close=t.collapse,s(o.children,o.__level+1))}}(o):angular.forEach(o,function(e,i){A(e)||(e.__index=t.pageStart+i,e.__level=0,O.push(e))}),t.isCheckAll=r.allChecked(O),d.rowcolorfunction){var l=t.rowcolorfunction();angular.forEach(O,function(e){A(e)?null:e.__rowcolor=l(e)})}e&&e.resolve("success")},F=function(e,n){var o=t.selectedPageSize;angular.extend(k,{start:o*(e-1),limit:"server"===t.pagemode?o:-1}),i.post(t.dataurl,k).success(function(e){e.success?(0==k.start&&(t.dataCount=e.data.total,t.pageCount=Math.max(Math.ceil(e.data.total/o),1)),z=e.data.rows,n.resolve("success")):console.error("wiDataGrid",e.msg)})},q=function(){b.css("visibility","visible");var e=o.defer(),i=1;z=void 0,t.pageNum=i,t.dataurl?F(i,e):(z=t.dataprovider,!z&&(z=[]),t.dataCount=z.length,t.pageCount=Math.max(Math.ceil(t.dataCount/t.selectedPageSize),1),e.resolve("success")),e.promise.then(function(){I(),B(),b.css("visibility","hidden")})};t.dorefresh=function(){q()},t.doPage=function(e){if(e=Math.min(e,t.pageCount),e=Math.max(e,1),e!=t.pageNum){b.css("visibility","visible"),t.pageNum=e;var i=o.defer();"server"===t.pagemode?F(e,i):i.resolve("success"),i.promise.then(function(){I(),B(),b.css("visibility","hidden")})}},t.gotoPage=function(e){13==e.keyCode&&t.doPage(parseInt(angular.element(e.target).val()))},t.sortcolumn={datafield:void 0,direction:void 0},t.sort=function(e){var i=t.columnDefs[e];if(i.sortable){var n=i.datafield;t.sortcolumn.datafield==n?t.sortcolumn.direction=-t.sortcolumn.direction:(t.sortcolumn.datafield=n,t.sortcolumn.direction=1),z.sort(function(e,i){var o=e[n],a=i[n],l=t.sortcolumn.direction;return a>o?-l:o>a?l:0}),I()}},t.checkAll=function(){for(var e=t.isCheckAll=!t.isCheckAll,i=O.length-1;i>-1;i--)A(O[i])?null:O[i].__ischecked=e};var U=function(){t.wiid&&angular.isObject(t.wiid)&&(t.wiid.getSelectedItems=function(){var e=[];return angular.forEach(O,function(t){t.__ischecked?e.push(t):null}),e},t.wiid.getSelectedItem=function(){for(var e=0;e<O.length;e++)if(O[e].__ischecked)return O[e]},t.wiid.refresh=function(){t.dorefresh()},t.wiid.reCompute=N?angular.noop:function(){V()})},j=function(){var e,i,n,o=s.miniColWidth,a=null,l=0,r=function(i){if(a&&e){var r=i.clientX-l,c=a.getBoundingClientRect(),d=Math.max(c.right+r,c.left+o)-Math.ceil(s.dragDivWidth/2)-n;d>t._width||w.css("left",d+"px")}},d=function(n){if(a&&e){var s,p=e.colindex,u=_[p].width;s=Math.max(u+n.clientX-l,o);var v=S.indexOf(p);v>=0&&S.splice(v,1),E[p]=s;var b=s-u;_[e.colindex].width=s,i?(H.leftWidth+=b,H.rightWidth-=b,f.css({width:H.leftWidth+"px"}),g.css({width:H.rightWidth+"px",left:H.leftWidth+"px"}),h.css({width:H.leftWidth+"px"}),m.css({width:H.rightWidth+"px",left:H.leftWidth+"px"})):t.rightW+=b,t.$digest(),a=e=void 0,w.css("display","none"),c.removeClass("wi-resizing wi-unselectable"),c[0].removeEventListener("mousemove",r),C.removeEventListener("mouseup",d)}};t.startColumnDrag=function(o,p,u){a&&(i=u,n=c[0].getBoundingClientRect().left+s.dgBorder,l=o.clientX,w.css({left:a.getBoundingClientRect().right-n-Math.ceil(s.dragDivWidth/2)+"px",display:"block",height:t._height-H.pagebarHeight+"px"}),c.addClass("wi-resizing wi-unselectable"),e=p,C.addEventListener("mousemove",r),C.addEventListener("mouseup",d))},t.headMousemove=function(t){if(!e){for(var i=t.target,n=t.clientX;"TD"!=i.tagName;){if("BODY"==i.tagName)return c.removeClass("wi-resizing"),a=void 0,void 0;i=i.parentNode}var o=i.getBoundingClientRect();n>o.right-s.dragDivWidth&&n<=o.right?(c.addClass("wi-resizing"),a=i):(c.removeClass("wi-resizing"),a=void 0)}},t.headMouseleave=function(){a&&e||c.removeClass("wi-resizing")}},X=function(){var e={currentTop:0,currentleft:0};m[0].addEventListener("scroll",function(t){var i=t.target;i.scrollTop!=e.currentTop&&(e.currentTop=h[0].scrollTop=i.scrollTop),i.scrollLeft!=e.currentleft&&(e.currentleft=g[0].scrollLeft=i.scrollLeft)})},Y=function(){var e=function(e,i){if(e.__loading=!1,angular.isArray(i)){var n=O.indexOf(e);angular.forEach(i,function(t){t.children&&(t.__close=!0),t.__hide=!1,t.__level=e.__level?e.__level+1:1,O.splice(n+1,0,t),n++}),e.children=i}t.$digest()},i=function(i){i.__close=!i.__close,i.children&&0==i.children.length&&!i.__close&&t.itemopen()?(i.__loading=!0,t.itemopen()(i,e)):!function n(e,t){angular.forEach(e,function(e){e.__hide=t||!e.__hide,i.__close&&e.children&&!e.children.__close&&(e.__close=!0,n(e.children,!0))})}(i.children)},n=function(e){var n=e.target;if(n){for(var o=(" "+n.className+" ").indexOf("treespan")>=0;"TR"!=n.tagName&&n.parentElement;)n=n.parentElement;if("TR"==n.tagName&&null!=n.getAttribute("data-dg-pindex")){var a=Number(n.getAttribute("data-dg-pindex")),l=O[a];A(l)||(o?(e.stopPropagation(),i(l),t.$digest()):(l.__ischecked||t.multiselect||r.uncheckAll(O),l.__ischecked=!l.__ischecked,t.isCheckAll=r.allChecked(O),t.$digest(),d.itemclick&&t.itemclick()(l,e)))}}},o=function(e){var i=e.target;if(i){for(;"TR"!=i.tagName&&i.parentElement;)i=i.parentElement;if("TR"==i.tagName&&null!=i.getAttribute("data-dg-pindex")){var n=Number(i.getAttribute("data-dg-pindex")),o=O[n];A(o)||d.itemdoubleclick&&t.itemdoubleclick()(o)}}};d.itemdoubleclick&&(h[0].addEventListener("dblclick",o),m[0].addEventListener("dblclick",o)),h[0].addEventListener("click",n),m[0].addEventListener("click",n)};t.export2excel=function(e){var i=[],n=[],o=[];if(angular.forEach(t.columnDefs,function(e){n.push(e.text),o.push(e.width)}),i.push(n),angular.forEach(O,function(e){n=[],angular.forEach(t.columnDefs,function(t){t.labfunction?n.push(t.labfunction()(e)):n.push(e[t.datafield])}),i.push(n)}),navigator.userAgent.indexOf("MSIE")>0)r.table2excelByIE(i,o);else{var a="data:application/vnd.ms-excel;base64,";e.currentTarget.href=a+r.base64(r.table2excel(i,o))}};var V=function(){l.addResizeListener($,function(){t.$evalAsync(W)})};P(),H.topHeight*=t.maxLevel,G();var Z=t.headarray=M(),J=0;R(t.heads,0),L(),n(function(){W(!0)},0),q(),U(),j(),X(),Y(),!N&&V()}}}]).directive("wiDatagridColumn",function(){return{restrict:"E",scope:{labfunction:"&"},require:"^wiDatagrid",link:function(e,t,i,n){var o={text:i.headtext,colspan:1,datafield:i.datafield,itemrenderer:i.itemrenderer,headrenderer:i.headrenderer,width:i.width,sortable:i.sortable,align:i.align||"center"};i.labfunction?o.labfunction=e.labfunction:null,"WI-DATAGRID-COLUMN-GROUP"!=t[0].parentElement.tagName?(o.type="topColumn",o.level=1,n.addHeadDef(o,1)):(o.type="childColumn",n.addChildCol(o)),n.addColumnDef(o)}}}).directive("wiDatagridColumnGroup",function(){return{restrict:"E",require:"^wiDatagrid",link:function(e,t,i,n){if("WI-DATAGRID-COLUMN-GROUP"!=t[0].parentElement.tagName){var o={level:1,type:"topGroup",text:i.text||"",colspan:t.find("wi-datagrid-column").length,children:[]},a=1,l=function(e,t){angular.forEach(e,function(e){var i;"WI-DATAGRID-COLUMN-GROUP"==e.tagName?(i={level:t.level+1,type:"childGroup",text:e.getAttribute("TEXT")||"",colspan:angular.element(e).find("wi-datagrid-column").length,children:[]},e.children&&l(e.children,i)):"WI-DATAGRID-COLUMN"==e.tagName&&(i=n.getChildCol(),i.level=t.level+1),i.parent=t,a=Math.max(a,i.level),t.children.push(i)})};l(t[0].children,o),o.maxLevel=a,n.addHeadDef(o,a)}}}}),angular.module("ui.wisoft.dialog",["ui.wisoft.position"]).provider("wiDialog",function(){var e=angular.element,t=angular.isDefined,i=(document.body||document.documentElement).style,n=t(i.animation)||t(i.WebkitAnimation)||t(i.MozAnimation)||t(i.MsAnimation)||t(i.OAnimation),o="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",a=!1,l=this.defaults={plain:!1,showClose:!0,closeByDocument:!1,closeByEscape:!0,overlay:!0};this.setForceBodyReload=function(e){a=e||!1};var r,s=0,c=0,d={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$position",function(t,i,p,u,f,g,h,m,v,w){var b=t.find("body");a&&g.$on("$locationChangeSuccess",function(){b=t.find("body")});var x,_,y,C={onDocumentKeydown:function(e){27===e.keyCode&&$.closeOne("$escape")},setBodyPadding:function(e){var t=parseInt(b.css("padding-right")||0,10);b.css("padding-right",t+e+"px"),b.data("ng-dialog-original-padding",t)},resetBodyPadding:function(){var e=b.data("ng-dialog-original-padding");e?b.css("padding-right",e+"px"):b.css("padding-right","")},closeDialog:function(e,t){var i=e.attr("id");"undefined"!=typeof window.Hammer?window.Hammer(e[0]).off("tap",r):e.unbind("click"),1===c&&b.unbind("keydown"),e.hasClass("wi-dialog-closing")||(c-=1),n?e.unbind(o).bind(o,function(){e.scope().$destroy(),e.remove(),e.css({visiblity:"hidden"}),0===c&&(b.removeClass("wi-dialog-open"),C.resetBodyPadding()),g.$broadcast("wiDialog.closed",e)}).addClass("wi-dialog-closing"):(e.scope().$destroy(),e.remove(),0===c&&(b.removeClass("wi-dialog-open"),C.resetBodyPadding()),g.$broadcast("wiDialog.closed",e)),d[i]&&(d[i].resolve({id:i,value:t,$dialog:e,remainingDialogs:c}),delete d[i])}},$={open:function(t){function n(e){return e?angular.isString(e)&&a.plain?e:i.get(e)||f.get(e,{cache:!0}):"Empty template"}var o=this,a=angular.copy(l);t=t||{},angular.extend(a,t),s+=1,o.latestID="widialog"+s;var k;d[o.latestID]=k=u.defer();var E,S,z=angular.isObject(a.scope)?a.scope.$new():g.$new();return u.when(n(a.template)).then(function(t){t=angular.isString(t)?t:t.data&&angular.isString(t.data)?t.data:"",i.put(a.template,t),o.$result=E=e('<div id="widialog'+s+'" class="wi-dialog" style="z-index:'+w.getZIndex()+'" ></div>');var n=['<div dialog-draggable="wi-dialog-head" id="wiDialogMain'+s+'" class="wi-dialog-main">','<div class="wi-dialog-head">'+(a.title||"")+'<span class="wi-dialog-close icon-remove"></span></div>','<div class="wi-dialog-content">'+t+"</div></div>"];if(a.withoutHead&&(n=['<div id="wiDialogMain'+s+'" class="wi-dialog-main">','<div class="wi-dialog-content">'+t+'<span class="wi-dialog-close icon-remove"></span></div></div>']),E.html(n.join("")),a.overlay===!0&&E.prepend('<div class="wi-dialog-overlay"></div>'),a.controller&&(angular.isString(a.controller)||angular.isFunction(a.controller))){var l=v(a.controller,{$scope:z,$element:E});E.data("$ngDialogControllerController",l)}if(a.data&&angular.isString(a.data)){var d=a.data.replace(/^\s*/,"")[0];z.wiDialogData="{"===d||"["===d?angular.fromJson(a.data):a.data}else a.data&&angular.isObject(a.data)&&(z.wiDialogData=angular.fromJson(angular.toJson(a.data)));return a.dialogInIframe?(S=angular.element(document.body),x=document,_=m,y=b):(S=angular.element(window.top.document.body),x=window.top.document,_=m.top,y=angular.element(x.body)),a.appendTo&&angular.isString(a.appendTo)&&(S=angular.element(x.querySelector(a.appendTo))),z.closeThisDialog=function(e){C.closeDialog(E,e)},h(function(){p(E)(z);var e=_.innerWidth-b.prop("clientWidth"),t=e-(_.innerWidth-b.prop("clientWidth"));t>0&&C.setBodyPadding(t),S.append(E);var i=angular.element(x.querySelector("#wiDialogMain"+s)),n=(angular.element(x.querySelector("#widialog"+s)),{"margin-left":-i.prop("clientWidth")/2+"px","margin-top":-i.prop("clientHeight")/2+"px",visibility:"hidden"});angular.isNumber(a.width)&&(n.width=a.width+"px",n["margin-left"]=-a.width/2+"px"),angular.isNumber(a.height)&&(n.height=a.height+"px",n["margin-top"]=-a.height/2+"px"),i.css(n),h(function(){i.css({"margin-top":-i.prop("clientHeight")/2+"px",visibility:"visible"});var e=i.prop("offsetTop");0>e&&i.css({"margin-top":"0",top:"0",height:i.prop("clientHeight")+2*e+"px"})}),g.$broadcast("wiDialog.opened",E)}),a.closeByEscape&&y.bind("keydown",C.onDocumentKeydown),r=function(t){var i=a.closeByDocument?e(t.target).hasClass("wi-dialog-overlay"):!1,n=e(t.target).hasClass("wi-dialog-close");(i||n)&&$.closeOne(E.attr("id"),n?"$closeButton":"$document")},"undefined"!=typeof window.Hammer?window.Hammer(E[0]).on("tap",r):E.bind("click",r),c+=1,$}),{id:"widialog"+s,closePromise:k.promise,close:function(e){C.closeDialog(E,e)}}},openConfirm:function(e){var t=u.defer(),i={closeByEscape:!1,closeByDocument:!1};angular.extend(i,e),i.scope=angular.isObject(i.scope)?i.scope.$new():g.$new(),i.scope.confirm=function(e){t.resolve(e),n.close(e)};var n=$.open(i);return n.closePromise.then(function(e){return e?t.reject(e.value):t.reject()}),t.promise},closeOne:function(t,i){var n=e(x.getElementById(t));return n.length?C.closeDialog(n,i):$.closeAll(i),$},closeAll:function(t){var i=x.querySelectorAll(".wi-dialog");angular.forEach(i,function(i){C.closeDialog(e(i),t)})}};return $}]}).directive("dialogDraggable",["$document",function(){return function(e,t,i){function n(e){t.css({top:d+e.screenY-s+"px",left:c+e.screenX-r+"px"})}function o(){t.css({cursor:"default"}),p.removeEventListener("mousemove",n),p.removeEventListener("mouseup",o)}var a,l=i.dialogDraggable;l&&angular.forEach(t.children(),function(e){void 0===a&&(" "+e.className+" ").indexOf(l)>=0&&(a=angular.element(e))}),a||(a=t);var r=0,s=0,c=0,d=0,p=window.top.document;a.on("mousedown",function(e){window.getComputedStyle&&(c=window.getComputedStyle(t[0]).left,d=window.getComputedStyle(t[0]).top),c=Number(c.replace("px",""))||0,d=Number(d.replace("px",""))||0,e.preventDefault(),r=e.screenX,s=e.screenY,t.css({cursor:"move"}),p.addEventListener("mousemove",n),p.addEventListener("mouseup",o)})}}]),angular.module("ui.wisoft.dividedbox",["ui.wisoft.transition"]).constant("dividedboxConf",{boxMinSize:100,collapseSize:28,barSize:4}).factory("dividedboxService",["dividedboxConf","$compile",function(e,t){return{dividedboxProductor:function(i){var n,o;return"h"==i?(n="clientX",o="<span class=\"wi-dividedbox-followbar\" ng-style=\"{left: 'calc(' + resizeConf.preSizes + ' + ' + resizeConf.preResizes + 'px)'}\"></span>"):(n="clientY",o="<span class=\"wi-dividedbox-followbar\" ng-style=\"{top : 'calc(' + resizeConf.preSizes + ' + ' + resizeConf.preResizes + 'px)'}\"></span>"),{restrict:"E",templateUrl:function(){return"template/dividedbox/wi-dividedbox.html"},transclude:!0,replace:!0,scope:{},controller:["dividedboxConf","$scope","$transition",function(e,t,n){function o(i){var n=c[i],o="left"==n.dividedboxG.collapseto||"up"==n.dividedboxG.collapseto?1:-1,a=c[i+o];if(1!=a.dividedboxG.collapsed){var l=c[i-o];if(!l||1!=l.dividedboxG.collapsed||l.dividedboxG.collapseto!=n.dividedboxG.collapseto){var r=" + "+n.dividedboxG.user,s=i==t.boxes.length-1?e.collapseSize-e.barSize:e.collapseSize;n.dividedboxG.size="0px",n.dividedboxG.resize=s,a.dividedboxG.size+=r,a.dividedboxG.resize=0-s,n.dividedboxG.collapsed=!n.dividedboxG.collapsed}}}function a(e,t){function i(){f--,e.removeClass("wi-dividedbox-collapsing")}if(!(window.ActiveXObject||"ActiveXObject"in window)){e.addClass("wi-dividedbox-collapsing");var o=n(e,t);return o.then(i,i),o}t(),f--}var l=this;t.type=i;var r="h"==i?"left":"up",s="h"==i?"right":"down",c=t.boxes=[],d=[],p="100%",u=!1;l.addBox=function(e){var i=t.boxes.length;e.initBox(i),c.push(e),""===e.dividedboxG.user?d.push(i):p+=" - "+e.dividedboxG.user;var n="("+p+") / "+d.length.toString();angular.forEach(d,function(e){c[e].dividedboxG.user=c[e].dividedboxG.size=n}),0==i?(u=e.dividedboxG.collapseto?!0:!1,e.dividedboxG.collapseto=void 0,e.dividedboxG.collapsed=!1):(u&&(c[i-1].dividedboxG.collapseto=r,u=!1),e.dividedboxG.collapseto==r&&(e.dividedboxG.collapseto=s,u=!0),angular.forEach(c,function(e){e.dividedboxG.collapsed=!1,e.dividedboxG.resize=0,e.dividedboxG.user&&(e.dividedboxG.size=e.dividedboxG.user)}),angular.forEach(c,function(e,t){e.dividedboxG.collapseto&&e.dividedboxG._collapsed&&o(t)}))},l.removeBox=function(e){if(-1!==e){c.splice(e,1);for(var t=e;t<c.length;t++)c[t].index--}},l.startResize=function(e){if(t.resizeConf.resizable&&0==t.resizeConf.resizing){if(t.boxes[e].dividedboxG.collapsed===!0||t.boxes[e+1].dividedboxG.collapsed===!0)return;t.resizeConf.resizing=!0,t.resizeConf.index=e}};var f=0;l.doCollapse=function(i){if(0==f){var n=c[i],o="left"==n.dividedboxG.collapseto||"up"==n.dividedboxG.collapseto?1:-1,l=c[i+o];if(1!=l.dividedboxG.collapsed){var r=c[i-o];if(!r||1!=r.dividedboxG.collapsed||r.dividedboxG.collapseto!=n.dividedboxG.collapseto){var s=" + "+n.dividedboxG.user,d=i==t.boxes.length-1?e.collapseSize-e.barSize:e.collapseSize;n.dividedboxG.preResize=n.dividedboxG.resize,f+=2,a(n.getElem(),function(){n.dividedboxG.size="0px",n.dividedboxG.resize=d,n.dividedboxG.collapsed=!n.dividedboxG.collapsed}),a(l.getElem(),function(){l.dividedboxG.size=l.dividedboxG.size+s,l.dividedboxG.resize=l.dividedboxG.resize+n.dividedboxG.preResize-d})}}}},l.doExpand=function(i){if(0==f){var n=c[i],o="left"==n.dividedboxG.collapseto||"up"==n.dividedboxG.collapseto?1:-1,l=" + "+n.dividedboxG.user,r=c[i+o],s=i==t.boxes.length-1?e.collapseSize-e.barSize:e.collapseSize;f+=2,n.dividedboxG.collapsed=!n.dividedboxG.collapsed,a(n.getElem(),function(){n.dividedboxG.size=n.dividedboxG.user,n.dividedboxG.resize=n.dividedboxG.preResize}),a(r.getElem(),function(){var e=r.dividedboxG.size.indexOf(l);r.dividedboxG.size=r.dividedboxG.size.slice(0,e).concat(r.dividedboxG.size.slice(e+l.length)),r.dividedboxG.resize=r.dividedboxG.resize-n.dividedboxG.preResize+s})}}}],link:function(a,l,r){function s(e){var t=e[n];t>=h&&m>=t&&(a.resizeConf.preResizes+=t-g,g=t,a.$digest())}function c(){var t=g-f,i=a.resizeConf.index;a.boxes[i].dividedboxG.resize+=t,a.boxes[i+1].dividedboxG.resize-=t,a.resizeConf.resizing=!1,a.resizeConf.preSizes="0px",a.resizeConf.preResizes=-1*e.barSize,a.$digest(),a.boxes[i].$digest(),a.boxes[i+1].$digest(),l.unbind("mousemove",s).unbind("mouseup",c).unbind("mouseleave",c)}var d=a.$parent,p=function(e){if(e){var t;return t=/^(?:[1-9]\d*|0)(?:.\d+)?/.test(e)?e:d.$eval(e),Number(t)&&(t+="px"),t}},u=t(o)(a);if(l.prepend(u),l.addClass("wi-"+i+"dividedbox"),l.css({width:p(r.width)||"",height:p(r.height)||""}),a.$on("$destroy",function(){u&&u.remove()}),a.resizeConf={resizable:"false"!=r.resizable,resizing:!1,index:-1,preSizes:"0px",preResizes:-1*e.barSize},a.resizeConf.resizable){var f,g,h,m;l.on("mousedown",function(t){if(a.resizeConf.resizing===!0){var i=a.resizeConf.index;g=f=t[n],h=f-a.boxes[i].chargeDiff(e.boxMinSize),m=f+a.boxes[i+1].chargeDiff(e.boxMinSize);for(var o=0;o<=a.resizeConf.index;o++)a.resizeConf.preSizes+=" + "+a.boxes[o].dividedboxG.size,a.resizeConf.preResizes+=a.boxes[o].dividedboxG.resize;l.on("mousemove",s).on("mouseup",c).on("mouseleave",c)}})}}}},dividedboxGroupProductor:function(e){var t,i,n,o;return"h"==e?(t="^wiHdividedbox",i="width",n=new RegExp("left|right"),o="clientWidth"):(t="^wiVdividedbox",i="height",n=new RegExp("up|down"),o="clientHeight"),{restrict:"E",templateUrl:function(){return"template/dividedbox/wi-dividedbox-group.html"},transclude:!0,replace:!0,scope:{},require:t,link:function(t,a,l,r){var s=function(e){if(e&&/^(?:[1-9]\d*|0)(?:.\d+)?/.test(e)){var t=e;return Number(t)&&(t+="px"),t}}(l[i])||"";t.initBox=function(i){t.dividedboxG={index:i,type:e,user:s,size:s,resize:0,preResize:0,title:l.wiTitle,icon:l.wiIcon||"",collapseto:l.collapseto&&n.test(l.collapseto)?l.collapseto.match(n)[0]:void 0,collapsed:"true"==l.collapsed,_collapsed:"true"==l.collapsed},a.addClass("wi-"+e+"dividedbox-group"+(t.dividedboxG.collapseto||void 0!==t.dividedboxG.title?" wi-dividedbox-showhead":""))},r.addBox(t),t.$on("$destroy",function(){r.removeBox(t.dividedboxG.index)}),t.startResize=function(){r.startResize(t.dividedboxG.index)},t.doCollapse=function(){1==t.dividedboxG.collapsed?r.doExpand(t.dividedboxG.index):r.doCollapse(t.dividedboxG.index)},t.chargeDiff=function(e){return Math.max(a[0][o]-e,0)},t.getElem=function(){return a}}}}}}]).directive("wiHdividedbox",["dividedboxService",function(e){return e.dividedboxProductor("h")}]).directive("wiVdividedbox",["dividedboxService",function(e){return e.dividedboxProductor("v")}]).directive("wiHdividedboxGroup",["dividedboxService",function(e){return e.dividedboxGroupProductor("h")}]).directive("wiVdividedboxGroup",["dividedboxService",function(e){return e.dividedboxGroupProductor("v")}]),angular.module("ui.wisoft.fileupload",["ui.wisoft.position","ui.wisoft.progress"]).constant("fileuploadConf",{STARTED:1,STOPED:2,queued:1,uploading:2,completed:3,failed:4}).service("fileuploadSev",function(){var e=0;return{formatSize:function(e){function t(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}if(void 0===e||/\D/.test(e))return"NaN";var i=Math.pow(1024,4);return e>i?t(e/i,1)+" tb":e>(i/=1024)?t(e/i,1)+" gb":e>(i/=1024)?t(e/i,1)+" mb":e>1024?Math.round(e/1024)+" kb":e+" b"},parseSize:function(e){if("string"!=typeof e)return e;var t,i={t:1099511627776,g:1073741824,m:1048576,k:1024};return e=/^([0-9]+)([mgk]?)$/.exec(e.toLowerCase().replace(/[^0-9mkg]/g,"")),t=e[2],e=+e[1],i.hasOwnProperty(t)&&(e*=i[t]),e},formatMimetype:function(e){var t,i="",n={"3g2":"video/3gpp2","3gp":"video/3gpp","3gpp":"video/3gpp",aac:"audio/aac",ac3:"audio/ac3",ai:"application/postscript",aif:"audio/aiff",aiff:"audio/aiff",asc:"text/plain",avi:"video/avi",bmp:"image/bmp",css:"text/css",csv:"text/csv",diff:"text/plain",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",eps:"application/postscript",exe:"application/octet-stream",flac:"audio/flac",flv:"video/x-flv",gif:"image/gif",htm:"text/html",html:"text/html",jpe:"image/jpeg",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/x-javascript",json:"application/json",log:"text/plain",m2v:"video/mpeg",m4a:"audio/x-m4a",m4v:"video/x-m4v",mkv:"video/x-matroska",mov:"video/quicktime",mp2:"audio/mpeg",mp3:"audio/mpeg",mp4:"video/mp4",mpe:"video/mpeg",mpeg:"video/mpeg",mpega:"audio/mpeg",mpg:"video/mpeg",mpga:"audio/mpeg",oga:"audio/ogg",ogg:"audio/ogg",ogv:"video/ogg",otf:"application/vnd.oasis.opendocument.formula-template",pdf:"application/pdf",pgp:"application/pgp-signature",png:"image/png",pot:"application/vnd.ms-powerpoint",potx:"application/vnd.openxmlformats-officedocument.presentationml.template",pps:"application/vnd.ms-powerpoint",ppsx:"application/vnd.openxmlformats-officedocument.presentationml.slideshow",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",ps:"application/postscript",psd:"image/photoshop",qt:"video/quicktime",rtf:"text/rtf",rv:"video/vnd.rn-realvideo",svg:"image/svg+xml",svgz:"image/svg+xml",swf:"application/x-shockwave-flash",swfl:"application/x-shockwave-flash",text:"text/plain",tif:"image/tiff",tiff:"image/tiff",txt:"text/plain",wav:"audio/x-wav",webm:"video/webm",wma:"audio/x-ms-wma",wmv:"video/x-ms-wmv",xhtml:"text/html",xlb:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",zip:"application/zip"};return e&&angular.forEach(e,function(e){t=e.extensions.replace(" ","").split(","),angular.forEach(t,function(e){i+=n[e]+","})}),i.length?' accept="'+i.slice(0,-1)+'"':""},getUid:function(t){var i,n=(new Date).getTime().toString(32);for(i=0;5>i;i++)n+=Math.floor(65535*Math.random()).toString(32);return(t||"o_")+n+(e++).toString(32)},getType:function(e){return 0==e.indexOf("image")?"picture":0==e.indexOf("video")?"film":0==e.indexOf("audio")?"music":"file"}}}).directive("wiFileupload",["$position","fileuploadSev","fileuploadConf","$timeout","$parse","$document","wiDialog",function(e,t,i,n,o,a,l){return{restrict:"E",templateUrl:"template/fileupload/wi-fileupload.html",scope:{},replace:!0,link:function(n,a,r){function s(){for(var e=0;e<g.length&&(x=n.files[e],x.stat!=i.uploading);e++)if(x.stat==i.queued){y==i.STOPPED&&(y=i.STARTED),x.stat=i.uploading,n.$digest(),_=new FormData,_.append("file",g[e]),b.wiId=x.id,b.open("post",d.url),b.send(_);break}e==n.files.length&&(y=i.STOPPED)}function c(e){if(!(p&&p.indexOf(e.name.slice(e.name.lastIndexOf(".")+1,e.name.length))<0||d.max_file_size&&e.size>d.max_file_size)){var o={id:t.getUid("wif_"),name:e.name,type:t.getType(e.type),size:t.formatSize(e.size),percent:0,progressLabel:"0%",stat:i.queued};e.wiId=o.id,n.files.push(o),g.push(e)}}var d=n.fileULOptions={url:r.wiUrl||"",multi_selection:r.hasOwnProperty("wiMultisel")&&"false"!=r.wiMultisel,browse_button:document.getElementById(r.wiTrigger),modal:!!r.hasOwnProperty("wiModal")};if(n.files=[],d.browse_button&&d.url){var p;r.wiMimeTypes&&(d.mime_types=new Function("return "+r.wiMimeTypes)()),d.mime_types&&(p=[])&&angular.forEach(d.mime_types,function(e){p=p.concat(e.extensions.split(","))}),r.wiMaxSize&&(d.max_file_size=t.parseSize(r.wiMaxSize)),r.wiSwf&&(d.flash_swf_url=r.wiSwf),n.removeFun=r.removefun&&n.$parent?o(r.removefun)(n.$parent):angular.noop;var u,f,g=[],h=e.position(angular.element(d.browse_button)),m={pos:"top:"+h.top+"px; left:"+h.left+"px; width:"+h.width+"px; height:"+h.height+"px;",multiple:d.multi_selection?" multiple":"",accept:t.formatMimetype(d.mime_types)},v=angular.element('<input type="file" class="wi-fileupload-btn"'+m.multiple+m.accept+" />"),w=angular.element('<div class="wi-fileupload-btndiv" style="'+m.pos+'"></div>');v.on("change",function k(){if(b){this.files&&angular.forEach(this.files,function(e){c(e)});try{this.files=[],this.value=""}catch(e){var t=v.clone(!0);t.on("change",k),v.replaceWith(t),v=t}n.$digest(),d.modal&&n.files.length>0&&(u=l.open({template:'<ul class="wi-fileupload" ng-if="files.length>0">                                    <li ng-repeat="file in files track by file.id">                                        <span class="wi-fileupload-info" ng-style="{cursor: file.stat==3 ? \'pointer\': \'\'}" ng-click="getResponse(file)">                                            <span class="wi-fileupload-icon icon-{{file.type}}"></span>                        {{file.name}}                                            <span class="wi-fileupload-tip">({{file.size}})</span>                                        </span>                                        <span class="wi-fileupload-completed" ng-style="{display: file.stat==3 ? \'\' : \'none\'}">完成</span>                                        <span class="wi-fileupload-queued" ng-style="{display: file.stat==1 ? \'\' : \'none\'}">等待上传</span>                                        <wi-progress ng-style="{display: file.stat==2 ? \'\' : \'none\'}" label="file.progressLabel" value="file.percent"></wi-progress>                                        <span class="wi-fileupload-error" ng-style="{display: file.stat==4 ? \'\' : \'none\'}">上传失败</span>                                        <span class="wi-fileupload-del" ng-click="removeFile(file)">删除</span>                                    </li>                                </ul>',plain:!0,title:"上传进度",scope:n,width:380}).id,f||(f=n.$watch("files.length",function(e){0>=e&&u&&(l.closeOne(u),f(),u=void 0,f=void 0)}))),s()}}),w.append(v),d.browse_button.parentNode.appendChild(w[0]),n.$on("$destroy",function(){b&&(b.readyState!=XMLHttpRequest.UNSENT&&b.abort(),b=null),v.remove(),w.remove(),v=null,w=null});var b,x,_,y=i.STOPPED;if(window.XMLHttpRequest&&(b=new XMLHttpRequest),b&&(b.addEventListener("loadend",function(){b.status>399?x.stat=i.failed:x.stat==i.uploading&&(x.stat=i.completed,x.responseText=b.responseText),n.$digest(),x=null,s()}),b.upload&&b.upload.addEventListener("progress",function(e){e.lengthComputable&&(x.percent=parseInt(e.loaded/e.total*100),x.progressLabel=x.percent+"%",n.$digest())},!1),b.addEventListener("error",function(){x&&(x.stat=i.failed)&&n.$digest()})),n.removeFile=function(e){var t=e.id;b.wiId==t&&b.abort(),n.files.splice(n.files.indexOf(e),1);for(var i=0;i<g.length;i++)g[i].wiId==e.id&&g.splice(i,1);n.removeFun(e)},r.hasOwnProperty("wiResponse")){var C=r.wiResponse,$=n.$parent;$.hasOwnProperty(C)&&(n.getResponse=function(e){e.stat==i.completed&&($[C]=e.responseText)})}}}}}]),angular.module("ui.wisoft.imageview",[]).directive("wiImageview",function(){return{restrict:"E",templateUrl:function(){return"template/imageview/imageviewTemplate.html"},transclude:!0,replace:!0,scope:{width:"@",height:"@",adaptive:"@",imageurls:"=",imagedata:"=",openindex:"=",onPrevious:"&previous",onNext:"&next",onClose:"&close"},controller:["$scope",function(){}],link:function(e,t){function i(){y=new Image,y.onload=n,y.onerror=o}function n(){e.img_exclass=null,e.$apply("img_exclass"),c(),s()}function o(){e.img_exclass="wi-imageview-pic-error",e.$apply("img_exclass"),a(),y=new Image,y.onload=n,y.onerror=o}function a(){C.save(),C.clearRect(0,0,e._width,e._height),C.restore()}function l(){f=0,g=1,h=e._width/2,m=e._height/2}function r(){l(),e.img_exclass="wi-imageview-pic-loading",u?y.src=e._imageurls[e._openindex]:a()}function s(){C.save(),C.clearRect(0,0,e._width,e._height),C.translate(h,m),C.rotate(f),C.scale(g,g),C.drawImage(y,-y.width/2,-y.height/2),C.restore()}function c(){if(e._adaptive&&(y.width>e._width||y.height>e._height)){var t=e._width/y.width,i=e._height/y.height;g=Math.floor(10*Math.min(t,i))/10}}function d(){return document.onmousemove=null,document.onmouseup=null,!1}function p(e){return h+=e.clientX-S,m+=e.clientY-z,S=e.clientX,z=e.clientY,s(),!1}e._width=e.width,e._height=e.height,e._imageurls=void 0==e.imageurls?[]:e.imageurls,e._openindex=void 0==e.openindex?0:e.openindex,e._adaptive=void 0==e.adaptive?!1:e.adaptive,e.isopen=!1,e.isfull=!1,e._show_save=!0,e._show_previous=!0,e._show_next=!0;var u=0==e._imageurls.length?!1:!0,f=0,g=1,h=e._width/2,m=e._height/2,v=e._width,w=e._height,b=0,x=0,_=document.createElement("canvas");_.width=e._width,_.height=e._height;var y,C=_.getContext("2d");u?(i(),1==e._imageurls.length&&(e._show_previous=!1,e._show_next=!1)):(e._show_save=!1,void 0==e.onPrevious&&(e._show_previous=!1),void 0==e.onNext&&(e._show_next=!1)),e.$watch("openindex",function(t){void 0!=t&&-1!=t&&(e._openindex=e.openindex,e.open())},!1),e.$watch("imageurls",function(t){void 0!=t&&(e._imageurls=e.imageurls)},!1),e.$watch("imagedata",function(t,i){if(void 0!=t&&null!=t&&t!=i)if(e.isopen=!0,void 0==e.imagedata||null==e.imagedata)e.img_exclass="wi-imageview-pic-error";else{y=document.createElement("canvas"),y.width=e.imagedata.width,y.height=e.imagedata.height;var n=y.getContext("2d");n.putImageData(e.imagedata,0,0),e.open()}},!1),e.open=function(){document.documentElement.style.overflow="hidden",x=e.left=(document.documentElement.clientWidth-e._width)/2+"px",b=e.top=(document.documentElement.clientHeight-e._height)/2+"px",e.isopen=!0,u?(i(),y.src=e._imageurls[e._openindex],e.img_exclass="wi-imageview-pic-loading"):(l(),c(),s())};for(var $,k=t.find("div"),E=0;E<k.length;E++)if("wi-imageview-pic"==k[E].className){$=k[E],$.appendChild(_);break}e.close=function(){u&&(e._openindex=e.openindex=-1),e.isfull=!1,e.isopen=!1,e.img_exclass=null,e.top=b,e.left=x,e._width=v,e._height=w,l(),a(),document.documentElement.style.overflow="auto",e.onClose&&e.onClose()},e.previous=function(){u&&(0==e._openindex?e._openindex=e._imageurls.length-1:e._openindex-=1),r(),e.onPrevious&&e.onPrevious()},e.next=function(){u&&(e._openindex==e._imageurls.length-1?e._openindex=0:e._openindex+=1),r(),e.onNext&&e.onNext()},e.toleft=function(){f+=Math.PI/2,s()},e.toright=function(){f-=Math.PI/2,s()},e.zoomin=function(){g>.2&&(g-=.1,s())},e.zoomout=function(){g+=.1,s()},e.reset=function(){l(),s()},e.full=function(){e.top=0,e.left=0,e._width=_.width=document.documentElement.clientWidth,e._height=_.height=document.documentElement.clientHeight,h=e._width/2,m=e._height/2,s(),e.isfull=!0
},e.origin=function(){e.top=b,e.left=x,e._width=v,e._height=w,h=e._width/2,m=e._height/2,$.removeChild(_),_=document.createElement("canvas"),_.width=e._width,_.height=e._height,C=_.getContext("2d"),$.appendChild(_),e.reset(),e.isfull=!1},e.mouseenter=function(){t.bind("mousewheel",function(e){if(e.wheelDelta>0||void 0!=e.originalEvent&&e.originalEvent.wheelDelta>0)g+=.1;else{if(!(g>.2))return;g-=.1}s(),e.preventDefault()})},e.mouseleave=function(){t.unbind("mousewheel")};var S,z;e.mousedown=function(e){S=e.clientX,z=e.clientY,document.onmousemove=p,document.onmouseup=d}}}}),angular.module("ui.wisoft.menu",["ui.wisoft.position","ui.wisoft.popup"]).constant("menuConf",{divBorderSize:1,emptyUlHeight:6,toolbarHeight:29,liHeight:25,liWidth:160,subOffset:5,scollbarSize:17}).directive("wiMenu",["$compile","popupService","$document","$window","$timeout","menuConf","$filter","$position",function($compile,popupService,$document,$window,$timeout,menuConf,$filter,$position){return{restrict:"E",templateUrl:"template/menu/wi-menu.html",replace:!0,transclude:!0,scope:{dataprovider:"=",selectitem:"=",onselect:"&"},require:"wiMenu",controller:["$scope","$attrs",function(e,t){var i=this;i.select=t.hasOwnProperty("selectitem")?function(t){e.selectitem=t}:angular.noop}],compile:function(telem,tattrs,transclude){var compiledContents,contents=telem.contents().remove();return{post:function(scope,elem,attrs,ctrl){function manageSubs(e,t){var i=data.length,n=1,o=Math.floor((e-2*menuConf.divBorderSize+1)/(menuConf.liWidth+1));for(scope.datagroups.length=0,scope.groupsBackward.length=0,scope.groupsForward.length=0,0>=o&&(o=1);targetElHeight>t;)n++,i=Math.ceil(data.length/n),targetElHeight=menuConf.emptyUlHeight+2*menuConf.divBorderSize+i*menuConf.liHeight,!conf.filterable&&o>=n||(targetElHeight+=menuConf.toolbarHeight);targetElWidth=Math.min(n,o)*(menuConf.liWidth+1)+2*menuConf.divBorderSize-1;for(var a=0;n>a;a++){var l,r=a*i;l=a==n?data.length:r+i,o>a?scope.datagroups.push(data.slice(r,l)):scope.groupsForward.push(data.slice(r,l))}}compiledContents||(compiledContents=$compile(contents)),compiledContents(scope,function(e){elem.append(e)});var conf=scope.conf={adaptable:"false"!=attrs.adaptable,filterable:"true"==attrs.filterable};scope.menutype=scope.$parent.menutype?"sub":attrs.hasOwnProperty("wiRightMenu")&&"false"!=attrs.wiRightMenu?"right":"static",scope.isOpen=!1;var data=scope.dataprovider||[];scope.datagroups=data.length?[data]:[],scope.groupsBackward=[],scope.groupsForward=[];var referElem,rePosition=angular.noop,targetElWidth,targetElHeight;if("sub"==scope.menutype){var className="";referElem=elem.parent(),attrs.$observe("isOpen",function(){scope.isOpen="true"==attrs.isOpen}),rePosition=function(){elem.removeClass(className);var e,t="right",i="top",n=$window.innerWidth-menuConf.scollbarSize,o=$window.innerHeight-menuConf.scollbarSize;targetElWidth=menuConf.liWidth+2*menuConf.divBorderSize,targetElHeight=menuConf.emptyUlHeight+2*menuConf.divBorderSize+data.length*menuConf.liHeight,conf.filterable&&(targetElHeight+=menuConf.toolbarHeight),e=referElem[0].getBoundingClientRect(),0!=conf.adaptable&&manageSubs(Math.max(e.left,n-e.right)+menuConf.subOffset,o);var a=$position.adaptElements(referElem,targetElWidth,targetElHeight,t+"-"+i,conf.adaptable,!1);className="wi-menu-"+a[1],elem.addClass(className).css(angular.extend(a[0],{width:targetElWidth+"px",height:targetElHeight+"px"}))},scope.ctrl=scope.$parent.ctrl}else"static"==scope.menutype?(conf.position=attrs.position?attrs.position:"bottom-left",angular.forEach(transclude(scope),function(e){1==e.nodeType&&(referElem=angular.element(e))}),referElem||(referElem=angular.element('<input type="button" class="wi-btn" value="弹出菜单" />')),referElem.on("click",function(e){1==scope.isOpen?(scope.isOpen=!1,popupService.close(scope)):(scope.isOpen=!0,popupService.open(scope,!0),elem.css("zIndex",$position.getZIndex())),scope.$digest(),e.stopPropagation()}),elem.parent().prepend(referElem),attrs.$observe("position",function(){conf.position=attrs.position}),rePosition=function(){var e,t,i,n=$window.innerWidth-menuConf.scollbarSize,o=$window.innerHeight-menuConf.scollbarSize;targetElWidth=menuConf.liWidth+2*menuConf.divBorderSize,targetElHeight=menuConf.emptyUlHeight+2*menuConf.divBorderSize+data.length*menuConf.liHeight,conf.filterable&&(targetElHeight+=menuConf.toolbarHeight),e=referElem[0].getBoundingClientRect();var a=angular.isString(conf.position)?conf.position.split("-"):[];t=a[0]||"bottom",0!=conf.adaptable&&(["left","right"].indexOf(t)>=0?manageSubs(Math.max(e.left,n-e.right),o):manageSubs(n,Math.max(e.top,o-e.bottom))),i=$position.adaptElements(referElem,targetElWidth,targetElHeight,conf.position,conf.adaptable,!0)[0],elem.css(angular.extend(i,{width:targetElWidth+"px",height:targetElHeight+"px"}))}):"right"==scope.menutype&&(conf.position={},referElem=elem.parent(),referElem.on("contextmenu",function(e){popupService.closeAll(!0);var t,i,n=referElem[0].getBoundingClientRect();t=e.clientX,i=e.clientY,t>=n.left&&t<=n.right&&i>=n.top&&i<=n.bottom&&(e.preventDefault(),conf.position.x=e.clientX,conf.position.y=e.clientY,function(){for(var e,t=$window.top,i=$window,n=0,o=0,a=!1,l=0,r=0;i!=t;)a||(r-=i.pageXOffset||i.document.documentElement.scrollLeft,l-=i.pageYOffset||i.document.documentElement.scrollTop,a=!0),a&&(e=i.frameElement.getBoundingClientRect(),n+=e.top,o+=e.left),i=i.parent;var s=t.document.body.getBoundingClientRect();a?"static"!=$position.getStyle(t.document.body,"position")?(r-=s.left,l-=s.top):(r+=t.pageXOffset||t.document.documentElement.scrollLeft,l+=t.pageYOffset||t.document.documentElement.scrollTop):"static"!=$position.getStyle(t.document.body,"position")&&(r-=(t.pageXOffset||t.document.documentElement.scrollLeft)+s.left,l-=(t.pageYOffset||t.document.documentElement.scrollTop)+s.top),conf.position.x+=o+r,conf.position.y+=n+l}(),scope.$digest())}),scope.$watch("conf.position",function(e){e&&e.x&&!scope.isOpen&&(scope.isOpen=!0,popupService.open(scope,!1),elem.css("zIndex",$position.getZIndex()))},!0),rePosition=function(){var e,t,i={},n=$window.innerWidth-menuConf.scollbarSize,o=$window.innerHeight-menuConf.scollbarSize;targetElWidth=menuConf.liWidth+2*menuConf.divBorderSize,targetElHeight=menuConf.emptyUlHeight+2*menuConf.divBorderSize+data.length*menuConf.liHeight,conf.filterable&&(targetElHeight+=menuConf.toolbarHeight),e=referElem[0].getBoundingClientRect(),t=$position.offset(referElem),i.left=conf.position.x+t.left-e.left+"px",i.top=conf.position.y+t.top-e.top+"px",0!=conf.adaptable&&(manageSubs(n,o),n-conf.position.x<targetElWidth&&(i.left=n-targetElWidth+t.left-e.left+"px"),o-conf.position.y<targetElHeight&&(i.top=o-targetElHeight+t.top-e.top+"px")),elem.css({top:i.top?i.top:"",bottom:i.bottom?i.bottom:"",left:i.left?i.left:"",right:i.right?i.right:"",width:targetElWidth+"px",height:targetElHeight+"px"})}),ctrl.onSelect=scope.onselect()||angular.noop,scope.ctrl=ctrl,angular.element($window.top.document.body).append(elem),scope.$on("$destroy",function(){elem.remove(),elem=null});conf.filterable&&(scope.filterval="",$filter("showFilter")(scope.dataprovider,scope.filterval),scope.$watch("filterval",function(e,t){e!==t&&$filter("showFilter")(scope.dataprovider,e)})),scope.$watch("isOpen",function(e){1==e?rePosition():angular.forEach(scope.dataprovider,function(e){e.childopen=!1})}),scope.$watch("dataprovider",function(e){data=e||[],scope.datagroups=[data],scope.groupsBackward=[],scope.groupsForward=[],scope.isOpen&&rePosition()},!1),scope.clickLi=function(event,item){if(0!=item.enabled){if(item.event)return eval(item.event),popupService.closeAll(),scope.ctrl.onSelect(item),void 0;if(!item.children)return scope.ctrl.select(item),popupService.closeAll(),scope.ctrl.onSelect(item),void 0}event.stopPropagation()},scope.backwardClick=function(e){scope.groupsBackward.length>0&&(scope.datagroups.unshift(scope.groupsBackward.pop()),scope.groupsForward.unshift(scope.datagroups.pop())),e.stopPropagation()},scope.forwardClick=function(e){scope.groupsForward.length>0&&(scope.datagroups.push(scope.groupsForward.shift()),scope.groupsBackward.push(scope.datagroups.shift())),e.stopPropagation()};var hoverItem;scope.mouseenter=function(e){0!=e.enabled&&(hoverItem=e,$timeout(function(){hoverItem==e&&(e.childopen||(angular.forEach(scope.dataprovider,function(e){e.childopen=!1}),e.childopen=!e.childopen))},500))},scope.mouseleave=function(e){hoverItem==e&&(hoverItem=void 0)}}}}}}]).filter("showFilter",function(){function e(t,i){var n=0;return i&&""!=i?angular.forEach(t,function(e){0!=e.enabled&&(e.highlight=e.label.indexOf(i)>=0,e.highlight&&n++)}):angular.forEach(t,function(t){t.highlight=!1,n++,t.children&&e(t.children)}),n}return function(t,i){return e(t,i),t}}),angular.module("ui.wisoft.messagetip",[]).service("wiMessageTip",["$document","$timeout","$injector",function(e,t,i){function n(e){var t=angular.element(e.target).hasClass("wi-messagetip-close");t?o(c.data("$id")):null!=l.click&&(l.click.$inject=["e"],i.invoke(l.click,{},{e:e}))}function o(e){c.unbind("click",n),"bottom"==l.position?c.css("bottom",-c[0].clientHeight+"px"):"right"==l.position&&c.css("right",-c[0].clientWidth+"px"),t(function(){for(var t=0;t<s.length;t++)if(e==s[t].data("$id")){s.splice(t,1);break}c.remove(),c=null,s.length>0&&(c=s[s.length-1])},1e3)}function a(){var e=angular.isNumber(l.width)?l.width+"px":l.width,i=angular.isNumber(l.height)?l.height+"px":l.height,n=['<div class="wi-messagetip-box" style="width:'+e+";height:"+i+';">','<div class="wi-messagetip-head">'+l.title+'<span class="wi-messagetip-close icon-remove"></span></div>','<div class="wi-messagetip-content">'+l.content+"</div>","</div>"];return l.delay>0&&t(function(){o()},1e3*l.delay),n.join("")}var l,r=angular.element(window.parent.document.body),s=[],c=null,d=1;this.open=function(e){var i={width:"auto",height:"auto",title:"消息",position:"bottom",isshake:!1,delay:0,click:null};return angular.extend(i,e),l=i,c=angular.element(a()),c.bind("click",n),c.data("$id","wiMessageTip_"+d++),r.append(c),c.css("bottom","-500px"),c.css("right","-500px"),"bottom"==e.position?(c.css("right","5px"),c.css("bottom",c[0].clientHeight+"px"),c.css("transition","bottom 1s"),c.css("bottom","5px")):"right"==e.position&&(c.css("bottom","5px"),c.css("right",c[0].clientWidth+"px"),c.css("transition","right 1s"),c.css("right","5px")),l.isshake&&t(function(){c.css("animation","shake-hard 1s"),c.css("-webkit-animation","shake-hard 1s")},1e3),s.push(c),c.data("$id")},this.closeOne=function(e){o(e)}}]),angular.module("ui.wisoft.my97datepicker",[]).directive("wiDatepicker",function(){return{restrict:"E",require:"ngModel",template:'<input class="wi-datepicker"/>',replace:!0,scope:{isshowweek:"@",readonly:"@",highlineweekday:"@",isshowclear:"@",isshowtoday:"@",firstdayofweek:"@",startdate:"@",alwaysusestartdate:"@",datefmt:"@",vel:"@",skin:"@",mindate:"@",maxdate:"@",disableddays:"@",onpicked:"&",oncleared:"&",qsenabled:"@",quicksel:"@"},link:function(e,t,i,n){function o(){WdatePicker(s)}function a(){r(),e.onpicked()&&e.onpicked()(t[0].value)}function l(){r(),e.oncleared()&&e.oncleared()(t[0].value)}function r(){e.$apply(n.$setViewValue(t[0].value))}if(n){var s={};s.el=t[0],s.onpicked=a,s.oncleared=l,s.isShowWeek="true"==e.isshowweek?!0:!1,s.readOnly="true"==e.readonly?!0:!1,s.highLineWeekDay="true"==e.highlineweekday?!0:!1,s.isShowClear="false"==e.isshowclear?!1:!0,s.isShowToday="false"==e.isshowtoday?!1:!0,s.firstDayOfWeek=e.firstdayofweek?e.firstdayofweek:0,s.startDate=e.startdate,s.alwaysUseStartDate="true"==e.alwaysusestartdate?!0:!1,s.dateFmt=e.datefmt,s.vel=e.vel,s.skin=e.skin,s.minDate=e.mindate,s.maxDate=e.maxdate,s.disabledDays=e.disableddays,s.qsEnabled="false"==e.qsenabled?!1:!0,s.quickSel=(e.quicksel+"").split(","),t[0].onfocus=o,t[0].onclick=o}}}}),angular.module("ui.wisoft.panel",["ui.wisoft.collapse"]).constant("panelConf",{headHeight:30}).directive("wiPanel",["panelConf",function(e){return{restrict:"E",transclude:!0,replace:!0,templateUrl:"template/panel/wi-panel.html",scope:{wiid:"=",heading:"@",isOpen:"=?",onopened:"&",onclosed:"&",oncollapse:"&",onexpand:"&"},controller:function(){this.setHeading=function(e){this.headingEl=e}},link:function(t,i,n){var o=t.onopened(),a=t.onclosed(),l=t.oncollapse(),r=t.onexpand(),s=t.$parent;!function(){var o=function(e){if(e){var t;return t=/^(?:[1-9]\d*|0)(?:.\d+)?/.test(e)?e:s.$eval(e),Number(t)&&(t+="px"),t}};t.width=o(n.width)||"";var a=o(n.height);a&&(i.addClass("wi-panel-h").css("height",a),a.indexOf("px")>0?angular.element(i.children()[1]).css("height",parseInt(a)-e.headHeight+"px"):angular.element(i.children()[1]).css("height","calc("+a+" - "+e.headHeight+"px)"))}(),function(){if(t.headicon=n.headIcon,n.hasOwnProperty("center")&&"false"!=n.center&&angular.element(angular.element(i.children()[0]).children()[0]).css("text-align","center"),t.collbyHead=n.hasOwnProperty("collapsible")?function(){c()}:angular.noop,t.headTools={},n.headTools)try{var e=s.$eval(n.headTools);if(angular.isString(e)&&(e=e.replace(/\s*/g,"").split(",")),angular.isArray(e)){var o=function(i){var n=e.indexOf(i);n>=0&&(e.splice(n,1),t.headTools[i]=!0)};o("collapse"),o("close"),e.length>0&&(t.headTools.custom=e)}Object.getOwnPropertyNames(t.headTools).length>0&&(t.headTools.visible=!0)}catch(a){console.warn("wi-panel 的 headTools 属性定义不合法!")}t.collbyTool=function(e){c(),e.stopPropagation()}}(),t.collapsed=n.hasOwnProperty("collapsed")&&"false"!=n.collapsed,t.collapsed?l&&l():r&&r();var c=function(){t.collapsed=!t.collapsed,t.collapsed?l&&l():r&&r()};t.isOpen=0!=t.isOpen,t.closebyTool=function(e){t.isOpen=!1,e.stopPropagation()},(o||a)&&t.$watch("isOpen",function(e){e?o&&o():a&&a()}),n.wiid&&angular.isObject(t.wiid)&&(t.wiid.options=function(){return{heading:t.heading,isOpen:t.isOpen,isCollapse:t.collapsed}},t.wiid.element=function(){return i},t.wiid.toggle=function(){return c(),t.collapsed})}}}]).directive("wiPanelHeading",function(){return{restrict:"E",transclude:!0,template:"",replace:!0,require:"^wiPanel",link:function(e,t,i,n,o){n.setHeading(o(e,function(){}))}}}).directive("wiPanelTransclude",function(){return{require:"^wiPanel",link:function(e,t,i,n){e.$watch(function(){return n[i.wiPanelTransclude]},function(e){e&&(t.html(""),t.append(e))})}}}),angular.module("ui.wisoft.popup",["ui.wisoft.position"]).constant("popupConfig",{openClass:"wi-popup-open"}).service("popupService",["$document","$window",function(e,t){var i,n=angular.element(t.top.document);this.open=function(e,t){i||(n.bind("click",o),n.bind("keydown",a)),i&&i!==e&&(i.isOpen=!1,t&&i.$digest()),i=e},this.close=function(e){i===e&&(i=null,n.unbind("click",o),n.unbind("keydown",a))},this.closeAll=function(e){o(e)};var o=function(e){i&&(e?i.$apply(function(){i.isOpen=!1}):i.isOpen=!1,i=null)},a=function(e){27===e.which&&(i.focusToggleElement&&i.focusToggleElement(),o())}}]).controller("PopupController",["$scope","$attrs","$parse","$timeout","$position","popupService","popupConfig",function(e,t,i,n,o,a,l){var r,s=this,c=e.$new(),d=l.openClass,p=angular.noop,u=t.onToggle?i(t.onToggle):angular.noop;s.popupOptions={},this.init=function(n){s.$element=n,t.isOpen&&(r=i(t.isOpen),p=r.assign,e.$watch(r,function(e){c.isOpen=!!e}))},this.toggle=function(e){return c.isOpen=arguments.length?!!e:!c.isOpen},this.isOpen=function(){return c.isOpen},c.getToggleElement=function(){return s.$element},c.focusToggleElement=function(){s.$element[0].focus()},c.$watch("isOpen",function(t,i){if(s.popupOptions&&s.popupOptions.elem){var l=s.$element,r=s.popupOptions,f=r.elem;t?(c.focusToggleElement(),l.addClass(d),a.open(c),f.addClass("wi-popup-menu-open"),f.css({top:0,left:0}),n(function(){var e=f[0].getBoundingClientRect(),t=r.width||e.width,i=r.height||e.height,n={visibility:"visible",zIndex:o.getZIndex(),width:t+"px",height:i+"px"};n=angular.extend(n,o.adaptElements(l,t,i,"bottom-left",!0,!0)[0]),f.css(n)})):(l.removeClass(d),f.removeClass("wi-popup-menu-open").css({visibility:"",zIndex:"",width:"",height:""}),a.close(c)),p(e,t),angular.isDefined(t)&&t!==i&&u(e,{open:!!t})}}),e.$on("$locationChangeSuccess",function(){c.isOpen=!1}),e.$on("$destroy",function(){c.$destroy()})}]).directive("wiPopup",["$window",function(e){return{restrict:"CA",controller:"PopupController",link:function(t,i,n,o){var a;angular.forEach(i.children(),function(t){void 0===a&&(" "+t.className+" ").indexOf("wi-popup-menu")>=0&&(a=angular.element(t),e.top.document.body.appendChild(t),o.popupOptions.elem=a)});var l=function(e){("keydown"!==e.type||13===e.keyCode)&&(e.preventDefault(),e.stopPropagation(),i.hasClass("disabled")||n.disabled||t.$apply(function(){o.toggle()}))};i.bind("click",l),i.bind("keydown",l),t.$on("$destroy",function(){void 0!==a&&(a.remove(),a=null),i.unbind("click",l),i.unbind("keydown",l)}),i.attr({"aria-haspopup":!0,"aria-expanded":!1}),t.$watch(o.isOpen,function(e){i.attr("aria-expanded",!!e)}),o.init(i)}}}]),angular.module("ui.wisoft.popupbutton",["ui.wisoft.popup"]).directive("wiPopupbutton",[function(){return{restrict:"E",templateUrl:"template/popupbutton/popupbuttonTemplate.html",replace:!0,transclude:!0,scope:{label:"@",isopen:"="},require:"wiPopup",link:function(e,t,i,n){var o=e.$parent,a=function(e){if(e){var t;return t=/^(?:[1-9]\d*|0)(?:.\d+)?/.test(e)?e:o.$eval(e),Number(t)&&(t+="px"),t}}(i.width);a&&t.css("width",a),n.popupOptions.elem.on("click",function(e){e.stopPropagation()})}}}]),angular.module("ui.wisoft.position",[]).factory("$position",["$document","$window",function(e,t){function i(e,i){return e.currentStyle?e.currentStyle[i]:t.getComputedStyle?t.getComputedStyle(e)[i]:e.style[i]}function n(e){return"static"===(i(e,"position")||"static")}var o=17,a=5e3,l=function(t){for(var i=e[0],o=t.offsetParent||i;o&&o!==i&&n(o);)o=o.offsetParent;return o||i},r=function(e,t,i){return i>e&&t>=i};return{getZIndex:function(){return a++},position:function(i){var n,o,a=l(i[0]),r=i[0].getBoundingClientRect(),s=r.width||i.prop("offsetWidth"),c=r.height||i.prop("offsetHeight");if(a!=e[0]){var d=angular.element(a)[0].getBoundingClientRect();n=r.top-d.top+a.scrollTop-a.clientTop,o=r.left-d.left+a.scrollLeft-a.clientLeft}else n=r.top+(t.pageYOffset||e[0].documentElement.scrollTop),o=r.left+(t.pageXOffset||e[0].documentElement.scrollLeft);return{width:s,height:c,top:n,left:o,bottom:n+c,right:o+s}},offset:function(i){var n=i[0].getBoundingClientRect(),o=n.width||i.prop("offsetWidth"),a=n.height||i.prop("offsetHeight"),l=n.top+(t.pageYOffset||e[0].documentElement.scrollTop),r=n.left+(t.pageXOffset||e[0].documentElement.scrollLeft);return{width:o,height:a,top:l,left:r,bottom:l+a,right:r+o}},offsetTop:function(e){for(var n,o,a,l=t.top,r=t,s=0,c=0,d=!1,p=e[0].getBoundingClientRect(),u=e[0].ownerDocument;r!=l;)d||u!=r.document||(d=!0),d&&(a=r.frameElement.getBoundingClientRect(),s+=a.top,c+=a.left),r=r.parent;n={top:p.top+s,bottom:p.bottom+s,left:p.left+c,right:p.right+c,width:p.width,height:p.height};var f=0,g=0;if("static"!=i(l.document.body,"position")){var h=l.document.body.getBoundingClientRect();g-=h.left,f-=h.top}else g+=l.pageXOffset||l.document.documentElement.scrollLeft,f+=l.pageYOffset||l.document.documentElement.scrollTop;return o={top:n.top+f,bottom:n.bottom+f,left:n.left+g,right:n.right+g,width:n.width,height:n.height},[n,o]},getStyle:i,positionTooltip:function(e,t,i,n){var o,a,l=angular.isString(n)?n.split("-"):[],r=l[0]||"bottom",s=l[1]||"left";o=this.position(e);var c={center:function(){return o.left+o.width/2-t/2},left:function(){return o.left},right:function(){return o.left+o.width-t}},d={center:function(){return o.top+o.height/2-i/2},top:function(){return o.top},bottom:function(){return o.top+o.height-i}};switch(r){case"right":a={top:d[s]()+"px",left:o.right+"px"};break;case"left":a={top:d[s]()+"px",left:o.left-t+"px"};break;case"bottom":a={top:o.bottom+"px",left:c[s]()+"px"};break;default:a={top:o.top-i+"px",left:c[s]()+"px"}}return a},adaptElements:function(e,i,n,a,l,s){var c,d,p,u,f,g={},h=angular.isString(a)?a.split("-"):[];if(d=h[0]||"bottom",p=h[1]||"left",s){var m=t.top,v=this.offsetTop(e);u=m.innerWidth-o,f=m.innerHeight-o,c=v[0];var w=v[1]}else u=t.innerWidth-o,f=t.innerHeight-o,c=e[0].getBoundingClientRect();if(l){switch(d){case"left":r(c.left,u-c.right,i)&&(d="right");break;case"right":r(u-c.right,c.left,i)&&(d="left");break;case"top":r(c.top,f-c.bottom,n)&&(d="bottom");break;default:d="bottom",r(f-c.bottom,c.top,n)&&(d="top")}switch(p){case"center":break;case"top":r(f-c.top,c.bottom,n)&&(p="bottom");break;case"bottom":r(c.bottom,f-c.top,n)&&(p="top");break;case"right":r(c.right,u-c.left,i)&&(p="left");break;default:p="left",r(u-c.left,c.right,i)&&(p="right")}}if(s){switch(d){case"left":g.left=w.left-i+"px";break;case"right":g.left=w.right+"px";break;case"top":g.top=w.top-n+"px";break;default:d="bottom",g.top=w.bottom+"px"}switch(p){case"center":["left","right"].indexOf(d)>=0?g.top=w.top+Math.floor((c.height-n)/2)+"px":g.left=w.left+Math.floor((c.width-i)/2)+"px";break;case"top":g.top=0!=l&&f-c.top<n?w.top-c.top+f-n+"px":w.top+"px";break;case"bottom":g.top=0!=l&&c.bottom<n?w.top-c.top+f-n+"px":w.bottom-n+"px";break;case"right":g.left=0!=l&&c.right<i?w.left-c.left+u-i+"px":w.right-i+"px";break;default:p="left",g.left=0!=l&&u-c.left<i?w.left-c.left+u-i+"px":w.left+"px"}}else switch(p){case"center":["left","right"].indexOf(d)>=0?g.top=Math.floor((c.height-n)/2)+"px":g.left=Math.floor((c.width-i)/2)+"px";break;case"top":0!=l&&f-c.top<n&&(g.top=f-c.top-n+"px");break;case"bottom":0!=l&&c.bottom<n&&(g.bottom=c.bottom-f+"px");break;case"right":0!=l&&c.right<i&&(g.right=c.right-u+"px");break;default:p="left",0!=l&&u-c.left<i&&(g.left=u-c.left-i+"px")}return[{top:g.top?g.top:"",bottom:g.bottom?g.bottom:"",left:g.left?g.left:"",right:g.right?g.right:""},d+"-"+p]}}}]),angular.module("ui.wisoft.progress",["ui.wisoft.bindHtml"]).constant("progressConf",{initH:9}).directive("wiProgress",["progressConf","$parse","$compile","$interval",function(e,t,i,n){return{restrict:"E",templateUrl:"template/progress/wi-progress.html",replace:!0,scope:{},link:function(o,a,l){var r=o.$parent,s=angular.element(a.children()[0]),c={},d=r.$eval(l.width);angular.isNumber(d)&&(c.width=d+"px");var p=r.$eval(l.height);angular.isNumber(p)&&(c.height=p+"px"),s.css(c);var u=r.$eval(l.type);u&&"normal"!=u&&s.addClass("wi-progress-bar-"+u);var f,g=0;if("stage"==u){var h=angular.element(s.children()[1]);h.css("display","block"),f=n(function(){g>100-o.percent?(g=0,h.css("width",g+"%")):(g+=5,h.css("width",g+"%"))},40)}o.animation="normal"==u;var m,v=r.$eval(l.labelplacement);if(l.labelelem)o.labelelem=r.$eval(l.labelelem),m=i('<div bind-html-unsafe="labelelem"></div>')(o);else if(l.label){var w,b=t(l.label);w=b.assign,o.label=b(r),w&&r.$watch(b,function(e,t){e!==t&&(o.label=e)}),m=i('<div ng-bind="label"></div>')(o)}m&&("top"==v||"left"==v?(m.addClass("wi-progress-"+v),a.prepend(m)):("center"==v?m.css("line-height",c.height||e.initH+"px"):"bottom"!=v&&(v="right"),m.addClass("wi-progress-"+v),a.append(m)));var x=100/(r.$eval(l.maxvalue)||100);if(l.value){var _,y=t(l.value);_=y.assign,o.percent=y(r)*x,_&&r.$watch(y,function(e,t){e!==t&&(o.percent=e*x)})}o.$on("$destroy",function(){m&&m.remove(),f&&n.cancel(f),f=void 0})}}}]),angular.module("ui.wisoft.resizelistener",[]).factory("wiResizeListener",[function(){var e={},t=document.attachEvent;if(!t)var i=function(){var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,20)};return function(t){return e(t)}}(),n=function(){var e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(t){return e(t)}}(),o=function(e){var t=e.__resizeTriggers__,i=t.firstElementChild,n=t.lastElementChild,o=i.firstElementChild;n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight,o.style.width=i.offsetWidth+1+"px",o.style.height=i.offsetHeight+1+"px",i.scrollLeft=i.scrollWidth,i.scrollTop=i.scrollHeight},a=function(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height},l=function(e){var t=this;o(this),this.__resizeRAF__&&n(this.__resizeRAF__),this.__resizeRAF__=i(function(){a(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach(function(i){i.call(t,e)}))})};return e.addResizeListener=function(e,i){e.beListened?t?i():getComputedStyle(e)&&o(e):(e.beListened=!0,t?e.attachEvent("onresize",i):getComputedStyle(e)&&(e.__resizeTriggers__||("static"==getComputedStyle(e).position&&(e.style.position="relative"),e.__resizeLast__={},e.__resizeListeners__=[],(e.__resizeTriggers__=document.createElement("div")).className="resize-triggers",e.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',e.appendChild(e.__resizeTriggers__),o(e),e.addEventListener("scroll",l,!0),e.__resizeListeners__.push(i))))},e.removeResizeListener=function(e,i){t?e.detachEvent("onresize",i):(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(i),1),e.__resizeListeners__.length||(e.removeEventListener("scroll",l),e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)))},e}]),angular.module("ui.wisoft.searchinput",[]).directive("wiSearchinput",[function(){return{restrict:"E",templateUrl:"template/searchinput/wi-searchinput.html",replace:!0,transclude:!0,scope:{onsearch:"&"},link:function(e,t,i){var n=e.onsearch()||angular.noop;e.value="",e.tips=i.wiTips||"",e.search=function(){n(e.value)},t.on("keydown",function(t){13===t.keyCode&&e.$apply(function(){n(e.value)})})}}}]),angular.module("ui.wisoft.tabset",["ui.wisoft.resizelistener","ui.wisoft.common","ui.wisoft.menu"]).constant("tabsetConf",{liBefore:2}).controller("TabsetController",["$scope","$attrs","$timeout","tabsetConf",function(e,t,i,n){var o=e.conf={vertical:t.hasOwnProperty("vertical")&&"false"!=t.vertical,closeable:!t.hasOwnProperty("closeable")||"false"!=t.closeable},a=this,l=a.attrNames=o.vertical?{offset:"offsetHeight",pos:"top",size:"height"}:{offset:"offsetWidth",pos:"left",size:"width"},r=e.tabs=[],s=a.tabSizes=[];a.sumSize=0,a.rightClickTab=void 0,a.deselectOthers=function(e){angular.forEach(r,function(t){t.active&&t!==e&&(t.active=!1)})},a.addTab=function(t,c){var d=r.length>0?n.liBefore:0,p=r.length;if(a.acLinked)for(var u=c[0].parentElement.children;p<u.length&&u[p++]!=c[0];);r.splice(p,0,t),o.closeable&&(t.disable=!1),t.active&&!t.disable&&a.deselectOthers(t),i(function(){e.$apply(e.ulStyle[l.size]="auto");var t=c[0].getBoundingClientRect()[l.size];s.splice(p,0,t),a.sumSize+=d+t,e.scrollChange&&e.scrollChange()})},a.removeTab=function(t){var o=r.indexOf(t);return t.active&&r.length>1&&(r[o==r.length-1?o-1:o+1].active=!0),t.active=!1,r.splice(o,1),r.length&&(a.sumSize-=n.liBefore),a.sumSize-=s[o],s.splice(o,1),t.$destroy(),e.scrollable=!1,i(function(){e.scrollChange&&e.scrollChange()}),!0},a.closeAllTab=function(){for(var e=0;e<r.length;)r[e]._closeable?a.removeTab(r[e]):e++},a.closeOtherTab=function(e){for(var t=0;t<r.length;)r[t]!=e&&r[t]._closeable?a.removeTab(r[t]):t++},a.calcUlOffset=function(){e.calcUlOffset()}}]).directive("wiTabset",["wiResizeListener","wiCommonSev","$timeout","tabsetConf",function(e,t,i,n){return{restrict:"E",transclude:!0,replace:!0,scope:{wid:"=",onselect:"&",onbeforeclose:"&",onclose:"&"},controller:"TabsetController",templateUrl:"template/tebset/tabsetTemplate.html",link:function(o,a,l,r){var s=o.$parent,c=o.conf,d=r.attrNames,p=r.tabSizes;o.scrollable=!1;var u,f=[{id:1,label:"关闭当前页"},{id:2,label:"关闭其他"},{id:3,label:"关闭所有"}],g=[{id:1,label:"关闭当前页",enabled:!1},{id:2,label:"关闭其他"},{id:3,label:"关闭所有"}],h=[{id:3,label:"关闭所有"}],m=0;r.selectFun=o.onselect()||angular.noop,r.beforeCloseFun=o.onbeforeclose()||angular.noop,r.closeFun=o.onclose()||angular.noop,angular.extend(c,{width:t.getSizeFromAttr(l.width,s),height:t.getSizeFromAttr(l.height,s),tabheadsize:Number(l.tabheadsize)||36,enablerightmenu:c.closeable?l.hasOwnProperty("enablerightmenu")&&"false"!=l.enablerightmenu:!1,onselect:r.selectFun,onbeforeclose:r.beforeCloseFun,onclose:r.closeFun}),o.ulStyle={},angular.forEach(angular.element(a.children()[0]).children(),function(e){(" "+e.className+" ").indexOf("wi-tabstage")>=0&&(u=e,angular.element(e).on("contextmenu",function(){if(r.isTab){var e=r.rightClickTab&&r.rightClickTab.scope;o.menudata=e._closeable?f:g}else o.menudata=h;o.$digest(),r.isTab=!1}))}),(!c.vertical||c.height)&&(o.ulStyle.transition=d.pos+" .35s ease",o.ulStyle["-webkit-transition"]=d.pos+" .35s ease",o.scrollChange=function(){var e=u[d.offset];o.ulStyle[d.size]=Math.ceil(r.sumSize)+"px",e&&e<r.sumSize?(o.scrollable=!0,i(function(){o.calcUlOffset()})):(m=0,o.ulStyle[d.pos]=m+"px",o.scrollable=!1)}),o.calcUlOffset=function(){if(o.scrollable){for(var e=0,t=0,i=0;i<p.length&&(t=p[i],!o.tabs[i].active);i++)e+=t+n.liBefore;var a=u[d.offset],l=Math.max(-Math.floor(e),a-Math.ceil(r.sumSize)),s=Math.min(a-Math.ceil(e+t),0);l>m?m=l:m>s&&(m=s),o.ulStyle[d.pos]=m+"px"}},o.rightmenuselect=function(e){var t=r.rightClickTab;e&&(1==e.id?t&&r.removeTab(t.scope):2==e.id?t&&r.closeOtherTab(t.scope):3==e.id&&r.closeAllTab())},o.backward=function(){var e=m;if(!(e>=0))for(var t=0,i=0,a=0,l=0;l<p.length;l++){if(-e<=Math.floor(t)){m=-Math.floor(a),o.ulStyle[d.pos]=m+"px";break}i=p[l],a=t,t+=i+n.liBefore}},o.forward=function(){var e=m,t=u[d.offset];if(!(e<=t-Math.ceil(r.sumSize)))for(var i=0,a=0;a<p.length;a++){if(i+=p[a],t-e<Math.ceil(i)){m=t-Math.ceil(i),o.ulStyle[d.pos]=m+"px";break}i+=n.liBefore}};var v=r.resetSize=function(){var e=o.tabs;i(function(){o.$apply(o.ulStyle[d.size]="auto");for(var t=0;t<e.length;t++){var i=e[t].getSize(),n=r.tabSizes[t];i!=n&&(r.tabSizes[t]=i,r.sumSize+=i,n&&(r.sumSize-=n))}o.scrollChange&&o.scrollChange()})},w=function(){e.addResizeListener(a[0].parentElement,function(){o.$evalAsync(v)})};(c.vertical&&c.height&&c.height.indexOf("%")>0||!c.vertical&&c.width&&c.width.indexOf("%")>0)&&w(),l.wid&&angular.isObject(o.wid)&&angular.extend(o.wid,{options:function(){return c},getTab:function(e,t){for(var i=o.tabs,n=0;n<i.length;n++)if(i[n].getData()[e]==t)return i[n]},getTabs:function(e,t){for(var i=o.tabs,n=[],a=0;a<i.length;a++)i[a].getData()[e]==t&&n.push(i[a]);return n},getActiveTab:function(){for(var e=o.tabs,t=0;t<e.length;t++)if(1==e[t].active)return e[t]},select:function(e){e&&(e.active=!0)},close:function(e){e&&e.close()},reCompute:function(){w()}}),r.acLinked=!0}}}]).directive("wiTab",["$parse","wiCommonSev",function(e,t){return{require:"^wiTabset",restrict:"E",replace:!0,templateUrl:"template/tebset/tabTemplate.html",transclude:!0,scope:{heading:"@"},controller:function(){},compile:function(i,n,o){return function(i,n,a,l){i.$transcludeFn=o;var r=i.$parent;i.data={wiid:a.wiid,src:a.src,icon:a.icon},n.css(l.attrNames.size,t.getSizeFromAttr(a.size));var s;if(a.active){var c=e(a.active);s=c.assign,i.active=c(r),s&&r.$watch(c,function(e,t){e!==t&&(i.active=e)})}else i.active=!1;if(i.$watch("active",function(e,t){e!==t&&(s&&s(r,e),e&&(l.deselectOthers(i),l.calcUlOffset(),l.selectFun(i.getData())))}),l.addTab(i,n),i.disable===!1)if(a.regular){var d=e(a.regular);i._closeable=!d(r),d.assign&&r.$watch(d,function(e,t){e!==t&&(i._closeable=!e,l.resetSize())})}else i._closeable=!0;else if(i._closeable=!1,i.disable=!1,a.disable){var p=e(a.disable);p.assign&&r.$watch(p,function(e){i.disable=!!e})}i.getData=function(){return angular.extend({heading:i.heading||i.headingElem},i.data)},i.getSize=function(){return n[0].getBoundingClientRect()[l.attrNames.size]},i.select=function(){i.disable||(i.active=!0)},i.close=function(e){l.beforeCloseFun(i.getData())!==!1&&l.removeTab(i,n),e&&e.stopPropagation()},i.$on("$destroy",function(){n&&n.remove(),l.closeFun(i.getData()),i=void 0}),n.on("contextmenu",function(){l.rightClickTab={scope:i,elm:n},l.isTab=!0})}}}}]).directive("wiTabHeadingTransclude",[function(){return{restrict:"A",require:"^wiTab",link:function(e,t){e.$watch("headingElem",function(e){e&&t.html(e)
})}}}]).directive("wiTabContentTransclude",function(){function e(e){return e.tagName&&"wi-tab-heading"===e.tagName.toLowerCase()}return{restrict:"A",require:"^wiTabset",link:function(t,i,n){var o=t.$eval(n.wiTabContentTransclude);o.$transcludeFn(o.$parent,function(t){angular.forEach(t,function(t){e(t)?o.headingElem=angular.element(t).html():void 0==o.src&&i.append(t)})})}}}),angular.module("ui.wisoft.tilelist",["ui.wisoft.resizelistener"]).constant("tilelistConf",{rowHeight:30,colWidth:100,scrollBarSize:17}).directive("wiTilelist",["tilelistConf","wiResizeListener","$timeout",function(e,t,i){return{restrict:"E",templateUrl:"template/tilelist/tilelistTemplate.html",transclude:!0,replace:!0,scope:{dataprovider:"=",direction:"@",itemrender:"@"},controller:["$scope",function(){}],controllerAs:"tilelistCtrl",link:function(n,o,a){function l(){h(),n.colW=f+"px",n.rowH=u+"px",n.tableW=f*p+"px",n.tableH=u*d+"px",n.dataTable=[];for(var e=0;d>e;e++){for(var t=[],i=0;p>i;i++)t.push(n.dataprovider[e*p+i]);n.dataTable.push(t)}}var r=n.$parent,s=angular.lowercase(n.direction||"v"),c=!1;!function(){var e=function(e){if(e){var t=/^(?:[1-9]\d*|0)(?:.\d+)?/.test(e)?e:r.$eval(e);return Number(t)&&(t+="px"),t}},t=e(a.width),i=e(a.height);o.css({width:t,height:i}),c="v"==s?!t||t.indexOf("%")>=0:!i||i.indexOf("%")>=0}();var d,p,u,f,g={rowCount:Number(r.$eval(a.rowcount)),colCount:Number(r.$eval(a.colcount)),rowHeight:Number(r.$eval(a.rowheight)),colWidth:Number(r.$eval(a.colwidth))},h="h"==s?function(){var t=o[0].getBoundingClientRect(),i=t.width,a=t.height;if(f=g.colWidth||e.colWidth,g.rowCount){d=g.rowCount,p=Math.ceil(n.dataprovider.length/d);var l=f*p>i?a-e.scrollBarSize:a;u=g.rowHeight&&g.rowHeight*d<=l?g.rowHeight:Math.floor(l/d)}else u=g.rowHeight||e.rowHeight,d=Math.floor(a/u)||1,p=Math.ceil(n.dataprovider.length/d),d>1&&p*f>i&&(d=Math.floor((a-e.scrollBarSize)/u)||1,p=Math.ceil(n.dataprovider.length/d))}:function(){var t=o[0].getBoundingClientRect(),i=t.width,a=t.height;if(u=g.rowHeight||e.rowHeight,g.colCount){p=g.colCount,d=Math.ceil(n.dataprovider.length/p);var l=u*d>a?i-e.scrollBarSize:i;f=g.colWidth&&g.colWidth*p<=l?g.colWidth:Math.floor(l/p)}else f=g.colWidth||e.colWidth,p=Math.floor(i/f)||1,d=Math.ceil(n.dataprovider.length/p),p>1&&d*u>a&&(p=Math.floor((i-e.scrollBarSize)/f)||1,d=Math.ceil(n.dataprovider.length/p))};n.$watchCollection("dataprovider",function(e){e?l():n.dataTable=[]}),i(l,0);var m=function(){c&&t.addResizeListener(o[0],function(){n.$evalAsync(l)})};m()}}}]),angular.module("ui.wisoft.tooltip",["ui.wisoft.position","ui.wisoft.bindHtml"]).provider("$tooltip",function(){function e(e){var t=/[A-Z]/g,i="-";return e.replace(t,function(e,t){return(t?i:"")+e.toLowerCase()})}var t={placement:"top",animation:!0,popupDelay:0},i={mouseenter:"mouseleave",click:"click",focus:"blur"},n={};this.options=function(e){angular.extend(n,e)},this.setTriggers=function(e){angular.extend(i,e)},this.$get=["$window","$compile","$timeout","$parse","$document","$position",function(o,a,l,r,s,c){return function(s,d,p){function u(e){var t=e||f.trigger||p,n=i[t]||t;return{show:t,hide:n}}var f=angular.extend({},t,n),g=e(s),h="<div "+g+'-popup content="{{tt_content}}" placement="{{tt_placement}}" animation="tt_animation" is-open="tt_isOpen"></div>';return{restrict:"EA",scope:!0,compile:function(){var e=a(h);return function(t,i,n){function a(){t.tt_isOpen?g():p()}function p(){(!C||t.$eval(n[d+"Enable"]))&&(t.tt_popupDelay?_||(_=l(h,t.tt_popupDelay,!1)):h())}function g(){t.$apply(function(){m()})}function h(){if(_=null,y&&(l.cancel(y),y=null),t.tt_content){x||(x=e(t,function(){}),$?angular.element(o.top.document.body).append(x):i.after(x)),t.$digest();var n,a=x[0].getBoundingClientRect(),r={};$?(n=c.adaptElements(i,a.width,a.height,t.tt_placement+"-center",!1,!0),r=angular.extend(r,{zIndex:c.getZIndex()},n[0])):(n=c.positionTooltip(i,a.width,a.height,t.tt_placement+"-center"),r=angular.extend(r,n)),x.css(r),t.tt_isOpen=!0,t.$digest()}}function m(){t.tt_isOpen=!1,l.cancel(_),_=null,t.tt_animation?y||(y=l(v,500)):v()}function v(){y=null,x&&(x.remove(),x=null)}function w(){i.unbind(k.show,p),i.unbind(k.hide,g)}function b(){k.show===k.hide?i.bind(k.show,a):(i.bind(k.show,p),i.bind(k.hide,g))}var x,_,y,C=angular.isDefined(n[d+"Enable"]),$=angular.isDefined(n[d+"AppendToBody"])?r(n[d+"AppendToBody"])(t):angular.isDefined(f.appendToBody)?f.appendToBody:!1,k=u(void 0);b();var E=t.$eval(n[d+"Animation"]);t.tt_placement=angular.isDefined(n[d+"Placement"])?n[d+"Placement"]:f.placement,t.tt_animation=angular.isDefined(E)?!!E:f.animation,t.tt_isOpen=!1,n.$observe(s,function(e){t.tt_content=e,!e&&t.tt_isOpen&&m()}),n.$observe(d+"PopupDelay",function(e){var i=parseInt(e,10);t.tt_popupDelay=isNaN(i)?f.popupDelay:i}),n.$observe(d+"Trigger",function(e){var t=u(e);t.show!=k.show&&(w(),k=t,b())}),$&&t.$on("$locationChangeSuccess",function(){t.tt_isOpen&&m()}),t.$on("$destroy",function(){l.cancel(y),l.cancel(_),w(),v()})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html",link:function(e,t){t.on("$destroy",function(){e.$destroy()})}}}).directive("tooltip",["$tooltip",function(e){return e("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html",link:function(e,t){t.on("$destroy",function(){e.$destroy()})}}}).directive("tooltipHtmlUnsafe",["$tooltip",function(e){return e("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.wisoft.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function(e,t,i){function n(e){for(var t in e)if(void 0!==a.style[t])return e[t]}var o=function(n,a,l){l=l||{};var r=e.defer(),s=o[l.animation?"animationEndEventName":"transitionEndEventName"],c=function(){i.$apply(function(){n.unbind(s,c),r.resolve(n)})};return s&&n.bind(s,c),t(function(){angular.isString(a)?n.addClass(a):angular.isFunction(a)?a(n):angular.isObject(a)&&n.css(a),s||r.resolve(n)}),r.promise.cancel=function(){s&&n.unbind(s,c),r.reject("Transition cancelled")},r.promise},a=document.createElement("trans"),l={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},r={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return o.transitionEndEventName=n(l),o.animationEndEventName=n(r),o}]),angular.module("ui.wisoft.tree",[]).factory("treeService",function(){var e={};return e.transData=function(e,t){for(var i,n=[],o={},a=0,l=e.length,r=t.idfield||"id",s=t.pidfield||"pid";l>a;)i=e[a++],o[i[r]]=i;for(a=0;l>a;){i=e[a++];var c=o[i[s]];c?(!c.children&&(c.children=[]),c.children.push(i)):n.push(i)}return[o,n]},e}).factory("RecursionHelper",["$compile",function(e){return{compile:function(t,i){angular.isFunction(i)&&(i={post:i});var n,o=t.contents().remove();return{pre:i&&i.pre?i.pre:null,post:function(t,a){n||(n=e(o)),n(t,function(e){a.append(e)}),i&&i.post&&i.post.apply(null,arguments)}}}}}]).filter("treeNodeFilter",function(){return function(e,t,i,n,o){var a={},l=[];return t?angular.forEach(e,function(e){if(e&&-1!=e[i].indexOf(t)){for(;e.__parent;)e=e.__parent;a[e[o]]||(a[e[o]]=e,l.push(e))}}):angular.forEach(e,function(e){e&&!e.__parent&&l.push(e)}),l}}).directive("wiTree",["RecursionHelper","treeService","$filter","$parse",function(e,t,i,n){return{restrict:"E",transclude:!0,templateUrl:"template/tree/treeTemplate.html",replace:!0,scope:{dataprovider:"=",filterby:"=",wid:"=",labelfunction:"&",onitemclick:"&",onloadbranch:"&",onbeforeexpand:"&",onexpand:"&",onbeforecollapse:"&",oncollapse:"&",onbeforeselect:"&",onselect:"&",oncancelselect:"&"},require:"wiTree",controller:["$scope","treeService",function(e,t){var i=this;if(e.isRoot=!e.$parent._treeCtrl,!e.isRoot)return e._treeCtrl=e.$parent._treeCtrl,void 0;e._treeCtrl=i;var n,o,a=i.conf={};i.handler={},i._hashData={},i.initData=function(e,t){a.multiselect?i.setMultiInit(e,t):i.setRadioInit(e,t)},i.setMultiInit=function(e,t){var n=t?t.__level+1:0,o=0;angular.forEach(e,function(e){e.__level=n,t&&(e.__parent=t),e.__closed=e.closed,e.__selected=e.selected,!a.cascade&&e.isbranch?(e.__closed=!0,e.children?e.children.length=0:e.children=[]):(e.isbranch||e.children&&!e.children.length)&&(e.children=void 0),e.children&&e.children.length&&i.setMultiInit(e.children,e),e.__selected&&o++}),t&&a.cascade&&(o==e.length?(t.__selected=!0,t.__semi=!1):0==o?(t.__selected=!1,t.__semi=!1):(t.__selected=!1,t.__semi=!0))},i.setRadioInit=function(e,t){var a=t?t.__level+1:0;angular.forEach(e,function(e){e.__level=a,t&&(e.__parent=t),e.__closed=e.closed,e.selected&&!o?(e.__selected=!0,e.__current=!0,n=e,o=e,function(e){for(;e;)e.__closed=!1,e=e.__parent}(t)):(e.__selected=!1,e.__current=!1),e.children?i.setRadioInit(e.children,e):e.isbranch&&(e.__closed=!0,e.children=[])})},i.changeCur=function(e){n!=e&&(n&&(n.__current=!1),n=e,n&&(n.__current=!0))},i.changeSel=function(e){o!=e&&(o&&(o.__selected=!1),o=e,o&&(o.__selected=!0))};var l=function(e){angular.forEach(e,function(e){i._hashData[e[a.idfield]]=e,e.children&&l(e.children)})};i.transData=function(e,n){if(a.isTree)l(e);else{var o=t.transData(e,{idfield:a.idfield,pidfield:a.pidfield,childrenfield:"children"});angular.extend(i._hashData,o[0]),e=o[1]}return i.initData(e,n),e},i.removeNode=function(e){e.__current&&(n=void 0),e.__selected&&(o=void 0),e.children&&angular.forEach(e.children,function(e){i.removeNode(e)}),delete i._hashData[e[a.idfield]]},i.destroyData=function(){n=void 0,o=void 0,i._hashData&&angular.forEach(i._hashData,function(e){e.__parent&&(e.__parent=null),e.children&&(e.children=null)})}}],compile:function(t){return e.compile(t,{post:function(e,t,o){var a=e.isRoot,l=e._treeCtrl,r=e.vm={},s=e.conf=l.conf,c=e.handler=l.handler;if(a){var d=e.$parent;angular.extend(s,{idfield:o.idfield||"id",pidfield:o.pidfield||"pid",labelfield:o.labelfield||"text",pCls:o.pcls,cCls:o.ccls||"icon-file",multiselect:!1,itemrenderer:o.itemrenderer,isTree:"true"==o.istree,cascade:"true"==o.cascade}),s.onitemclick=e.onitemclick()||angular.noop,s.onloadbranch=e.onloadbranch()||angular.noop,s.onbeforeexpand=e.onbeforeexpand()||angular.noop,s.onexpand=e.onexpand()||angular.noop,s.onbeforecollapse=e.onbeforecollapse()||angular.noop,s.oncollapse=e.oncollapse()||angular.noop,s.onbeforeselect=e.onbeforeselect()||angular.noop,s.onselect=e.onselect()||angular.noop,s.oncancelselect=e.oncancelselect()||angular.noop,function(){var e;if(o.multiselect){var t=n(o.multiselect);e=t.assign,s.multiselect=t(d),e&&d.$watch(t,function(e,t){e!==t&&(s.multiselect=e,l.changeCur(),l.initData(r._data))})}angular.isUndefined(e)&&(l.conf.multiselect=s.multiselect)}(),e.$watch("dataprovider",function(t){t&&(l.destroyData(),r._data=l.transData(e.dataprovider))},!1),e.$watch("filterby",function(t,n){t!=n&&(angular.forEach(l._hashData,function(e){e.__selected&&(e.__selected=!1)}),r._data=i("treeNodeFilter")(l._hashData,e.filterby,s.labelfield,s.pidfield,s.idfield))},!1),e.$on("$destroy",function(){l.destroyData()});var p=function(e,t){e=l.transData(e,t),t?(t.children=t.children?t.children.concat(e):e,t.__closed=!1):r._data=r._data.concat(e)},u=function(e){var t,i=e.__parent;i?(t=i.children,t.splice(t.indexOf(e),1),0==t.length&&(i.children=void 0)):(t=r._data,t.splice(t.indexOf(e),1)),l.removeNode(e)},f=function(e){angular.forEach(e.children,function(t){t.__selected=e.__selected,t.__semi=!1,t.children&&f(t)})},g=function(e){var t=0;angular.forEach(e.children,function(e){e.__selected&&t++}),0==t?(e.__selected=!1,e.__semi=!1):t==e.children.length?(e.__selected=!0,e.__semi=!1):(e.__selected=!1,e.__semi=!0),e.__parent&&g(e.__parent)},h=function(t){t.children&&t.__closed&&s.onbeforeexpand(t)!==!1&&(t.__closed=!1,t.isbranch&&!t.children.length?(t.__loading=!0,s.onloadbranch(t,function(i){t.__loading=!1,angular.isArray(i)&&(p(i,t),e.$apply()),s.onexpand(t)},function(){})):s.onexpand(t))},m=function(e){e.children&&!e.__closed&&s.onbeforecollapse(e)!==!1&&(e.__closed=!0,s.oncollapse(e))},v=function(e){var t=e.__selected;t||(s.multiselect?(s.onbeforeselect(e)!==!1&&(e.__selected=!0,e.__semi=!1,s.cascade&&(e.children&&f(e),e.__parent&&g(e.__parent)),s.onselect(e)),l.changeCur(e)):s.onbeforeselect(e)!==!1&&(l.changeSel(e),l.changeCur(e),s.onselect(e)))};c.clickRow=function(e){s.onitemclick(e);var t=e.__selected;t?s.multiselect&&(e.__selected=!1,e.__semi=!1,s.cascade&&(e.children&&f(e),e.__parent&&g(e.__parent)),s.oncancelselect(e),l.changeCur(e)):v(e)},c.toggleNode=function(e,t){t.__closed?h(t):m(t),e.stopPropagation()},c.toggleHover=function(e){e["wi-treehover"]=!e["wi-treehover"]},o.wid&&angular.isObject(e.wid)&&(e.wid.options=function(){return s},e.wid.loadData=function(t,i){s.isTree=i||!1,e.dataprovider=t},e.wid.getNode=function(e,t){var i=l._hashData;for(var n in i)if(i.hasOwnProperty(n)&&i[n][e]==t)return i[n]},e.wid.getNodes=function(e,t){var i=l._hashData,n=[];for(var o in i)i.hasOwnProperty(o)&&i[o][e]==t&&n.push(i[o]);return n},e.wid.getSelected=function(){var e,t=l._hashData;if(s.multiselect){var i=[];for(e in t)t.hasOwnProperty(e)&&1==t[e].__selected&&i.push(t[e]);return i}for(e in t)if(t.hasOwnProperty(e)&&1==t[e].__selected)return t[e]},e.wid.select=function(e){v(e)},e.wid.expandNode=function(e){h(e)},e.wid.collapseNode=function(e){m(e)},e.wid.append=function(t,i){angular.isArray(t)&&(p(t,i),e.$evalAsync())},e.wid.remove=function(e){u(e)},e.wid.updateNode=function(e,t){angular.extend(e,t)})}else e.$watch("dataprovider",function(t){t&&(r._data=e.dataprovider)},!1)}})}}}]),angular.module("template/accordion/wi-accordion-group.html",[]).run(["$templateCache",function(e){e.put("template/accordion/wi-accordion-group.html",'<div class="wi-accordion-group" ng-class="{\'open\': isOpen}">\n  <div class="wi-accordion-head"  ng-click="toggleOpen()" ng-class="{\'wi-accordion-disabled\': isDisabled}"\n       ng-style="{\'height\': style.headheight, \'line-height\': style.headheight}"\n       wi-accordion-transclude="heading">{{heading}}</div>\n  <div class="wi-accordion-panel" wi-collapse="!isOpen">\n      <div class="wi-accordion-cont" ng-style="{\'height\':panelStyle.cheight}" ng-transclude></div>\n  </div>\n</div>')}]),angular.module("template/accordion/wi-accordion.html",[]).run(["$templateCache",function(e){e.put("template/accordion/wi-accordion.html",'<div class="wi-accordion" ng-transclude></div>')}]),angular.module("template/button/wi-button.html",[]).run(["$templateCache",function(e){e.put("template/button/wi-button.html",'<button class="wi-btn" ng-style="{width: btnOptions.width, height: btnOptions.height}">\n    <img ng-if="btnOptions.iconl" class="wi-btn-icon" ng-src="{{btnOptions.iconl}}" />\n    {{btnOptions.label}}\n    <img ng-if="btnOptions.iconr" class="wi-btn-icon" ng-src="{{btnOptions.iconr}}" />\n</button>')}]),angular.module("template/camerascanner/camerascannerTemplate.html",[]).run(["$templateCache",function(e){e.put("template/camerascanner/camerascannerTemplate.html",'<div>\n    <div>\n        <a href="javascript:void(0);" class="wi-btn icon-picture" ng-click="open()">\n            <span ng-transclude></span>\n        </a>\n    </div>\n\n    <div class="wi-camerascanner wi-camerascanner-hide">\n\n        <div class="wi-camerascanner-main wi-clearf" style="width: 792px;height: 592px;">\n            <div class="wi-dialog-head">\n                拍照上传\n                <span style="margin-left: 130px; visibility: hidden;" class="wi-camerascanner-head-select">\n                    请选择视频设备:\n                </span>\n                <span class="wi-dialog-close icon-remove" ng-click="close()"></span>\n            </div>\n            <div class="wi-camerascanner-opt">\n                <object id="XwebcamXobjectX"\n                        type="application/x-shockwave-flash"\n                        data="demo/camerascanner/docs/jscam.swf"\n                        width="500"\n                        height="500">\n                    <param name="movie" value="demo/camerascanner/docs/jscam.swf" />\n                    <param name="FlashVars" value="cw=1200&ch=1600&vw=375&vh=500" />\n                    <param name="allowScriptAccess" value="always" />\n                    <param name="bgcolor" value="#FFFFCC" />\n                    <!--<param name="wmode" value="Opaque">-->\n                </object>\n                <div class="wi-camerascanner-toolbar">\n                    <a ng-click="rotate(-90)" href="javascript:void(0);" class="wi-camerascanner-left" title="逆时针旋转"></a>\n                    <a ng-click="rotate(90)" href="javascript:void(0);" class="wi-camerascanner-right" title="顺时针旋转"></a>\n                    <a ng-click="resetCut()" href="javascript:void(0);" class="wi-camerascanner-reset" title="重新裁剪"></a>\n                </div>\n            </div>\n\n            <div class="wi-camerascanner-list" style="width: 260px; height:465px;">\n            </div>\n\n            <div class="wi-camerascanner-qulitity">\n                图片质量:\n                <select ng-model="camResolution" ng-change="resolution()">\n                    <option value ="1200*1600">1200*1600(约1.92MB)</option>\n                    <option value ="960*1280">960*1280(约1.23MB)</option>\n                    <option value ="600*800">600*800(约480KB)</option>\n                </select>\n            </div>\n            <div class="wi-camerascanner-btns">\n                <a class="wi-camerascanner-btn" href="javascript:void(0);">拍照</a>\n                <a class="wi-btn" href="javascript:void(0);" ng-click="upload()">上传</a>\n            </div>\n\n        </div>\n\n        <wi-imageview width="800" height="600" adaptive="true" imagedata="imagedata" previous="previous()" next="next()" close="viewClose()"></wi-imageview>\n\n        <script type="text/ng-template" id="cameraScannerConfirm">\n            <div>\n                <div style="margin: 20px 30px;">\n                    文件名：<input ng-model="filename"/><br>\n                </div>\n                <div class="wi-alert-toolbar">\n                    <button class="wi-btn"  ng-click="closeThisDialog()">取消</button>\n                    <button class="wi-btn"  ng-click="confirm(filename)">确认</button>\n                </div>\n            </div>\n        </script>\n\n    </div>\n\n</div>\n')}]),angular.module("template/carousel/carousel.html",[]).run(["$templateCache",function(e){e.put("template/carousel/carousel.html",'<div ng-mouseenter="pause()" ng-mouseleave="play()" class="wi-carousel" ng-swipe-right="prev()" ng-swipe-left="next()">\n    <ul class="wi-carousel-ul" ng-show="slides.length > 1">\n        <li ng-repeat="slide in slides track by $index" ng-class="{\'wi-carousel-active\': isActive(slide)}" ng-click="select(slide)"></li>\n    </ul>\n    <div class="wi-carousel-inner" ng-transclude></div>\n    <a class="wi-carousel-ctrl wi-carousel-ctrl-left" ng-click="prev()" ng-show="slides.length > 1"><span class="icon-chevron-left"></span></a>\n    <a class="wi-carousel-ctrl wi-carousel-ctrl-right" ng-click="next()" ng-show="slides.length > 1"><span class="icon-chevron-right"></span></a>\n</div>\n')}]),angular.module("template/carousel/slide.html",[]).run(["$templateCache",function(e){e.put("template/carousel/slide.html","<div ng-class=\"{\n    'wi-slide-active': leaving || (active && !entering),\n    'wi-slide-prev': (next || active) && direction=='prev',\n    'wi-slide-next': (next || active) && direction=='next',\n    'wi-slide-right': direction=='prev',\n    'wi-slide-left': direction=='next'\n  }\" class=\"wi-slide\" ng-transclude></div>\n")}]),angular.module("template/combobox/comboboxTemplate.html",[]).run(["$templateCache",function(e){e.put("template/combobox/comboboxTemplate.html",'<div class="wi-popup wi-combobox"\n     ng-keydown="vm.keydownHandler($event)"\n     ng-click="vm.clickHandler($event)"\n     is-open="vm.isopen" ng-disabled="vm.enable">\n    <div class="wi-popup-menu wi-combobox-menu">\n        <ul>\n            <li ng-repeat="data in vm.dataprovider"\n                ng-class="{\'wi-combobox-selected\':($index===vm.selectedindex&&!data[\'isGroup\']) || data[\'_checked\'],\'wi-combobox-option\':!data[\'isGroup\']}"\n                ng-click="vm.itemClickHandler(data,$event)"\n                ng-style="{\'padding-left\': (groupfield&&!data[\'isGroup\']?15 : 5)+\'px\',\'font-weight\':data[\'isGroup\']?\'bold\':\'normal\'}">\n                <input ng-if="multiselect" class="wi-checkbox" type="checkbox" ng-click="checkAll()" ng-checked="data[\'_checked\']" />\n                {{data[vm.labelfield]}}\n            </li>\n        </ul>\n    </div>\n    <input type="text" ng-model="vm._text" ng-change="vm.inputChange()" ng-disabled="vm.enable"/>\n    <span class="icon-chevron-down"></span>\n</div>')}]),angular.module("template/datagrid/datagridTemplate.html",[]).run(["$templateCache",function(e){e.put("template/datagrid/datagridTemplate.html",'<div class="wi-datagrid" ng-class="{\'wi-datagrid-wordWrap\':!_wordwrap}">\n    <div class="wi-datagrid-ltop" >\n        <table ng-if="lockcolumns">\n            <colgroup>\n                <col ng-if="showno">\n                <col ng-if="multiselect">\n                <col ng-repeat="columnItem in columnDefs track by $index" ng-if="$index<lockcolumns"\n                     width="{{columnItem.width+\'px\'}}">\n            </colgroup>\n            <tbody>\n            <tr ng-repeat="head in headarray track by $index">\n                <td ng-if="$index==0 && showno" class="wi-datagrid-keycol" rowspan="{{::maxLevel}}"></td>\n                <td ng-if="$index==0 && multiselect" class="wi-datagrid-keycol" rowspan="{{::maxLevel}}">\n                    <input type="checkbox" class="wi-checkbox" ng-click="checkAll()" ng-checked="isCheckAll"  />\n                </td>\n                <td ng-repeat="child in head track by $index" ng-if="child.colindex<lockcolumns" colspan="{{::child.colspan}}" rowspan="{{::child.rowspan}}" ng-click="sort(child.colindex)" ng-mousemove="headMousemove($event)" ng-mouseleave="headMouseleave()" ng-mousedown="startColumnDrag($event,child,true)">\n                    <div class="wi-datagrid-headdiv">\n                        <div ng-if="child.headrenderer" ng-include src="child.headrenderer" class="wi-display-inlineb"></div>\n                        <span ng-if="!child.headrenderer">{{child.text}}</span>\n                        <span ng-if="sortcolumn.datafield==child.datafield" class="wi-datagrid-caret{{sortcolumn.direction}}"></span>\n                    </div>\n                </td>\n                <td>&nbsp;</td><!-- 防止合并行高度自适应 -->\n            </tr>\n            </tbody>\n        </table>\n    </div>\n\n    <div class="wi-datagrid-rtop">\n        <table ng-style="{width: (rightW + 17) + \'px\'}">\n            <colgroup>\n                <col ng-if="showno && !lockcolumns">\n                <col ng-if="multiselect && !lockcolumns">\n                <col ng-repeat="columnItem in columnDefs track by $index" ng-if="!lockcolumns||$index>=lockcolumns"\n                     width="{{columnItem.width+\'px\'}}">\n                <col width="17px">\n            </colgroup>\n            <tbody>\n            <tr ng-repeat="head in headarray track by $index">\n                <td ng-if="$index==0 && showno && !lockcolumns" class="wi-datagrid-keycol" rowspan="{{::maxLevel}}"></td>\n                <td ng-if="$index==0 && multiselect && !lockcolumns" class="wi-datagrid-keycol" rowspan="{{::maxLevel}}">\n                    <input type="checkbox" class="wi-checkbox" ng-click="checkAll()" ng-checked="isCheckAll" />\n                </td>\n                <td ng-repeat="child in head track by $index" ng-if="!lockcolumns||child.colindex>=lockcolumns" colspan="{{::child.colspan}}" rowspan="{{::child.rowspan}}" ng-click="sort(child.colindex)" ng-mousemove="headMousemove($event)" ng-mouseleave="headMouseleave()" ng-mousedown="startColumnDrag($event,child,false)">\n                    <div class="wi-datagrid-headdiv">\n                        <div ng-if="child.headrenderer" ng-include src="child.headrenderer" class="wi-display-inlineb"></div>\n                        <span ng-if="!child.headrenderer">{{child.text}}</span>\n                        <span ng-if="sortcolumn.datafield==child.datafield" class="wi-datagrid-caret{{sortcolumn.direction}}"></span>\n                    </div>\n                </td>\n                <td style="border-color: transparent; cursor: default;">&nbsp;</td><!-- 防止合并行高度自适应 -->\n            </tr>\n            </tbody>\n        </table>\n    </div>\n\n    <div class="wi-datagrid-lbottom">\n        <table id="lBottomTable">\n            <col ng-if="showno">\n            <col ng-if="multiselect">\n            <col ng-repeat="columnItem in columnDefs track by $index" ng-if="$index<lockcolumns"\n                 width="{{columnItem.width+\'px\'}}">\n            <tr id="lBottomTR{{::$index}}" ng-style="{\'background-color\':pdata.__rowcolor,\'height\':_rowheight+\'px\'}" ng-class="{\'wi-datagrid-row-selected\':pdata.__ischecked}">\n\n            </tr>\n            <tr class="wi-datagrid-cover"><td></td></tr>\n        </table>\n    </div>\n\n    <div class="wi-datagrid-rbottom">\n        <table id="rBottomTable" ng-style="{width: rightW + \'px\'}">\n            <col ng-if="showno && !lockcolumns">\n            <col ng-if="multiselect && !lockcolumns">\n            <col ng-repeat="columnItem in columnDefs track by $index" ng-if="!lockcolumns||$index>=lockcolumns"\n                 width="{{columnItem.width+\'px\'}}" >\n            <tr id="rBottomTR{{::$index}}" ng-style="{\'background-color\':pdata.__rowcolor,\'height\':_rowheight+\'px\'}" ng-class="{\'wi-datagrid-row-selected\':pdata.__ischecked}">\n\n            </tr>\n        </table>\n    </div>\n\n    <div class="wi-datagrid-pagebar">\n        <div class="wi-datagrid-page-left" ng-if="pagemode!==\'none\'">\n            <span>\n                每页\n                <select id="pageSizeSel" ng-model="$parent.selectedPageSize"  ng-options="op for op in pageselect||[20,30,40,50,60]">\n                </select>\n                条&nbsp;,&nbsp;共{{dataCount}}条\n            </span>\n            <span>\n                <a href="#" ng-click="pageNum===1?null:doPage(1)" title="首页"><span class="icon-step-backward"></span></a>\n                <a href="#" ng-click="pageNum===1?null:doPage(pageNum-1)" title="上一页"><span class="icon-backward"></span></a>\n                &nbsp;&nbsp;{{pageNum}}/{{pageCount}}&nbsp;&nbsp;\n                <a href="#" ng-click="pageNum===pageCount?null:doPage(pageNum+1)" title="下一页"><span class="icon-forward"></span></a>\n                <a href="#" ng-click="pageNum===pageCount?null:doPage(pageCount)" title="尾页"><span class="icon-step-forward"></span></a>\n                <input type="text" class="wi-datagrid-page-num" onclick="javascript:this.select()" ng-keydown="gotoPage($event)" />\n            </span>\n        </div>\n        <div class="wi-datagrid-page-right">\n            <span ng-if="pagebarrenderer" ng-include src="pagebarrenderer"/>\n            <span ng-if="!(showrefresh==\'false\')">\n                <a href="#" ng-click="dorefresh()"><span class="icon-refresh"></span> 刷新</a>\n            </span>\n            <span ng-if="showexcel">\n                <a href="#" download="导出文件.xls" ng-click="export2excel($event)"><span class="icon-share-alt"></span> 导出excel</a>\n            </span>\n        </div>\n    </div>\n\n    <div class="wi-datagrid-followbar" style=\'display: none; left: 0;\'></div>\n\n    <div class=\'wi-datagrid-maskdiv\' style=\'visibility: hidden\'></div>\n    <div id="ngTranscludeDiv" ng-transclude></div>\n</div>')}]),angular.module("template/dividedbox/wi-dividedbox-group.html",[]).run(["$templateCache",function(e){e.put("template/dividedbox/wi-dividedbox-group.html","<div class=\"wi-dividedbox-group\"\n     ng-style=\"{ width:dividedboxG.type=='h'?'calc('+ dividedboxG.size +' + '+ dividedboxG.resize +'px)':'',\n        height:dividedboxG.type=='v'?'calc('+dividedboxG.size+' + '+dividedboxG.resize+'px)':''}\">\n    <div class=\"wi-dividedbox-head wi-clearf\" ng-class=\"{'wi-dividedbox-colled':dividedboxG.collapsed}\">\n        <span class=\"wi-dividedbox-title\">\n"+'            <img class="wi-dividedbox-icon" ng-if="dividedboxG.icon" ng-src="{{dividedboxG.icon}}" />\n            {{dividedboxG.title}}\n        </span>\n        <div ng-class="\'wi-display-none wi-dividedbox-collctrl-\'+dividedboxG.collapseto" ng-click="doCollapse()"></div>\n    </div>\n    <div class="wi-dividedbox-cont" ng-transclude></div>\n    <div class="wi-dividedbox-bar" ng-mousedown="startResize()"></div>\n</div>')}]),angular.module("template/dividedbox/wi-dividedbox.html",[]).run(["$templateCache",function(e){e.put("template/dividedbox/wi-dividedbox.html","<div class=\"wi-dividedbox wi-clearf\"\n     ng-class=\"{'wi-unselectable':resizeConf.resizing,'wi-dividedbox-resizing':resizeConf.resizing,'wi-dividedbox-resizable': resizeConf.resizable}\" ng-transclude>\n</div>")}]),angular.module("template/fileupload/wi-fileupload.html",[]).run(["$templateCache",function(e){e.put("template/fileupload/wi-fileupload.html",'<ul class="wi-fileupload" ng-style="{display: files.length>0 && !fileULOptions.modal ? \'\' : \'none\'}">\n    <li ng-repeat="file in files track by file.id">\n        <span class="wi-fileupload-info" ng-style="{cursor: file.stat==3 ? \'pointer\': \'\'}" ng-click="getResponse(file)">\n            <span class="wi-fileupload-icon icon-{{file.type}}"></span>\n            {{file.name}}\n            <span class="wi-fileupload-tip">({{file.size}})</span>\n        </span>\n        <span class="wi-fileupload-completed" ng-style="{display: file.stat==3 ? \'\' : \'none\'}">完成</span>\n        <span class="wi-fileupload-queued" ng-style="{display: file.stat==1 ? \'\' : \'none\'}">等待上传</span>\n        <!--<span class="wi-fileupload-uploading" ng-style="{display: file.stat==2 ? \'\' : \'none\'}">\n            <span class="wi-fileupload-bar">\n                <div class="wi-fileupload-progress" ng-style="{\'width\': file.percent + \'%\'}"></div>\n            </span>\n            {{file.percent}}%\n        </span>-->\n        <wi-progress ng-style="{display: file.stat==2 ? \'\' : \'none\'}" label="file.progressLabel" value="file.percent"></wi-progress>\n        <span class="wi-fileupload-error" ng-style="{display: file.stat==4 ? \'\' : \'none\'}">上传失败</span>\n        <span class="wi-fileupload-del" ng-click="removeFile(file)">删除</span>\n    </li>\n</ul>')}]),angular.module("template/imageview/imageviewTemplate.html",[]).run(["$templateCache",function(e){e.put("template/imageview/imageviewTemplate.html",'<div class="wi-imageview" ng-style="{\'display\':isopen?\'block\':\'none\'}">\n    <div class="wi-imageview-picbox" ng-style="{\'top\':top,\'left\':left}">\n        <div class="wi-imageview-pic" ng-style="{\'width\':+_width+\'px\',\'height\':+_height+\'px\'}"  ng-class="img_exclass" ng-mouseenter="mouseenter()" ng-mouseleave="mouseleave()" ng-mousedown="mousedown($event)"></div>\n        <div class="wi-imageview-ctrl wi-imageview-ctrl-prev" ng-click="previous()" title="上一张" ng-if="_show_previous"></div>\n        <div class="wi-imageview-ctrl wi-imageview-ctrl-next" ng-click="next()" title="下一张" ng-if="_show_next"></div>\n        <div class="wi-imageview-toolbar wi-unselectable">\n            <a class="wi-imageview-zoomout" ng-click="zoomout()" title="放大"></a>\n            <a class="wi-imageview-zoomin" ng-click="zoomin()" title="缩小"></a>\n            <a class="wi-imageview-reset" ng-click="reset()" title="重置"></a>\n            <a class="wi-imageview-toleft" ng-click="toright()" title="逆时针旋转"></a>\n            <a class="wi-imageview-toright" ng-click="toleft()" title="顺时针旋转"></a>\n            <a class="wi-imageview-save" style="text-decoration:none;" href="{{img_src}}" title="本地保存" ng-if="_show_save"></a>\n            <a class="wi-imageview-full" ng-click="full()" title="全屏" ng-if="!isfull"></a>\n            <a class="wi-imageview-origin" ng-click="origin()" title="退出全屏" ng-if="isfull"></a>\n        </div>\n        <div class="wi-imageview-close" ng-click="close()"></div>\n    </div>\n</div>\n\n\n')
}]),angular.module("template/menu/wi-menu.html",[]).run(["$templateCache",function(e){e.put("template/menu/wi-menu.html",'<div class="wi-menu" ng-class="{\'wi-menu-open\': isOpen, \'wi-menu-root\': menutype != \'sub\'}">\n    <div class="wi-menu-toolbar wi-clearf" ng-style="{display: conf.filterable || groupsBackward.length || groupsForward.length ? \'block\':\'none\'}">\n        <span class="wi-menu-backward" ng-class="{\'wi-menu-page\': groupsBackward.length}" ng-click="backwardClick($event)">\n            <span class="icon-arrow-left"></span></span>\n        <input type="text" class="wi-menu-filter" ng-style="{display: conf.filterable ? \'inline-block\' : \'none\'}" ng-model="filterval" onclick="event.stopPropagation()" placeholder="检索关键字" />\n        <span class="wi-menu-forward" ng-class="{\'wi-menu-page\': groupsForward.length}" ng-click="forwardClick($event)">\n            <span class="icon-arrow-right"></span></span>\n    </div>\n    <ul ng-repeat="data in datagroups">\n        <li ng-repeat="item in data"\n            ng-class="{\'wi-menu-children\': item.children, \'wi-menu-disabled\': item.enabled == false, \'wi-menu-highlight\': item.highlight, \'wi-menu-item-open\': item.childopen}"\n            ng-mouseenter="mouseenter(item)" ng-mouseleave="mouseleave(item)" ng-click="clickLi($event, item)">\n            <img ng-if="item.icon" class="wi-menu-icon" ng-src="{{item.icon}}" />\n            <span class="wi-menu-content">{{item.label}}</span>\n            <wi-menu ng-if="item.children"\n                     adaptable="true"\n                     position="right-top"\n                     filterable="{{item.filterable}}"\n                     dataprovider="item.children"\n                     is-open="{{item.childopen}}">\n            </wi-menu>\n        </li>\n    </ul>\n</div>')}]),angular.module("template/panel/wi-panel.html",[]).run(["$templateCache",function(e){e.put("template/panel/wi-panel.html",'<div class="wi-panel" ng-class="{\'wi-panel-close\': !isOpen}"\n     ng-style="{\'width\': width}">\n    <div class="wi-panel-head" ng-click="collbyHead()">\n        <div wi-panel-transclude="headingEl">\n            <img ng-if="headicon" class="wi-panel-icon" ng-src="{{headicon}}" />\n            {{heading}}\n        </div>\n        <div ng-if="headTools.visible" class="wi-panel-tools"><!--span首尾相连，避免换行产生空格-->\n            <span ng-repeat="tool in headTools.custom track by tool.name"\n                  ng-click="tool.opt($event)" class="{{tool.cls}}"></span\n            ><span ng-if="headTools[\'collapse\']"\n                  ng-click="collbyTool($event)"\n                  ng-class="{\'icon-chevron-down\':collapsed, \'icon-chevron-up\':!collapsed}"></span\n            ><span ng-if="headTools[\'close\']" class="icon-remove"\n                  ng-click="closebyTool($event)"></span>\n        </div>\n    </div>\n    <div class="wi-panel-box" wi-collapse="collapsed" ng-transclude></div>\n</div>')}]),angular.module("template/popupbutton/popupbuttonTemplate.html",[]).run(["$templateCache",function(e){e.put("template/popupbutton/popupbuttonTemplate.html",'<div class="wi-popup wi-popupbutton"\n     is-open="isopen">\n    <div class="wi-popup-menu wi-popupbutton-menu" ng-transclude></div>\n    <input class="wi-btn wi-popupbutton-content" type="button" value="{{label}}"/>\n    <button class="wi-btn wi-popupbutton-arrow"><span class="icon-chevron-down"></span></button>\n</div>')}]),angular.module("template/progress/wi-progress.html",[]).run(["$templateCache",function(e){e.put("template/progress/wi-progress.html",'<div class="wi-progress">\n    <span class="wi-progress-bar" ng-style="{\'width\': width}">\n        <div class="wi-progress-value" ng-style="{\'width\': percent + \'%\'}"></div>\n        <div class="wi-progress-remain"></div>\n    </span>\n</div>')}]),angular.module("template/searchinput/wi-searchinput.html",[]).run(["$templateCache",function(e){e.put("template/searchinput/wi-searchinput.html",'<span class="wi-searchinput">\n    <input type="text" ng-model="value" placeholder="{{tips}}" />\n    <span class="icon-search" ng-click="search()"></span>\n</span>\n')}]),angular.module("template/tebset/tabsetTemplate.html",[]).run(["$templateCache",function(e){e.put("template/tebset/tabsetTemplate.html","<div ng-style=\"{'width': conf.width,'height': conf.height}\" class=\"wi-tabset\"\n     ng-class=\"{'h':'wi-tabset-h','v':'wi-tabset-v wi-clearf','vh':'wi-tabset-vh wi-clearf'}[conf.vertical?conf.height?'vh':'v':'h']\">\n    <div class=\"wi-tabhead\"\n         ng-style=\"{'height':!conf.vertical?conf.tabheadsize+'px':'','line-height': !conf.vertical?conf.tabheadsize+'px':'',\n            'width': conf.vertical?conf.tabheadsize+'px':''}\">\n"+'        <span ng-if="scrollable" ng-click="backward()" class="wi-unselectable wi-tabctrl-ver icon-chevron-up"></span><!-- 横向超出才显示 -->\n        <span ng-if="scrollable" ng-click="forward()" class="wi-unselectable wi-tabctrl-ver icon-chevron-down"></span>\n        <span ng-if="scrollable" ng-click="backward()" class="wi-unselectable wi-tabctrl-hor icon-chevron-left"></span><!-- 纵向超出才显示 -->\n        <span ng-if="scrollable" ng-click="forward()" class="wi-unselectable wi-tabctrl-hor icon-chevron-right"></span>\n        <div class="wi-tabstage">\n            <ul ng-class="{true:\'wi-tabul-ver\',false:\'wi-tabul-hor wi-clearf\'}[conf.vertical]"\n                ng-style="ulStyle" style="overflow: visible;"\n                ng-transclude></ul>\n            <wi-menu ng-show="conf.enablerightmenu" wi-right-menu dataprovider="menudata" onselect="rightmenuselect"></wi-menu>\n        </div>\n    </div>\n    <div class="wi-tabcont"\n         ng-style="{\'height\':(conf.height&&!conf.vertical)?\'calc(100% - \'+conf.tabheadsize+\'px )\':\'\',\'margin-left\':conf.vertical?conf.tabheadsize+\'px\':\'\'}">\n        <div ng-repeat="tab in tabs"\n             class="wi-tabpane"\n             ng-show="tab.active"\n             ng-style = "{\'height\':(conf.height||conf.vertical)?\'100%\':\'\'}"\n             wi-tab-content-transclude="tab">\n            <div ng-if="tab.data.src"  ng-include="tab.data.src"></div>\n        </div>\n    </div>\n</div>\n')}]),angular.module("template/tebset/tabTemplate.html",[]).run(["$templateCache",function(e){e.put("template/tebset/tabTemplate.html",'<li class="wi-tab"\n    ng-class="{\'wi-tab-active\': active, \'wi-tab-disabled\': disable, \'wi-tab-hasclose\': _closeable}"\n    ng-click="select()">\n    <span class="icon-remove" ng-click="close($event)"></span>\n    <div class="wi-tabhead-cont" wi-tab-heading-transclude>\n        <img class="wi-tab-icon" ng-src="{{data.icon}}" ng-if="data.icon"/>{{heading}}\n    </div>\n</li>')}]),angular.module("template/tilelist/tilelistTemplate.html",[]).run(["$templateCache",function(e){e.put("template/tilelist/tilelistTemplate.html",'<div class="wi-titlelist">\n    <table class="wi-titlelist-table" cellspacing="0" cellpadding="0" ng-style="{\'width\': tableW,\'height\': tableH}">\n        <tr ng-repeat="rowItem in dataTable">\n            <td class="wi-titlelist-td" ng-repeat="data in rowItem track by $index" ng-style="{\'width\': colW,\'height\': rowH}">\n                <div class="wi-titlelist-cont" ng-if="itemrender" ng-include src="itemrender"></div>\n            </td>\n        </tr>\n    </table>\n</div>\n')}]),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function(e){e.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="wi-tooltip {{\'wi-tooltip-\' + placement}}" ng-class="{ \'wi-tooltip-in\': isOpen() }">\n  <div class="tooltip-inner" bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function(e){e.put("template/tooltip/tooltip-popup.html",'<div class="wi-tooltip {{\'wi-tooltip-\' + placement}}" ng-class="{ \'wi-tooltip-in\': isOpen(),\'wi-fade\': animation() }">\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("template/tree/treeTemplate.html",[]).run(["$templateCache",function(e){e.put("template/tree/treeTemplate.html","<ul class=\"wi-tree\">\n    <li ng-repeat=\"data in vm._data | orderBy : conf.orderby\">\n        <div class=\"wi-tree-item\" ng-class=\"{'wi-tree-current':data['__current']}\"\n             ng-style=\"{'padding-left': 16*(data['__level']+(data['children']?0:1))+'px'}\"\n             ng-click=\"handler.clickRow(data)\"\n             ng-mouseenter=\"handler.toggleHover(data)\" ng-mouseleave=\"handler.toggleHover(data)\">\n            <span class=\"icon-{{data['__closed']?'plus':'minus'}}\"\n                  ng-if=\"!!data['children']\"\n                  ng-click=\"handler.toggleNode($event,data)\"></span>\n            <!-- 选中或半选 -->\n            <input type=\"checkbox\" class=\"wi-checkbox\"\n                   ng-class=\"{'wi-tree-transparent-50':data['__semi']}\"\n                   ng-if=\"conf.multiselect\"\n                   ng-checked=\"data['__selected']||data['__semi']\" />\n            <span class=\"wi-tree-loading\" ng-if=\"data['__loading']\"></span>\n            <!-- 优先级：数据项中 cls，根节点定义的 pCls 或 cCls，默认图标 -->\n            <span class=\"wi-tree-icon {{data['cls']||(data['children']?\n                conf.pCls||'icon-folder-'+(data['__closed']?'close':'open'):\n                conf.cCls)}}\" ng-if=\"!data['__loading']\"></span>\n            <span>{{data[conf.labelfield]}}</span>\n            <span ng-if=\"conf.itemrenderer\"\n                  ng-include src=\"conf.itemrenderer\"></span>\n        </div>\n        <wi-tree ng-if=\"data['children'] && !data['__closed']\"\n                 dataProvider=\"data['children']\">\n        </wi-tree>\n    </li>\n</ul>")}]);