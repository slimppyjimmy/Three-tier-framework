<div ng-contoller="">
<article class="markdown-body entry-content" itemprop="text">
    <h1><a id="user-content-angular规范" class="anchor" href="#angular规范" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DIST Angular规范</h1>
    <h2><a id="user-content-目录" class="anchor" href="#目录" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>目录</h2>

    <ol>
        <li><a href="#style-y001">单一职责</a></li>
        <li><a href="#iife">IIFE</a></li>
        <li><a href="#modules">Modules</a></li>
        <li><a href="#controllers">Controllers</a></li>
        <li><a href="#services">Services</a></li>
        <li><a href="#factories">Factories</a></li>
        <li><a href="#data-services">Data Services</a></li>
        <li><a href="#directives">Directives</a></li>
        <li><a href="#%E8%A7%A3%E5%86%B3controller%E7%9A%84promises">解决Controller的Promises</a></li>
        <li><a href="#%E6%89%8B%E5%8A%A8%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5">手动依赖注入</a></li>
        <li><a href="#%E5%8E%8B%E7%BC%A9%E5%92%8C%E6%B3%A8%E9%87%8A">压缩和注释</a></li>
        <li><a href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86">异常处理</a></li>
        <li><a href="#%E5%91%BD%E5%90%8D">命名</a></li>
        <li><a href="#%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%BB%93%E6%9E%84lift%E5%8E%9F%E5%88%99">应用程序结构LIFT原则</a></li>
        <li><a href="#%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%BB%93%E6%9E%84">应用程序结构</a></li>
        <li><a href="#%E6%A8%A1%E5%9D%97%E5%8C%96">模块化</a></li>
        <li><a href="#%E5%90%AF%E5%8A%A8%E9%80%BB%E8%BE%91">启动逻辑</a></li>
        <li><a href="#angular-%E5%8C%85%E8%A3%85%E6%9C%8D%E5%8A%A1">Angular $包装服务</a></li>
        <li><a href="#%E6%B5%8B%E8%AF%95">测试</a></li>
        <li><a href="#%E5%8A%A8%E7%94%BB">动画</a></li>
        <li><a href="#%E6%B3%A8%E9%87%8A">注释</a></li>
        <li><a href="#js-hint">JSHint</a></li>
        <li><a href="#jscs">JSCS</a></li>
        <li><a href="#%E5%B8%B8%E9%87%8F">常量</a></li>
        <li><a href="#%E6%96%87%E4%BB%B6%E6%A8%A1%E6%9D%BF%E5%92%8C%E7%89%87%E6%AE%B5">文件模板和片段</a></li>
        <li><a href="#yeoman-generator">Yeoman Generator</a></li>
        <li><a href="#%E8%B7%AF%E7%94%B1">路由</a></li>
        <li><a href="#%E4%BB%BB%E5%8A%A1%E8%87%AA%E5%8A%A8%E5%8C%96">任务自动化</a></li>
        <li><a href="#filters">Filters</a></li>
        <li><a href="#angularjs%E6%96%87%E6%A1%A3">Angular文档</a></li>
        <li><a href="#%E8%B4%A1%E7%8C%AE">贡献</a></li>
        <li><a href="#%E8%AE%B8%E5%8F%AF">许可</a></li>
    </ol>

    <h2><a id="user-content-单一职责" class="anchor" href="#单一职责" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>单一职责</h2>

    <h3><a id="user-content-规则一" class="anchor" href="#规则一" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>规则一</h3>

    <h6><a id="style-y001" class="anchor" name="style-y001" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a name="style-y001">Y001</a>]</h6>

    <ul>
        <li><p>一个文件只定义一个组件。</p>
            <p>下面的例子在同一个文件中定义了一个<code>app</code>的module和它的一些依赖、一个controller和一个factory。</p>
            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
angular
  .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>, [<span class="pl-s"><span class="pl-pds">'</span>ngRoute<span class="pl-pds">'</span></span>])
  .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>SomeController<span class="pl-pds">'</span></span>, SomeController)
  .<span class="pl-en">factory</span>(<span class="pl-s"><span class="pl-pds">'</span>someFactory<span class="pl-pds">'</span></span>, someFactory);
<span class="pl-k">function</span> <span class="pl-en">SomeController</span>() { }
<span class="pl-k">function</span> <span class="pl-en">someFactory</span>() { }</pre></div>
            <p>推荐以下面的方式来做，把上面相同的组件分割成单独的文件。</p>
            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
<span class="pl-c">// app.module.js</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>, [<span class="pl-s"><span class="pl-pds">'</span>ngRoute<span class="pl-pds">'</span></span>]);</pre></div>
            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
<span class="pl-c">// someController.js</span>
angular
      .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
      .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>SomeController<span class="pl-pds">'</span></span>, SomeController);
<span class="pl-k">function</span> <span class="pl-en">SomeController</span>() { }</pre></div>
            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
<span class="pl-c">// someFactory.js</span>
angular
      .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
      .<span class="pl-en">factory</span>(<span class="pl-s"><span class="pl-pds">'</span>someFactory<span class="pl-pds">'</span></span>, someFactory);
<span class="pl-k">function</span> <span class="pl-en">someFactory</span>() { }</pre></div></li>
    </ul>
    <p><strong><a href="#%E7%9B%AE%E5%BD%95">返回顶部</a></strong></p>
    <h2><a id="user-content-iife" class="anchor" href="#iife" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IIFE</h2>
    <h3><a id="user-content-javascript闭包" class="anchor" href="#javascript闭包" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JavaScript闭包</h3>
    <h6><a id="user-content-style-y010" class="anchor" href="#style-y010" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y010">Y010</a>]</h6>
    <ul>
        <li><p>把Angular组件包装到一个立即调用函数表达式中（IIFE）。</p>

            <p><em>为什么？</em>：把变量从全局作用域中删除了，这有助于防止变量和函数声明比预期在全局作用域中有更长的生命周期，也有助于避免变量冲突。</p>

            <p><em>为什么？</em>：当你的代码为了发布而压缩了并且被合并到同一个文件中时，可能会有很多变量发生冲突，使用了IIFE（给每个文件提供了一个独立的作用域），你就不用担心这个了。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
<span class="pl-c">// logger.js</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">factory</span>(<span class="pl-s"><span class="pl-pds">'</span>logger<span class="pl-pds">'</span></span>, logger);

<span class="pl-c">// logger function会被当作一个全局变量</span>
<span class="pl-k">function</span> <span class="pl-en">logger</span>() { }

<span class="pl-c">// storage.js</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">factory</span>(<span class="pl-s"><span class="pl-pds">'</span>storage<span class="pl-pds">'</span></span>, storage);

<span class="pl-c">// storage function会被当作一个全局变量</span>
<span class="pl-k">function</span> <span class="pl-en">storage</span>() { }</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/**</span>
<span class="pl-c">* recommended</span>
<span class="pl-c">*</span>
<span class="pl-c">* 再也不存在全局变量了</span>
<span class="pl-c">*/</span>

<span class="pl-c">// logger.js</span>
(<span class="pl-k">function</span>() {
    <span class="pl-s"><span class="pl-pds">'</span>use strict<span class="pl-pds">'</span></span>;

    angular
        .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
        .<span class="pl-en">factory</span>(<span class="pl-s"><span class="pl-pds">'</span>logger<span class="pl-pds">'</span></span>, logger);

    <span class="pl-k">function</span> <span class="pl-en">logger</span>() { }
})();

<span class="pl-c">// storage.js</span>
(<span class="pl-k">function</span>() {
    <span class="pl-s"><span class="pl-pds">'</span>use strict<span class="pl-pds">'</span></span>;

    angular
        .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
        .<span class="pl-en">factory</span>(<span class="pl-s"><span class="pl-pds">'</span>storage<span class="pl-pds">'</span></span>, storage);

    <span class="pl-k">function</span> <span class="pl-en">storage</span>() { }
})();</pre></div></li>
        <li><p>注：为了简洁起见，本规范余下的示例中将会省略IIFE语法。</p></li>
        <li><p>注：IIFE阻止了测试代码访问私有成员（正则表达式、helper函数等），这对于自身测试是非常友好的。然而你可以把这些私有成员暴露到可访问成员中进行测试，例如把私有成员（正则表达式、helper函数等）放到factory或是constant中。</p></li>
    </ul>

    <p><strong><a href="#%E7%9B%AE%E5%BD%95">返回顶部</a></strong></p>

    <h2><a id="user-content-modules" class="anchor" href="#modules" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Modules</h2>

    <h3><a id="user-content-避免命名冲突" class="anchor" href="#避免命名冲突" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>避免命名冲突</h3>

    <h6><a id="user-content-style-y020" class="anchor" href="#style-y020" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y020">Y020</a>]</h6>

    <ul>
        <li><p>每一个独立子模块使用唯一的命名约定。</p>

            <p><em>为什么</em>：避免冲突，每个模块也可以方便定义子模块。</p></li>
    </ul>

    <h3><a id="user-content-定义aka-setters" class="anchor" href="#定义aka-setters" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>定义(aka Setters)</h3>

    <h6><a id="user-content-style-y021" class="anchor" href="#style-y021" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y021">Y021</a>]</h6>

    <ul>
        <li><p>不使用任何一个使用了setter语法的变量来定义modules。</p>

            <p><em>为什么?</em>：在一个文件只有一个组件的条件下，完全不需要为一个模块引入一个变量。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
<span class="pl-k">var</span> app <span class="pl-k">=</span> <span class="pl-smi">angular</span>.<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>, [
    <span class="pl-s"><span class="pl-pds">'</span>ngAnimate<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>ngRoute<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>app.shared<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">'</span>app.dashboard<span class="pl-pds">'</span></span>
]);</pre></div>

            <p>你只需要用简单的setter语法来代替。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
angular
      .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>, [
      <span class="pl-s"><span class="pl-pds">'</span>ngAnimate<span class="pl-pds">'</span></span>,
      <span class="pl-s"><span class="pl-pds">'</span>ngRoute<span class="pl-pds">'</span></span>,
      <span class="pl-s"><span class="pl-pds">'</span>app.shared<span class="pl-pds">'</span></span>,
      <span class="pl-s"><span class="pl-pds">'</span>app.dashboard<span class="pl-pds">'</span></span>
  ]);</pre></div></li>
    </ul>

    <h3><a id="user-content-getters" class="anchor" href="#getters" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Getters</h3>

    <h6><a id="user-content-style-y022" class="anchor" href="#style-y022" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y022">Y022</a>]</h6>

    <ul>
        <li><p>使用module的时候，避免直接用一个变量，而是使用getter的链式语法。</p>

            <p><em>为什么？</em>：这将产生更加易读的代码，并且可以避免变量冲突和泄漏。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
<span class="pl-k">var</span> app <span class="pl-k">=</span> <span class="pl-smi">angular</span>.<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>);
<span class="pl-smi">app</span>.<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>SomeController<span class="pl-pds">'</span></span>, SomeController);

<span class="pl-k">function</span> <span class="pl-en">SomeController</span>() { }</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>SomeController<span class="pl-pds">'</span></span>, SomeController);

<span class="pl-k">function</span> <span class="pl-en">SomeController</span>() { }</pre></div></li>
    </ul>

    <h3><a id="user-content-setting-vs-getting" class="anchor" href="#setting-vs-getting" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setting vs Getting</h3>

    <h6><a id="user-content-style-y023" class="anchor" href="#style-y023" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y023">Y023</a>]</h6>

    <ul>
        <li><p>只能设置一次。</p>

            <p><em>为什么？</em>：一个module只能被创建一次，创建之后才能被检索到。</p></li>
    </ul>

<pre><code>- 设置module，`angular.module('app', []);`。
    - 获取module，`angular.module('app');`。
</code></pre>

    <h3><a id="user-content-命名函数-vs-匿名函数" class="anchor" href="#命名函数-vs-匿名函数" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>命名函数 vs 匿名函数</h3>

    <h6><a id="user-content-style-y024" class="anchor" href="#style-y024" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y024">Y024</a>]</h6>

    <ul>
        <li><p>回调函数使用命名函数，不要用匿名函数。</p>

            <p><em>为什么？</em>：易读，方便调试，减少嵌套回调函数的数量。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>Dashboard<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>() { })
    .<span class="pl-en">factory</span>(<span class="pl-s"><span class="pl-pds">'</span>logger<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>() { });</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>

<span class="pl-c">// dashboard.js</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>Dashboard<span class="pl-pds">'</span></span>, Dashboard);

<span class="pl-k">function</span> <span class="pl-en">Dashboard</span> () { }</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">// logger.js</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">factory</span>(<span class="pl-s"><span class="pl-pds">'</span>logger<span class="pl-pds">'</span></span>, logger);

<span class="pl-k">function</span> <span class="pl-en">logger</span> () { }</pre></div></li>
    </ul>

    <p><strong><a href="#%E7%9B%AE%E5%BD%95">回到顶部</a></strong></p>

    <h2><a id="user-content-controllers" class="anchor" href="#controllers" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Controllers</h2>

    <h3><a id="user-content-controlleras在view中的语法" class="anchor" href="#controlleras在view中的语法" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>controllerAs在View中的语法</h3>

    <h6><a id="user-content-style-y030" class="anchor" href="#style-y030" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y030">Y030</a>]</h6>

    <ul>
        <li><p>使用<a href="http://www.johnpapa.net/do-you-like-your-angular-controllers-with-or-without-sugar/"><code>controllerAs</code></a> 语法代替直接用经典的$scope定义的controller的方式。</p>

            <p><em>为什么？</em>：controller被构建的时候，就会有一个新的实例，<code>controllerAs</code> 的语法比<code>经典的$scope语法</code>更接近JavaScript构造函数。</p>

            <p><em>为什么？</em>：这促进在View中对绑定到“有修饰”的对象的使用（例如用<code>customer.name</code> 代替<code>name</code>），这将更有语境、更容易阅读，也避免了任何没有“修饰”而产生的引用问题。</p>

            <p><em>为什么？</em>：有助于避免在有嵌套的controllers的Views中调用 <code>$parent</code>。</p>

            <div class="highlight highlight-text-html-basic"><pre><span class="pl-c">&lt;!-- avoid --&gt;</span>
&lt;<span class="pl-ent">div</span> <span class="pl-e">ng-controller</span>=<span class="pl-s"><span class="pl-pds">"</span>Customer<span class="pl-pds">"</span></span>&gt;
  {{ name }}
&lt;/<span class="pl-ent">div</span>&gt;</pre></div>

            <div class="highlight highlight-text-html-basic"><pre><span class="pl-c">&lt;!-- recommended --&gt;</span>
&lt;<span class="pl-ent">div</span> <span class="pl-e">ng-controller</span>=<span class="pl-s"><span class="pl-pds">"</span>Customer as customer<span class="pl-pds">"</span></span>&gt;
  {{ customer.name }}
&lt;/<span class="pl-ent">div</span>&gt;</pre></div></li>
    </ul>

    <h3><a id="user-content-controlleras在controller中的语法" class="anchor" href="#controlleras在controller中的语法" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>controllerAs在controller中的语法</h3>

    <h6><a id="user-content-style-y031" class="anchor" href="#style-y031" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y031">Y031</a>]</h6>

    <ul>
        <li><p>使用 <code>controllerAs</code> 语法代替 <code>经典的$scope语法</code> 语法。</p></li>
        <li><p>使用<code>controllerAs</code> 时，controller中的<code>$scope</code>被绑定到了<code>this</code>上。</p>

            <p><em>为什么？</em>：<code>controllerAs</code> 是<code>$scope</code>的语法修饰，你仍然可以绑定到View上并且访问 <code>$scope</code>的方法。</p>

            <p><em>为什么？</em>：避免在controller中使用 <code>$scope</code>，最好不用它们或是把它们移到一个factory中。factory中可以考虑使用<code>$scope</code>，controller中只在需要时候才使用<code>$scope</code>，例如当使用<a href="https://docs.angularjs.org/api/ng/type/$rootScope.Scope#$emit"><code>$emit</code></a>， <a href="https://docs.angularjs.org/api/ng/type/$rootScope.Scope#$broadcast"><code>$broadcast</code></a>，或者 <a href="https://docs.angularjs.org/api/ng/type/$rootScope.Scope#$on"><code>$on</code></a>。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
<span class="pl-k">function</span> <span class="pl-en">Customer</span> (<span class="pl-smi">$scope</span>) {
    <span class="pl-smi">$scope</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> {};
    <span class="pl-smi">$scope</span>.<span class="pl-en">sendMessage</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() { };
}</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended - but see next section */</span>
<span class="pl-k">function</span> <span class="pl-en">Customer</span> () {
    <span class="pl-v">this</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> {};
    <span class="pl-v">this</span>.<span class="pl-en">sendMessage</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() { };
}</pre></div></li>
    </ul>

    <h3><a id="user-content-controlleras-with-vm" class="anchor" href="#controlleras-with-vm" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>controllerAs with vm</h3>

    <h6><a id="user-content-style-y032" class="anchor" href="#style-y032" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y032">Y032</a>]</h6>

    <ul>
        <li><p>使用<code>controllerAs</code>语法时把<code>this</code> 赋值给一个可捕获的变量，选择一个有代表性的名称，例如<code>vm</code>代表ViewModel。</p>

            <p><em>为什么？</em>：<code>this</code>在不同的地方有不同的语义（就是作用域不同），在controller中的一个函数内部使用<code>this</code>时可能会改变它的上下文。用一个变量来捕获<code>this</code>的上下文从而可以避免遇到这样的坑。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
<span class="pl-k">function</span> <span class="pl-en">Customer</span>() {
    <span class="pl-v">this</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> {};
    <span class="pl-v">this</span>.<span class="pl-en">sendMessage</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() { };
}</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
<span class="pl-k">function</span> <span class="pl-en">Customer</span> () {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;
    <span class="pl-smi">vm</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> {};
    <span class="pl-smi">vm</span>.<span class="pl-en">sendMessage</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() { };
}</pre></div></li>
        <li><p>注：你可以参照下面的做法来避免 <a href="http://www.jshint.com/">jshint</a>的警告。但是构造函数（函数名首字母大写）是不需要这个的.</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* jshint validthis: true */</span>
<span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;</pre></div></li>
        <li><p>注：在controller中用<code>controller as</code>创建了一个watch时，可以用下面的语法监测<code>vm.*</code>的成员。（创建watch时要谨慎，因为它会增加更多的负载）</p>

            <div class="highlight highlight-text-html-basic"><pre>&lt;<span class="pl-ent">input</span> <span class="pl-e">ng-model</span>=<span class="pl-s"><span class="pl-pds">"</span>vm.title<span class="pl-pds">"</span></span>/&gt;</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">SomeController</span>(<span class="pl-smi">$scope</span>, <span class="pl-smi">$log</span>) {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;
    <span class="pl-smi">vm</span>.<span class="pl-c1">title</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Some Title<span class="pl-pds">'</span></span>;

    <span class="pl-smi">$scope</span>.<span class="pl-en">$watch</span>(<span class="pl-s"><span class="pl-pds">'</span>vm.title<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">current</span>, <span class="pl-smi">original</span>) {
        <span class="pl-smi">$log</span>.<span class="pl-en">info</span>(<span class="pl-s"><span class="pl-pds">'</span>vm.title was %s<span class="pl-pds">'</span></span>, original);
        <span class="pl-smi">$log</span>.<span class="pl-en">info</span>(<span class="pl-s"><span class="pl-pds">'</span>vm.title is now %s<span class="pl-pds">'</span></span>, current);
    });
}</pre></div></li>
    </ul>

    <h3><a id="user-content-置顶绑定成员" class="anchor" href="#置顶绑定成员" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>置顶绑定成员</h3>

    <h6><a id="user-content-style-y033" class="anchor" href="#style-y033" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y033">Y033</a>]</h6>

    <ul>
        <li><p>把可绑定的成员放到controller的顶部，按字母排序，并且不要通过controller的代码传播。</p>

            <p><em>为什么？</em>：虽然设置单行匿名函数很容易，但是当这些函数的代码超过一行时，这将极大降低代码的可读性。在可绑定成员下面定义函数（这些函数被提出来），把具体的实现细节放到下面，可绑定成员置顶，这会提高代码的可读性。 </p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
<span class="pl-k">function</span> <span class="pl-en">Sessions</span>() {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;

    <span class="pl-smi">vm</span>.<span class="pl-en">gotoSession</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
      <span class="pl-c">/* ... */</span>
    };
    <span class="pl-smi">vm</span>.<span class="pl-en">refresh</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
      <span class="pl-c">/* ... */</span>
    };
    <span class="pl-smi">vm</span>.<span class="pl-en">search</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
      <span class="pl-c">/* ... */</span>
    };
    <span class="pl-smi">vm</span>.<span class="pl-smi">sessions</span> <span class="pl-k">=</span> [];
    <span class="pl-smi">vm</span>.<span class="pl-c1">title</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Sessions<span class="pl-pds">'</span></span>;</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
<span class="pl-k">function</span> <span class="pl-en">Sessions</span>() {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;

    <span class="pl-smi">vm</span>.<span class="pl-smi">gotoSession</span> <span class="pl-k">=</span> gotoSession;
    <span class="pl-smi">vm</span>.<span class="pl-smi">refresh</span> <span class="pl-k">=</span> refresh;
    <span class="pl-smi">vm</span>.<span class="pl-smi">search</span> <span class="pl-k">=</span> search;
    <span class="pl-smi">vm</span>.<span class="pl-smi">sessions</span> <span class="pl-k">=</span> [];
    <span class="pl-smi">vm</span>.<span class="pl-c1">title</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Sessions<span class="pl-pds">'</span></span>;

    <span class="pl-c">////////////</span>

    <span class="pl-k">function</span> <span class="pl-en">gotoSession</span>() {
      <span class="pl-c">/* */</span>
    }

    <span class="pl-k">function</span> <span class="pl-en">refresh</span>() {
      <span class="pl-c">/* */</span>
    }

    <span class="pl-k">function</span> <span class="pl-en">search</span>() {
      <span class="pl-c">/* */</span>
    }</pre></div>

            <p>注：如果一个函数就是一行，那么只要不影响可读性就把它放到顶部。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
<span class="pl-k">function</span> <span class="pl-en">Sessions</span>(<span class="pl-smi">data</span>) {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;

    <span class="pl-smi">vm</span>.<span class="pl-smi">gotoSession</span> <span class="pl-k">=</span> gotoSession;
    <span class="pl-smi">vm</span>.<span class="pl-en">refresh</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
        <span class="pl-c">/**</span>
<span class="pl-c">         * lines</span>
<span class="pl-c">         * of</span>
<span class="pl-c">         * code</span>
<span class="pl-c">         * affects</span>
<span class="pl-c">         * readability</span>
<span class="pl-c">         */</span>
    };
    <span class="pl-smi">vm</span>.<span class="pl-smi">search</span> <span class="pl-k">=</span> search;
    <span class="pl-smi">vm</span>.<span class="pl-smi">sessions</span> <span class="pl-k">=</span> [];
    <span class="pl-smi">vm</span>.<span class="pl-c1">title</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Sessions<span class="pl-pds">'</span></span>;</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
<span class="pl-k">function</span> <span class="pl-en">Sessions</span>(<span class="pl-smi">dataservice</span>) {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;

    <span class="pl-smi">vm</span>.<span class="pl-smi">gotoSession</span> <span class="pl-k">=</span> gotoSession;
    <span class="pl-smi">vm</span>.<span class="pl-smi">refresh</span> <span class="pl-k">=</span> <span class="pl-smi">dataservice</span>.<span class="pl-smi">refresh</span>; <span class="pl-c">// 1 liner is OK</span>
    <span class="pl-smi">vm</span>.<span class="pl-smi">search</span> <span class="pl-k">=</span> search;
    <span class="pl-smi">vm</span>.<span class="pl-smi">sessions</span> <span class="pl-k">=</span> [];
    <span class="pl-smi">vm</span>.<span class="pl-c1">title</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Sessions<span class="pl-pds">'</span></span>;</pre></div></li>
    </ul>

    <h3><a id="user-content-函数声明隐藏实现细节" class="anchor" href="#函数声明隐藏实现细节" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>函数声明隐藏实现细节</h3>

    <h6><a id="user-content-style-y034" class="anchor" href="#style-y034" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y034">Y034</a>]</h6>

    <ul>
        <li><p>使用函数声明来隐藏实现细节，置顶绑定成员，当你需要在controller中绑定一个函数时，把它指向一个在文件的后面会出现函数声明。更多详情请看<a href="http://www.johnpapa.net/angular-function-declarations-function-expressions-and-readable-code">这里</a>。</p>

            <p><em>为什么？</em>：易读，易识别哪些成员可以在View中绑定和使用。</p>

            <p><em>为什么？</em>：把函数的实现细节放到后面，你可以更清楚地看到重要的东西。</p>

            <p><em>为什么？</em>：由于函数声明会被置顶，所以没有必要担心在声明它之前就使用函数的问题。</p>

            <p><em>为什么？</em>：你再也不用担心当 <code>a</code>依赖于 <code>b</code>时，把<code>var a</code>放到<code>var b</code>之前会中断你的代码的函数声明问题。</p>

            <p><em>为什么？</em>：函数表达式中顺序是至关重要的。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/**</span>
<span class="pl-c">* avoid</span>
<span class="pl-c">* Using function expressions.</span>
<span class="pl-c">*/</span>
<span class="pl-k">function</span> <span class="pl-en">Avengers</span>(<span class="pl-smi">dataservice</span>, <span class="pl-smi">logger</span>) {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;
    <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span> <span class="pl-k">=</span> [];
    <span class="pl-smi">vm</span>.<span class="pl-c1">title</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Avengers<span class="pl-pds">'</span></span>;

    <span class="pl-k">var</span> <span class="pl-en">activate</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
        <span class="pl-k">return</span> <span class="pl-en">getAvengers</span>().<span class="pl-en">then</span>(<span class="pl-k">function</span>() {
            <span class="pl-smi">logger</span>.<span class="pl-en">info</span>(<span class="pl-s"><span class="pl-pds">'</span>Activated Avengers View<span class="pl-pds">'</span></span>);
        });
    }

    <span class="pl-k">var</span> <span class="pl-en">getAvengers</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
        <span class="pl-k">return</span> <span class="pl-smi">dataservice</span>.<span class="pl-en">getAvengers</span>().<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">data</span>) {
            <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span> <span class="pl-k">=</span> data;
            <span class="pl-k">return</span> <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span>;
        });
    }

    <span class="pl-smi">vm</span>.<span class="pl-smi">getAvengers</span> <span class="pl-k">=</span> getAvengers;

    <span class="pl-en">activate</span>();
}</pre></div>

            <p>注意这里重要的代码分散在前面的例子中。
                下面的示例中，可以看到重要的代码都放到了顶部。实现的详细细节都在下方，显然这样的代码更易读。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/*</span>
<span class="pl-c">* recommend</span>
<span class="pl-c">* Using function declarations</span>
<span class="pl-c">* and bindable members up top.</span>
<span class="pl-c">*/</span>
<span class="pl-k">function</span> <span class="pl-en">Avengers</span>(<span class="pl-smi">dataservice</span>, <span class="pl-smi">logger</span>) {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;
    <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span> <span class="pl-k">=</span> [];
    <span class="pl-smi">vm</span>.<span class="pl-smi">getAvengers</span> <span class="pl-k">=</span> getAvengers;
    <span class="pl-smi">vm</span>.<span class="pl-c1">title</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Avengers<span class="pl-pds">'</span></span>;

    <span class="pl-en">activate</span>();

    <span class="pl-k">function</span> <span class="pl-en">activate</span>() {
        <span class="pl-k">return</span> <span class="pl-en">getAvengers</span>().<span class="pl-en">then</span>(<span class="pl-k">function</span>() {
            <span class="pl-smi">logger</span>.<span class="pl-en">info</span>(<span class="pl-s"><span class="pl-pds">'</span>Activated Avengers View<span class="pl-pds">'</span></span>);
        });
    }

    <span class="pl-k">function</span> <span class="pl-en">getAvengers</span>() {
        <span class="pl-k">return</span> <span class="pl-smi">dataservice</span>.<span class="pl-en">getAvengers</span>().<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">data</span>) {
            <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span> <span class="pl-k">=</span> data;
            <span class="pl-k">return</span> <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span>;
        });
    }
}</pre></div></li>
    </ul>

    <h3><a id="user-content-把controller中的逻辑延迟到service中" class="anchor" href="#把controller中的逻辑延迟到service中" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>把Controller中的逻辑延迟到Service中</h3>

    <h6><a id="user-content-style-y035" class="anchor" href="#style-y035" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y035">Y035</a>]</h6>

    <ul>
        <li><p>通过委派到service和factory中来延迟controller中的逻辑。</p>

            <p><em>为什么？</em>：把逻辑放到service中，并通过一个function暴露，就可以被多个controller重用。</p>

            <p><em>为什么？</em>：把逻辑放到service中将会使单元测试的时候更加容易地把它们分离，相反，如果在controller中调用逻辑就显得很二了。</p>

            <p><em>为什么？</em>：保持controller的简洁。</p>

            <p><em>为什么？</em>：从controller中删除依赖关系并且隐藏实现细节。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
<span class="pl-k">function</span> <span class="pl-en">Order</span>(<span class="pl-smi">$http</span>, <span class="pl-smi">$q</span>, <span class="pl-smi">config</span>, <span class="pl-smi">userInfo</span>) {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;
    <span class="pl-smi">vm</span>.<span class="pl-smi">checkCredit</span> <span class="pl-k">=</span> checkCredit;
    <span class="pl-smi">vm</span>.<span class="pl-smi">isCreditOk</span>;
    <span class="pl-smi">vm</span>.<span class="pl-smi">total</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>;

    <span class="pl-k">function</span> <span class="pl-en">checkCredit</span> () {
        <span class="pl-k">var</span> settings <span class="pl-k">=</span> {};
        <span class="pl-c">// Get the credit service base URL from config</span>
        <span class="pl-c">// Set credit service required headers</span>
        <span class="pl-c">// Prepare URL query string or data object with request data</span>
        <span class="pl-c">// Add user-identifying info so service gets the right credit limit for this user.</span>
        <span class="pl-c">// Use JSONP for this browser if it doesn't support CORS</span>
        <span class="pl-k">return</span> <span class="pl-smi">$http</span>.<span class="pl-en">get</span>(settings)
            .<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">data</span>) {
               <span class="pl-c">// Unpack JSON data in the response object</span>
               <span class="pl-c">// to find maxRemainingAmount</span>
               <span class="pl-smi">vm</span>.<span class="pl-smi">isCreditOk</span> <span class="pl-k">=</span> <span class="pl-smi">vm</span>.<span class="pl-smi">total</span> <span class="pl-k">&lt;=</span> maxRemainingAmount
            })
            .<span class="pl-en">catch</span>(<span class="pl-k">function</span>(<span class="pl-smi">error</span>) {
               <span class="pl-c">// Interpret error</span>
               <span class="pl-c">// Cope w/ timeout? retry? try alternate service?</span>
               <span class="pl-c">// Re-reject with appropriate error for a user to see</span>
            });
    };
}</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
<span class="pl-k">function</span> <span class="pl-en">Order</span> (<span class="pl-smi">creditService</span>) {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;
    <span class="pl-smi">vm</span>.<span class="pl-smi">checkCredit</span> <span class="pl-k">=</span> checkCredit;
    <span class="pl-smi">vm</span>.<span class="pl-smi">isCreditOk</span>;
    <span class="pl-smi">vm</span>.<span class="pl-smi">total</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>;

    <span class="pl-k">function</span> <span class="pl-en">checkCredit</span> () {
        <span class="pl-k">return</span> <span class="pl-smi">creditService</span>.<span class="pl-en">isOrderTotalOk</span>(<span class="pl-smi">vm</span>.<span class="pl-smi">total</span>)
          .<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">isOk</span>) { <span class="pl-smi">vm</span>.<span class="pl-smi">isCreditOk</span> <span class="pl-k">=</span> isOk; })
          .<span class="pl-en">catch</span>(showServiceError);
    };
}</pre></div></li>
    </ul>

    <h3><a id="user-content-保持controller的专一性" class="anchor" href="#保持controller的专一性" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>保持Controller的专一性</h3>

    <h6><a id="user-content-style-y037" class="anchor" href="#style-y037" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y037">Y037</a>]</h6>

    <ul>
        <li><p>一个view定义一个controller，尽量不要在其它view中使用这个controller。把可重用的逻辑放到factory中，保证controller只服务于当前视图。</p>

            <p><em>为什么？</em>：不同的view用同一个controller是非常不科学的，良好的端对端测试覆盖率对于保证大型应用稳定性是必需的。</p></li>
    </ul>

    <h3><a id="user-content-分配controller" class="anchor" href="#分配controller" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>分配Controller</h3>

    <h6><a id="user-content-style-y038" class="anchor" href="#style-y038" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y038">Y038</a>]</h6>

    <ul>
        <li><p>当一个controller必须匹配一个view时或者任何一个组件可能被其它controller或是view重用时，连同controller的route一起定义。</p>

            <p>注：如果一个view是通过route外的其它形式加载的，那么就用<code>ng-controller="Avengers as vm"</code>语法。</p>

            <p><em>为什么？</em>：在route中匹配controller允许不同的路由调用不同的相匹配的controller和view，当在view中通过<a href="https://docs.angularjs.org/api/ng/directive/ngController"><code>ng-controller</code></a>分配controller时，这个view总是和相同的controller相关联。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid - when using with a route and dynamic pairing is desired */</span>

<span class="pl-c">// route-config.js</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">config</span>(config);

<span class="pl-k">function</span> <span class="pl-en">config</span> (<span class="pl-smi">$routeProvider</span>) {
    $routeProvider
        .<span class="pl-en">when</span>(<span class="pl-s"><span class="pl-pds">'</span>/avengers<span class="pl-pds">'</span></span>, {
            templateUrl<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>avengers.html<span class="pl-pds">'</span></span>
        });
}</pre></div>

            <div class="highlight highlight-text-html-basic"><pre><span class="pl-c">&lt;!-- avengers.html --&gt;</span>
&lt;<span class="pl-ent">div</span> <span class="pl-e">ng-controller</span>=<span class="pl-s"><span class="pl-pds">"</span>Avengers as vm<span class="pl-pds">"</span></span>&gt;
&lt;/<span class="pl-ent">div</span>&gt;</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>

<span class="pl-c">// route-config.js</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">config</span>(config);

<span class="pl-k">function</span> <span class="pl-en">config</span> (<span class="pl-smi">$routeProvider</span>) {
    $routeProvider
        .<span class="pl-en">when</span>(<span class="pl-s"><span class="pl-pds">'</span>/avengers<span class="pl-pds">'</span></span>, {
            templateUrl<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>avengers.html<span class="pl-pds">'</span></span>,
            controller<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Avengers<span class="pl-pds">'</span></span>,
            controllerAs<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>vm<span class="pl-pds">'</span></span>
        });
}</pre></div>

            <div class="highlight highlight-text-html-basic"><pre><span class="pl-c">&lt;!-- avengers.html --&gt;</span>
&lt;<span class="pl-ent">div</span>&gt;
&lt;/<span class="pl-ent">div</span>&gt;</pre></div></li>
    </ul>

    <p><strong><a href="#%E7%9B%AE%E5%BD%95">返回顶部</a></strong></p>

    <h2><a id="user-content-services" class="anchor" href="#services" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Services</h2>

    <h3><a id="user-content-单例" class="anchor" href="#单例" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>单例</h3>

    <h6><a id="user-content-style-y040" class="anchor" href="#style-y040" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y040">Y040</a>]</h6>

    <ul>
        <li><p>用<code>new</code>实例化service，用<code>this</code>实例化公共方法和变量，由于这和factory是类似的，所以为了保持统一，推荐用facotry来代替。</p>

            <p>注意：<a href="https://docs.angularjs.org/guide/services">所有的Angular services都是单例</a>，这意味着每个injector都只有一个实例化的service。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">// service</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">service</span>(<span class="pl-s"><span class="pl-pds">'</span>logger<span class="pl-pds">'</span></span>, logger);

<span class="pl-k">function</span> <span class="pl-en">logger</span> () {
    <span class="pl-v">this</span>.<span class="pl-en">logError</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">msg</span>) {
      <span class="pl-c">/* */</span>
    };
}</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">// factory</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">factory</span>(<span class="pl-s"><span class="pl-pds">'</span>logger<span class="pl-pds">'</span></span>, logger);

<span class="pl-k">function</span> <span class="pl-en">logger</span> () {
    <span class="pl-k">return</span> {
        <span class="pl-en">logError</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">msg</span>) {
          <span class="pl-c">/* */</span>
        }
    };
}</pre></div></li>
    </ul>

    <p><strong><a href="#%E7%9B%AE%E5%BD%95">返回顶部</a></strong></p>

    <h2><a id="user-content-factories" class="anchor" href="#factories" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Factories</h2>

    <h3><a id="user-content-单一职责-1" class="anchor" href="#单一职责-1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>单一职责</h3>

    <h6><a id="user-content-style-y051" class="anchor" href="#style-y051" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y051">Y051</a>]</h6>

    <ul>
        <li>factory应该是<a href="http://en.wikipedia.org/wiki/Single_responsibility_principle">单一职责</a>，这是由其上下文进行封装的。一旦一个factory将要处理超过单一的目的时，就应该创建一个新的factory。</li>
    </ul>

    <h3><a id="user-content-单例-1" class="anchor" href="#单例-1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>单例</h3>

    <h6><a id="user-content-style-y051-1" class="anchor" href="#style-y051-1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y051">Y051</a>]</h6>

    <ul>
        <li><p>facotry是一个单例，它返回一个包含service成员的对象。</p>

            <p>注：<a href="https://docs.angularjs.org/guide/services">所有的Angular services都是单例</a>，这意味着每个injector都只有一个实例化的service。</p></li>
    </ul>

    <h3><a id="user-content-可访问的成员置顶" class="anchor" href="#可访问的成员置顶" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>可访问的成员置顶</h3>

    <h6><a id="user-content-style-y052" class="anchor" href="#style-y052" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y052">Y052</a>]</h6>

    <ul>
        <li><p>使用从<a href="http://addyosmani.com/resources/essentialjsdesignpatterns/book/#revealingmodulepatternjavascript">显露模块模式</a>派生出来的技术把service（它的接口）中可调用的成员暴露到顶部，</p>

            <p><em>为什么？</em>：易读，并且让你可以立即识别service中的哪些成员可以被调用，哪些成员必须进行单元测试（或者被别人嘲笑）。</p>

            <p><em>为什么？</em>：当文件内容很长时，这可以避免需要滚动才能看到暴露了哪些东西。</p>

            <p><em>为什么？</em>：虽然你可以随意写一个函数，但当函数代码超过一行时就会降低可读性并造成滚动。通过把实现细节放下面、把可调用接口置顶的形式返回service的方式来定义可调用的接口，从而使代码更加易读。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
<span class="pl-k">function</span> <span class="pl-en">dataService</span> () {
    <span class="pl-k">var</span> someValue <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>;
    <span class="pl-k">function</span> <span class="pl-en">save</span> () {
      <span class="pl-c">/* */</span>
    };
    <span class="pl-k">function</span> <span class="pl-en">validate</span> () {
      <span class="pl-c">/* */</span>
    };

    <span class="pl-k">return</span> {
        save<span class="pl-k">:</span> save,
        someValue<span class="pl-k">:</span> someValue,
        validate<span class="pl-k">:</span> validate
    };
}</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
<span class="pl-k">function</span> <span class="pl-en">dataService</span> () {
    <span class="pl-k">var</span> someValue <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>;
    <span class="pl-k">var</span> service <span class="pl-k">=</span> {
        save<span class="pl-k">:</span> save,
        someValue<span class="pl-k">:</span> someValue,
        validate<span class="pl-k">:</span> validate
    };
    <span class="pl-k">return</span> service;

    <span class="pl-c">////////////</span>

    <span class="pl-k">function</span> <span class="pl-en">save</span> () {
      <span class="pl-c">/* */</span>
    };

    <span class="pl-k">function</span> <span class="pl-en">validate</span> () {
      <span class="pl-c">/* */</span>
    };
}</pre></div>

            <p>这种绑定方式复制了宿主对象，原始值不会随着暴露模块模式的使用而更新。</p>

        </li>
    </ul>

    <h3><a id="user-content-函数声明隐藏实现细节-1" class="anchor" href="#函数声明隐藏实现细节-1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>函数声明隐藏实现细节</h3>

    <h6><a id="user-content-style-y053" class="anchor" href="#style-y053" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y053">Y053</a>]</h6>

    <ul>
        <li><p>函数声明隐藏实现细节，置顶绑定成员，当你需要在controller中绑定一个函数时，把它指向一个函数声明，这个函数声明在文件的后面会出现。</p>

            <p><em>为什么？</em>：易读，易识别哪些成员可以在View中绑定和使用。</p>

            <p><em>为什么？</em>：把函数的实现细节放到后面，你可以更清楚地看到重要的东西。</p>

            <p><em>为什么？</em>：由于函数声明会被置顶，所以没有必要担心在声明它之前就使用函数的问题。</p>

            <p><em>为什么？</em>：你再也不用担心当 <code>a</code>依赖于 <code>b</code>时，把<code>var a</code>放到<code>var b</code>之前会中断你的代码的函数声明问题。</p>

            <p><em>为什么？</em>：函数表达式中顺序是至关重要的。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/**</span>
<span class="pl-c">* avoid</span>
<span class="pl-c">* Using function expressions</span>
<span class="pl-c">*/</span>
<span class="pl-k">function</span> <span class="pl-en">dataservice</span>(<span class="pl-smi">$http</span>, <span class="pl-smi">$location</span>, <span class="pl-smi">$q</span>, <span class="pl-smi">exception</span>, <span class="pl-smi">logger</span>) {
  <span class="pl-k">var</span> isPrimed <span class="pl-k">=</span> <span class="pl-c1">false</span>;
  <span class="pl-k">var</span> primePromise;

  <span class="pl-k">var</span> <span class="pl-en">getAvengers</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
    <span class="pl-c">// implementation details go here</span>
  };

  <span class="pl-k">var</span> <span class="pl-en">getAvengerCount</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
    <span class="pl-c">// implementation details go here</span>
  };

  <span class="pl-k">var</span> <span class="pl-en">getAvengersCast</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
    <span class="pl-c">// implementation details go here</span>
  };

  <span class="pl-k">var</span> <span class="pl-en">prime</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
    <span class="pl-c">// implementation details go here</span>
  };

  <span class="pl-k">var</span> <span class="pl-en">ready</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">nextPromises</span>) {
    <span class="pl-c">// implementation details go here</span>
  };

  <span class="pl-k">var</span> service <span class="pl-k">=</span> {
      getAvengersCast<span class="pl-k">:</span> getAvengersCast,
      getAvengerCount<span class="pl-k">:</span> getAvengerCount,
      getAvengers<span class="pl-k">:</span> getAvengers,
      ready<span class="pl-k">:</span> ready
  };

  <span class="pl-k">return</span> service;
}</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/**</span>
<span class="pl-c">* recommended</span>
<span class="pl-c">* Using function declarations</span>
<span class="pl-c">* and accessible members up top.</span>
<span class="pl-c">*/</span>
<span class="pl-k">function</span> <span class="pl-en">dataservice</span>(<span class="pl-smi">$http</span>, <span class="pl-smi">$location</span>, <span class="pl-smi">$q</span>, <span class="pl-smi">exception</span>, <span class="pl-smi">logger</span>) {
    <span class="pl-k">var</span> isPrimed <span class="pl-k">=</span> <span class="pl-c1">false</span>;
    <span class="pl-k">var</span> primePromise;

    <span class="pl-k">var</span> service <span class="pl-k">=</span> {
        getAvengersCast<span class="pl-k">:</span> getAvengersCast,
        getAvengerCount<span class="pl-k">:</span> getAvengerCount,
        getAvengers<span class="pl-k">:</span> getAvengers,
        ready<span class="pl-k">:</span> ready
    };

    <span class="pl-k">return</span> service;

    <span class="pl-c">////////////</span>

    <span class="pl-k">function</span> <span class="pl-en">getAvengers</span>() {
      <span class="pl-c">// implementation details go here</span>
    }

    <span class="pl-k">function</span> <span class="pl-en">getAvengerCount</span>() {
      <span class="pl-c">// implementation details go here</span>
    }

    <span class="pl-k">function</span> <span class="pl-en">getAvengersCast</span>() {
      <span class="pl-c">// implementation details go here</span>
    }

    <span class="pl-k">function</span> <span class="pl-en">prime</span>() {
      <span class="pl-c">// implementation details go here</span>
    }

    <span class="pl-k">function</span> <span class="pl-en">ready</span>(<span class="pl-smi">nextPromises</span>) {
      <span class="pl-c">// implementation details go here</span>
    }
}</pre></div></li>
    </ul>

    <p><strong><a href="#%E7%9B%AE%E5%BD%95">返回顶部</a></strong></p>

    <h2><a id="user-content-data-services" class="anchor" href="#data-services" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Data Services</h2>

    <h3><a id="user-content-独立的数据调用" class="anchor" href="#独立的数据调用" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>独立的数据调用</h3>

    <h6><a id="user-content-style-y060" class="anchor" href="#style-y060" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y060">Y060</a>]</h6>

    <ul>
        <li><p>把进行数据操作和数据交互的逻辑放到factory中，数据服务负责XHR请求、本地存储、内存存储和其它任何数据操作。</p>

            <p><em>为什么？</em>：controller的作用是查看视图和收集视图的信息，它不应该关心如何取得数据，只需要知道哪里需要用到数据。把取数据的逻辑放到数据服务中能够让controller更简单、更专注于对view的控制。</p>

            <p><em>为什么？</em>：方便测试。</p>

            <p><em>为什么？</em>：数据服务的实现可能有非常明确的代码来处理数据仓库，这可能包含headers、如何与数据交互或是其它service，例如<code>$http</code>。把逻辑封装到单独的数据服务中，这隐藏了外部调用者（例如controller）对数据的直接操作，这样更加容易执行变更。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>

<span class="pl-c">// dataservice factory</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app.core<span class="pl-pds">'</span></span>)
    .<span class="pl-en">factory</span>(<span class="pl-s"><span class="pl-pds">'</span>dataservice<span class="pl-pds">'</span></span>, dataservice);

<span class="pl-smi">dataservice</span>.<span class="pl-smi">$inject</span> <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>$http<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>logger<span class="pl-pds">'</span></span>];

<span class="pl-k">function</span> <span class="pl-en">dataservice</span>(<span class="pl-smi">$http</span>, <span class="pl-smi">logger</span>) {
    <span class="pl-k">return</span> {
        getAvengers<span class="pl-k">:</span> getAvengers
    };

    <span class="pl-k">function</span> <span class="pl-en">getAvengers</span>() {
        <span class="pl-k">return</span> <span class="pl-smi">$http</span>.<span class="pl-en">get</span>(<span class="pl-s"><span class="pl-pds">'</span>/api/maa<span class="pl-pds">'</span></span>)
            .<span class="pl-en">then</span>(getAvengersComplete)
            .<span class="pl-en">catch</span>(getAvengersFailed);

        <span class="pl-k">function</span> <span class="pl-en">getAvengersComplete</span>(<span class="pl-smi">response</span>) {
            <span class="pl-k">return</span> <span class="pl-smi">response</span>.<span class="pl-c1">data</span>.<span class="pl-smi">results</span>;
        }

        <span class="pl-k">function</span> <span class="pl-en">getAvengersFailed</span>(<span class="pl-smi">error</span>) {
            <span class="pl-smi">logger</span>.<span class="pl-en">error</span>(<span class="pl-s"><span class="pl-pds">'</span>XHR Failed for getAvengers.<span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">error</span>.<span class="pl-c1">data</span>);
        }
    }
}</pre></div>

            <p>注意：数据服务被调用时（例如controller），隐藏调用的直接行为，如下所示。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>

<span class="pl-c">// controller calling the dataservice factory</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app.avengers<span class="pl-pds">'</span></span>)
    .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>Avengers<span class="pl-pds">'</span></span>, Avengers);

<span class="pl-smi">Avengers</span>.<span class="pl-smi">$inject</span> <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>dataservice<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>logger<span class="pl-pds">'</span></span>];

<span class="pl-k">function</span> <span class="pl-en">Avengers</span>(<span class="pl-smi">dataservice</span>, <span class="pl-smi">logger</span>) {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;
    <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span> <span class="pl-k">=</span> [];

    <span class="pl-en">activate</span>();

    <span class="pl-k">function</span> <span class="pl-en">activate</span>() {
        <span class="pl-k">return</span> <span class="pl-en">getAvengers</span>().<span class="pl-en">then</span>(<span class="pl-k">function</span>() {
            <span class="pl-smi">logger</span>.<span class="pl-en">info</span>(<span class="pl-s"><span class="pl-pds">'</span>Activated Avengers View<span class="pl-pds">'</span></span>);
        });
    }

    <span class="pl-k">function</span> <span class="pl-en">getAvengers</span>() {
        <span class="pl-k">return</span> <span class="pl-smi">dataservice</span>.<span class="pl-en">getAvengers</span>()
          .<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">data</span>) {
              <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span> <span class="pl-k">=</span> data;
              <span class="pl-k">return</span> <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span>;
          });
    }
}</pre></div></li>
    </ul>

    <h3><a id="user-content-数据调用返回一个promise" class="anchor" href="#数据调用返回一个promise" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>数据调用返回一个Promise</h3>

    <h6><a id="user-content-style-y061" class="anchor" href="#style-y061" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y061">Y061</a>]</h6>

    <ul>
        <li><p>就像<code>$http</code>一样，调用数据时返回一个promise，在你的调用函数中也返回一个promise。</p>

            <p><em>为什么？</em>：你可以把promise链接到一起，在数据调用完成并且resolve或是reject这个promise后采取进一步的行为。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>

<span class="pl-en">activate</span>();

<span class="pl-k">function</span> <span class="pl-en">activate</span>() {
    <span class="pl-c">/**</span>
<span class="pl-c">     * Step 1</span>
<span class="pl-c">     * Ask the getAvengers function for the</span>
<span class="pl-c">     * avenger data and wait for the promise</span>
<span class="pl-c">     */</span>
    <span class="pl-k">return</span> <span class="pl-en">getAvengers</span>().<span class="pl-en">then</span>(<span class="pl-k">function</span>() {
      <span class="pl-c">/**</span>
<span class="pl-c">       * Step 4</span>
<span class="pl-c">       * Perform an action on resolve of final promise</span>
<span class="pl-c">       */</span>
      <span class="pl-smi">logger</span>.<span class="pl-en">info</span>(<span class="pl-s"><span class="pl-pds">'</span>Activated Avengers View<span class="pl-pds">'</span></span>);
    });
}

<span class="pl-k">function</span> <span class="pl-en">getAvengers</span>() {
    <span class="pl-c">/**</span>
<span class="pl-c">     * Step 2</span>
<span class="pl-c">     * Ask the data service for the data and wait</span>
<span class="pl-c">     * for the promise</span>
<span class="pl-c">     */</span>
    <span class="pl-k">return</span> <span class="pl-smi">dataservice</span>.<span class="pl-en">getAvengers</span>()
      .<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">data</span>) {
          <span class="pl-c">/**</span>
<span class="pl-c">           * Step 3</span>
<span class="pl-c">           * set the data and resolve the promise</span>
<span class="pl-c">           */</span>
          <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span> <span class="pl-k">=</span> data;
          <span class="pl-k">return</span> <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span>;
      });
}</pre></div></li>
    </ul>

    <p><strong><a href="#%E7%9B%AE%E5%BD%95">返回顶部</a></strong></p>

    <h2><a id="user-content-directives" class="anchor" href="#directives" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Directives</h2>

    <h3><a id="user-content-一个directive一个文件" class="anchor" href="#一个directive一个文件" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>一个directive一个文件</h3>

    <h6><a id="user-content-style-y070" class="anchor" href="#style-y070" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y070">Y070</a>]</h6>

    <ul>
        <li><p>一个文件中只创建一个directive，并依照directive来命名文件。</p>

            <p><em>为什么？</em>：虽然把所有directive放到一个文件中很简单，但是当一些directive是跨应用的，一些是跨模块的，一些仅仅在一个模块中使用时，想把它们独立出来就非常困难了。</p>

            <p><em>为什么？</em>：一个文件一个directive也更加容易维护。</p>

            <blockquote>
                <p>注： "<strong>最佳实践</strong>：Angular文档中有提过，directive应该自动回收，当directive被移除后，你可以使用<code>element.on('$destroy', ...)</code>或者<code>scope.$on('$destroy', ...)</code>来执行一个clearn-up函数。"</p>
            </blockquote>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
<span class="pl-c">/* directives.js */</span>

angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app.widgets<span class="pl-pds">'</span></span>)

    <span class="pl-c">/* order directive仅仅会被order module用到 */</span>
    .<span class="pl-en">directive</span>(<span class="pl-s"><span class="pl-pds">'</span>orderCalendarRange<span class="pl-pds">'</span></span>, orderCalendarRange)

    <span class="pl-c">/* sales directive可以在sales app的任意地方使用 */</span>
    .<span class="pl-en">directive</span>(<span class="pl-s"><span class="pl-pds">'</span>salesCustomerInfo<span class="pl-pds">'</span></span>, salesCustomerInfo)

    <span class="pl-c">/* spinner directive可以在任意apps中使用 */</span>
    .<span class="pl-en">directive</span>(<span class="pl-s"><span class="pl-pds">'</span>sharedSpinner<span class="pl-pds">'</span></span>, sharedSpinner);

<span class="pl-k">function</span> <span class="pl-en">orderCalendarRange</span>() {
    <span class="pl-c">/* implementation details */</span>
}

<span class="pl-k">function</span> <span class="pl-en">salesCustomerInfo</span>() {
    <span class="pl-c">/* implementation details */</span>
}

<span class="pl-k">function</span> <span class="pl-en">sharedSpinner</span>() {
    <span class="pl-c">/* implementation details */</span>
}</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
<span class="pl-c">/* calendarRange.directive.js */</span>

<span class="pl-c">/**</span>
<span class="pl-c">* <span class="pl-k">@desc</span> order directive that is specific to the order module at a company named Acme</span>
<span class="pl-c">* <span class="pl-k">@example</span> &lt;div acme-order-calendar-range&gt;&lt;/div&gt;</span>
<span class="pl-c">*/</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>sales.order<span class="pl-pds">'</span></span>)
    .<span class="pl-en">directive</span>(<span class="pl-s"><span class="pl-pds">'</span>acmeOrderCalendarRange<span class="pl-pds">'</span></span>, orderCalendarRange);

<span class="pl-k">function</span> <span class="pl-en">orderCalendarRange</span>() {
    <span class="pl-c">/* implementation details */</span>
}</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
<span class="pl-c">/* customerInfo.directive.js */</span>

<span class="pl-c">/**</span>
<span class="pl-c">* <span class="pl-k">@desc</span> sales directive that can be used anywhere across the sales app at a company named Acme</span>
<span class="pl-c">* <span class="pl-k">@example</span> &lt;div acme-sales-customer-info&gt;&lt;/div&gt;</span>
<span class="pl-c">*/</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>sales.widgets<span class="pl-pds">'</span></span>)
    .<span class="pl-en">directive</span>(<span class="pl-s"><span class="pl-pds">'</span>acmeSalesCustomerInfo<span class="pl-pds">'</span></span>, salesCustomerInfo);

<span class="pl-k">function</span> <span class="pl-en">salesCustomerInfo</span>() {
    <span class="pl-c">/* implementation details */</span>
}</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
<span class="pl-c">/* spinner.directive.js */</span>

<span class="pl-c">/**</span>
<span class="pl-c">* <span class="pl-k">@desc</span> spinner directive that can be used anywhere across apps at a company named Acme</span>
<span class="pl-c">* <span class="pl-k">@example</span> &lt;div acme-shared-spinner&gt;&lt;/div&gt;</span>
<span class="pl-c">*/</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>shared.widgets<span class="pl-pds">'</span></span>)
    .<span class="pl-en">directive</span>(<span class="pl-s"><span class="pl-pds">'</span>acmeSharedSpinner<span class="pl-pds">'</span></span>, sharedSpinner);

<span class="pl-k">function</span> <span class="pl-en">sharedSpinner</span>() {
    <span class="pl-c">/* implementation details */</span>
}</pre></div>

            <p>注：由于directive使用条件比较广，所以命名就存在很多的选项。选择一个让directive和它的文件名都清楚分明的名字。下面有一些例子，不过更多的建议去看<a href="#%E5%91%BD%E5%90%8D">命名</a>章节。</p></li>
    </ul>

    <h3><a id="user-content-在directive中操作dom" class="anchor" href="#在directive中操作dom" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>在directive中操作DOM</h3>

    <h6><a id="user-content-style-y072" class="anchor" href="#style-y072" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y072">Y072</a>]</h6>

    <ul>
        <li><p>当需要直接操作DOM的时候，使用directive。如果有替代方法可以使用，例如：使用CSS来设置样式、<a href="https://docs.angularjs.org/api/ngAnimate">animation services</a>、Angular模板、<a href="https://docs.angularjs.org/api/ng/directive/ngShow"><code>ngShow</code></a>或者<a href="https://docs.angularjs.org/api/ng/directive/ngHide"><code>ngHide</code></a>，那么就直接用这些即可。例如，如果一个directive只是想控制显示和隐藏，用ngHide/ngShow即可。</p>

            <p><em>为什么？</em>：DOM操作的测试和调试是很困难的，通常会有更好的方法（CSS、animations、templates）。</p></li>
    </ul>

    <h3><a id="user-content-提供一个唯一的directive前缀" class="anchor" href="#提供一个唯一的directive前缀" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>提供一个唯一的Directive前缀</h3>

    <h6><a id="user-content-style-y073" class="anchor" href="#style-y073" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y073">Y073</a>]</h6>

    <ul>
        <li><p>提供一个短小、唯一、具有描述性的directive前缀，例如<code>acmeSalesCustomerInfo</code>在HTML中声明为<code>acme-sales-customer-info</code>。</p>

            <p><em>为什么？</em>：方便快速识别directive的内容和起源，例如<code>acme-</code>可能预示着这个directive是服务于Acme company。</p>

            <p>注：避免使用<code>ng-</code>为前缀，研究一下其它广泛使用的directive避免命名冲突，例如<a href="http://ionicframework.com/">Ionic Framework</a>的<code>ion-</code>。</p></li>
    </ul>

    <h3><a id="user-content-限制元素和属性" class="anchor" href="#限制元素和属性" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>限制元素和属性</h3>

    <h6><a id="user-content-style-y074" class="anchor" href="#style-y074" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y074">Y074</a>]</h6>

    <ul>
        <li><p>当创建一个directive需要作为一个独立元素时，restrict值设置为<code>E</code>（自定义元素），也可以设置可选值<code>A</code>（自定义属性）。一般来说，如果它就是为了独立存在，用<code>E</code>是合适的做法。一般原则是允许<code>EA</code>，但是当它是独立的时候这更倾向于作为一个元素来实施，当它是为了增强已存在的DOM元素时则更倾向于作为一个属性来实施。</p>

            <p><em>为什么？</em>：这很有意义！</p>

            <p><em>为什么？</em>：虽然我们允许directive被当作一个class来使用，但如果这个directive的行为确实像一个元素的话，那么把directive当作元素或者属性是更有意义的。</p>

            <p>注：Angular 1.3 +默认使用EA。</p>

            <div class="highlight highlight-text-html-basic"><pre><span class="pl-c">&lt;!-- avoid --&gt;</span>
&lt;<span class="pl-ent">div</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">"</span>my-calendar-range<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">div</span>&gt;</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app.widgets<span class="pl-pds">'</span></span>)
    .<span class="pl-en">directive</span>(<span class="pl-s"><span class="pl-pds">'</span>myCalendarRange<span class="pl-pds">'</span></span>, myCalendarRange);

<span class="pl-k">function</span> <span class="pl-en">myCalendarRange</span> () {
    <span class="pl-k">var</span> directive <span class="pl-k">=</span> {
        link<span class="pl-k">:</span> link,
        templateUrl<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>/template/is/located/here.html<span class="pl-pds">'</span></span>,
        restrict<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>C<span class="pl-pds">'</span></span>
    };
    <span class="pl-k">return</span> directive;

    <span class="pl-k">function</span> <span class="pl-en">link</span>(<span class="pl-smi">scope</span>, <span class="pl-smi">element</span>, <span class="pl-smi">attrs</span>) {
      <span class="pl-c">/* */</span>
    }
}</pre></div>

            <div class="highlight highlight-text-html-basic"><pre><span class="pl-c">&lt;!-- recommended --&gt;</span>
&lt;<span class="pl-ent">my</span><span class="pl-e">-calendar-range</span>&gt;&lt;/<span class="pl-ent">my</span><span class="pl-e">-calendar-range</span>&gt;
&lt;<span class="pl-ent">div</span> <span class="pl-e">my-calendar-range</span>&gt;&lt;/<span class="pl-ent">div</span>&gt;</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app.widgets<span class="pl-pds">'</span></span>)
    .<span class="pl-en">directive</span>(<span class="pl-s"><span class="pl-pds">'</span>myCalendarRange<span class="pl-pds">'</span></span>, myCalendarRange);

<span class="pl-k">function</span> <span class="pl-en">myCalendarRange</span> () {
    <span class="pl-k">var</span> directive <span class="pl-k">=</span> {
        link<span class="pl-k">:</span> link,
        templateUrl<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>/template/is/located/here.html<span class="pl-pds">'</span></span>,
        restrict<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>EA<span class="pl-pds">'</span></span>
    };
    <span class="pl-k">return</span> directive;

    <span class="pl-k">function</span> <span class="pl-en">link</span>(<span class="pl-smi">scope</span>, <span class="pl-smi">element</span>, <span class="pl-smi">attrs</span>) {
      <span class="pl-c">/* */</span>
    }
}</pre></div></li>
    </ul>

    <h3><a id="user-content-directives和controlleras" class="anchor" href="#directives和controlleras" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Directives和ControllerAs</h3>

    <h6><a id="user-content-style-y075" class="anchor" href="#style-y075" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y075">Y075</a>]</h6>

    <ul>
        <li><p>directive使用<code>controller as</code>语法，和view使用<code>controller as</code>保持一致。</p>

            <p><em>为什么？</em>：因为不难且有必要这样做。</p>

            <p>注意：下面的directive演示了一些你可以在link和directive控制器中使用scope的方法，用controllerAs。这里把template放在行内是为了在一个地方写出这些代码。</p>

            <p>注意：关于依赖注入的内容，请看<a href="#%E6%89%8B%E5%8A%A8%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5">手动依赖注入</a>。</p>

            <p>注意：directive的控制器是在directive外部的，这种风格避免了由于注入造成的<code>return</code>之后的代码无法访问的情况。</p>

            <div class="highlight highlight-text-html-basic"><pre>&lt;<span class="pl-ent">div</span> <span class="pl-e">my-example</span> <span class="pl-e">max</span>=<span class="pl-s"><span class="pl-pds">"</span>77<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">div</span>&gt;</pre></div>

            <div class="highlight highlight-source-js"><pre>angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">directive</span>(<span class="pl-s"><span class="pl-pds">'</span>myExample<span class="pl-pds">'</span></span>, myExample);

<span class="pl-k">function</span> <span class="pl-en">myExample</span>() {
    <span class="pl-k">var</span> directive <span class="pl-k">=</span> {
        restrict<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>EA<span class="pl-pds">'</span></span>,
        templateUrl<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>app/feature/example.directive.html<span class="pl-pds">'</span></span>,
        scope<span class="pl-k">:</span> {
            max<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>
        },
        link<span class="pl-k">:</span> linkFunc,
        controller <span class="pl-k">:</span> ExampleController,
        controllerAs<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>vm<span class="pl-pds">'</span></span>,
        bindToController<span class="pl-k">:</span> <span class="pl-c1">true</span> <span class="pl-c">// because the scope is isolated</span>
    };

    <span class="pl-k">return</span> directive;

    <span class="pl-k">function</span> <span class="pl-en">linkFunc</span>(<span class="pl-smi">scope</span>, <span class="pl-smi">el</span>, <span class="pl-smi">attr</span>, <span class="pl-smi">ctrl</span>) {
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>LINK: scope.min = %s *** should be undefined<span class="pl-pds">'</span></span>, <span class="pl-smi">scope</span>.<span class="pl-smi">min</span>);
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>LINK: scope.max = %s *** should be undefined<span class="pl-pds">'</span></span>, <span class="pl-smi">scope</span>.<span class="pl-smi">max</span>);
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>LINK: scope.vm.min = %s<span class="pl-pds">'</span></span>, <span class="pl-smi">scope</span>.<span class="pl-smi">vm</span>.<span class="pl-smi">min</span>);
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>LINK: scope.vm.max = %s<span class="pl-pds">'</span></span>, <span class="pl-smi">scope</span>.<span class="pl-smi">vm</span>.<span class="pl-smi">max</span>);
    }
}

<span class="pl-smi">ExampleController</span>.<span class="pl-smi">$inject</span> <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>$scope<span class="pl-pds">'</span></span>];

<span class="pl-k">function</span> <span class="pl-en">ExampleController</span>(<span class="pl-smi">$scope</span>) {
    <span class="pl-c">// Injecting $scope just for comparison</span>
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;

    <span class="pl-smi">vm</span>.<span class="pl-smi">min</span> <span class="pl-k">=</span> <span class="pl-c1">3</span>;

    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>CTRL: $scope.vm.min = %s<span class="pl-pds">'</span></span>, <span class="pl-smi">$scope</span>.<span class="pl-smi">vm</span>.<span class="pl-smi">min</span>);
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>CTRL: $scope.vm.max = %s<span class="pl-pds">'</span></span>, <span class="pl-smi">$scope</span>.<span class="pl-smi">vm</span>.<span class="pl-smi">max</span>);
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>CTRL: vm.min = %s<span class="pl-pds">'</span></span>, <span class="pl-smi">vm</span>.<span class="pl-smi">min</span>);
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>CTRL: vm.max = %s<span class="pl-pds">'</span></span>, <span class="pl-smi">vm</span>.<span class="pl-smi">max</span>);
}</pre></div>

            <div class="highlight highlight-text-html-basic"><pre><span class="pl-c">&lt;!-- example.directive.html --&gt;</span>
&lt;<span class="pl-ent">div</span>&gt;hello world&lt;/<span class="pl-ent">div</span>&gt;
&lt;<span class="pl-ent">div</span>&gt;max={{vm.max}}&lt;<span class="pl-ent">input</span> <span class="pl-e">ng-model</span>=<span class="pl-s"><span class="pl-pds">"</span>{{vm.max}}<span class="pl-pds">"</span></span>/&gt;&lt;/<span class="pl-ent">div</span>&gt;
&lt;<span class="pl-ent">div</span>&gt;min={{vm.min}}&lt;<span class="pl-ent">input</span> <span class="pl-e">ng-model</span>=<span class="pl-s"><span class="pl-pds">"</span>{{vm.min}}<span class="pl-pds">"</span></span>/&gt;&lt;/<span class="pl-ent">div</span>&gt;</pre></div>

            <p>注意：当你把controller注入到link的函数或可访问的directive的attributes时，你可以把它命名为控制器的属性。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">// Alternative to above example</span>
<span class="pl-k">function</span> <span class="pl-en">linkFunc</span>(<span class="pl-smi">scope</span>, <span class="pl-smi">el</span>, <span class="pl-smi">attr</span>, <span class="pl-smi">vm</span>) { <span class="pl-c">// 和上面例子的区别在于把vm直接传递进来</span>
  <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>LINK: scope.min = %s *** should be undefined<span class="pl-pds">'</span></span>, <span class="pl-smi">scope</span>.<span class="pl-smi">min</span>);
  <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>LINK: scope.max = %s *** should be undefined<span class="pl-pds">'</span></span>, <span class="pl-smi">scope</span>.<span class="pl-smi">max</span>);
  <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>LINK: vm.min = %s<span class="pl-pds">'</span></span>, <span class="pl-smi">vm</span>.<span class="pl-smi">min</span>);
  <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>LINK: vm.max = %s<span class="pl-pds">'</span></span>, <span class="pl-smi">vm</span>.<span class="pl-smi">max</span>);
}</pre></div></li>
    </ul>

    <h6><a id="user-content-style-y076" class="anchor" href="#style-y076" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y076">Y076</a>]</h6>

    <ul>
        <li><p>当directive中使用了<code>controller as</code>语法时，如果你想把父级作用域绑定到directive的controller作用域时，使用<code>bindToController = true</code>。</p>

            <p><em>为什么？</em>：这使得把外部作用域绑定到directive controller中变得更加简单。</p>

            <p>注意：Angular 1.3.0才介绍了<code>bindToController</code>。</p>

            <div class="highlight highlight-text-html-basic"><pre>&lt;<span class="pl-ent">div</span> <span class="pl-e">my-example</span> <span class="pl-e">max</span>=<span class="pl-s"><span class="pl-pds">"</span>77<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">div</span>&gt;</pre></div>

            <div class="highlight highlight-source-js"><pre>angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">directive</span>(<span class="pl-s"><span class="pl-pds">'</span>myExample<span class="pl-pds">'</span></span>, myExample);

<span class="pl-k">function</span> <span class="pl-en">myExample</span>() {
    <span class="pl-k">var</span> directive <span class="pl-k">=</span> {
        restrict<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>EA<span class="pl-pds">'</span></span>,
        templateUrl<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>app/feature/example.directive.html<span class="pl-pds">'</span></span>,
        scope<span class="pl-k">:</span> {
            max<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>
        },
        controller<span class="pl-k">:</span> ExampleController,
        controllerAs<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>vm<span class="pl-pds">'</span></span>,
        bindToController<span class="pl-k">:</span> <span class="pl-c1">true</span>
      };

    <span class="pl-k">return</span> directive;
}

<span class="pl-k">function</span> <span class="pl-en">ExampleController</span>() {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;
    <span class="pl-smi">vm</span>.<span class="pl-smi">min</span> <span class="pl-k">=</span> <span class="pl-c1">3</span>;
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>CTRL: vm.min = %s<span class="pl-pds">'</span></span>, <span class="pl-smi">vm</span>.<span class="pl-smi">min</span>);
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>CTRL: vm.max = %s<span class="pl-pds">'</span></span>, <span class="pl-smi">vm</span>.<span class="pl-smi">max</span>);
}</pre></div>

            <div class="highlight highlight-text-html-basic"><pre><span class="pl-c">&lt;!-- example.directive.html --&gt;</span>
&lt;<span class="pl-ent">div</span>&gt;hello world&lt;/<span class="pl-ent">div</span>&gt;
&lt;<span class="pl-ent">div</span>&gt;max={{vm.max}}&lt;<span class="pl-ent">input</span> <span class="pl-e">ng-model</span>=<span class="pl-s"><span class="pl-pds">"</span>vm.max<span class="pl-pds">"</span></span>/&gt;&lt;/<span class="pl-ent">div</span>&gt;
&lt;<span class="pl-ent">div</span>&gt;min={{vm.min}}&lt;<span class="pl-ent">input</span> <span class="pl-e">ng-model</span>=<span class="pl-s"><span class="pl-pds">"</span>vm.min<span class="pl-pds">"</span></span>/&gt;&lt;/<span class="pl-ent">div</span>&gt;</pre></div></li>
    </ul>

    <p><strong><a href="#%E7%9B%AE%E5%BD%95">返回顶部</a></strong></p>

    <h2><a id="user-content-解决controller的promises" class="anchor" href="#解决controller的promises" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>解决Controller的Promises</h2>

    <h3><a id="user-content-controller-activation-promises" class="anchor" href="#controller-activation-promises" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Controller Activation Promises</h3>

    <h6><a id="user-content-style-y080" class="anchor" href="#style-y080" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y080">Y080</a>]</h6>

    <ul>
        <li><p>在<code>activate</code>函数中解决controller的启动逻辑。</p>

            <p><em>为什么？</em>：把启动逻辑放在一个controller中固定的位置可以方便定位、有利于保持测试的一致性，并能够避免controller中到处都是激活逻辑。</p>

            <p><em>为什么？</em>：<code>activate</code>这个controller使得重用刷新视图的逻辑变得很方便，把所有的逻辑都放到了一起，可以让用户更快地看到视图，可以很轻松地对<code>ng-view</code> 或 <code>ui-view</code>使用动画，用户体验更好。</p>

            <p>注意：如果你需要在开始使用controller之前有条件地取消路由，那么就用<a href="#style-y081">route resolve</a>来代替。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
<span class="pl-k">function</span> <span class="pl-en">Avengers</span>(<span class="pl-smi">dataservice</span>) {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;
    <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span> <span class="pl-k">=</span> [];
    <span class="pl-smi">vm</span>.<span class="pl-c1">title</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Avengers<span class="pl-pds">'</span></span>;

    <span class="pl-smi">dataservice</span>.<span class="pl-en">getAvengers</span>().<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">data</span>) {
        <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span> <span class="pl-k">=</span> data;
        <span class="pl-k">return</span> <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span>;
    });
}</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
<span class="pl-k">function</span> <span class="pl-en">Avengers</span>(<span class="pl-smi">dataservice</span>) {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;
    <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span> <span class="pl-k">=</span> [];
    <span class="pl-smi">vm</span>.<span class="pl-c1">title</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Avengers<span class="pl-pds">'</span></span>;

    <span class="pl-en">activate</span>();

    <span class="pl-c">////////////</span>

    <span class="pl-k">function</span> <span class="pl-en">activate</span>() {
        <span class="pl-k">return</span> <span class="pl-smi">dataservice</span>.<span class="pl-en">getAvengers</span>().<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">data</span>) {
            <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span> <span class="pl-k">=</span> data;
            <span class="pl-k">return</span> <span class="pl-smi">vm</span>.<span class="pl-smi">avengers</span>;
        });
    }
}</pre></div></li>
    </ul>

    <h3><a id="user-content-route-resolve-promises" class="anchor" href="#route-resolve-promises" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Route Resolve Promises</h3>

    <h6><a id="user-content-style-y081" class="anchor" href="#style-y081" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y081">Y081</a>]</h6>

    <ul>
        <li><p>当一个controller在激活之前，需要依赖一个promise的完成时，那么就在controller的逻辑执行之前在<code>$routeProvider</code>中解决这些依赖。如果你需要在controller被激活之前有条件地取消一个路由，那么就用route resolver。</p></li>
        <li><p>当你决定在过渡到视图之前取消路由时，使用route resolve。</p>

            <p><em>为什么？</em>：controller在加载前可能需要一些数据，这些数据可能是从一个通过自定义factory或是<a href="https://docs.angularjs.org/api/ng/service/$http">$http</a>的promise而来的。<a href="https://docs.angularjs.org/api/ngRoute/provider/$routeProvider">route resolve</a>允许promise在controller的逻辑执行之前解决，因此它可能对从promise中来的数据做一些处理。</p>

            <p><em>为什么？</em>：这段代码将在路由后的controller的激活函数中执行，视图立即加载，promise resolve的时候将会开始进行数据绑定，可以（通过<code>ng-view</code>或<code>ui-view</code>）在视图的过渡之间加个loading状态的动画。</p>

            <p>注意：这段代码将在路由之前通过一个promise来执行，拒绝了承诺就会取消路由，接受了就会等待路由跳转到新视图。如果你想更快地进入视图，并且无需验证是否可以进入视图，你可以考虑用<a href="#style-y080">控制器 <code>activate</code> 技术</a>。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>Avengers<span class="pl-pds">'</span></span>, Avengers);

<span class="pl-k">function</span> <span class="pl-en">Avengers</span> (<span class="pl-smi">movieService</span>) {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;
    <span class="pl-c">// unresolved</span>
    <span class="pl-smi">vm</span>.<span class="pl-smi">movies</span>;
    <span class="pl-c">// resolved asynchronously</span>
    <span class="pl-smi">movieService</span>.<span class="pl-en">getMovies</span>().<span class="pl-en">then</span>(<span class="pl-k">function</span>(<span class="pl-smi">response</span>) {
        <span class="pl-smi">vm</span>.<span class="pl-smi">movies</span> <span class="pl-k">=</span> <span class="pl-smi">response</span>.<span class="pl-smi">movies</span>;
    });
}</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* better */</span>

<span class="pl-c">// route-config.js</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">config</span>(config);

<span class="pl-k">function</span> <span class="pl-en">config</span> (<span class="pl-smi">$routeProvider</span>) {
    $routeProvider
        .<span class="pl-en">when</span>(<span class="pl-s"><span class="pl-pds">'</span>/avengers<span class="pl-pds">'</span></span>, {
            templateUrl<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>avengers.html<span class="pl-pds">'</span></span>,
            controller<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Avengers<span class="pl-pds">'</span></span>,
            controllerAs<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>vm<span class="pl-pds">'</span></span>,
            resolve<span class="pl-k">:</span> {
                <span class="pl-en">moviesPrepService</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">movieService</span>) {
                    <span class="pl-k">return</span> <span class="pl-smi">movieService</span>.<span class="pl-en">getMovies</span>();
                }
            }
        });
}

<span class="pl-c">// avengers.js</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>Avengers<span class="pl-pds">'</span></span>, Avengers);

<span class="pl-smi">Avengers</span>.<span class="pl-smi">$inject</span> <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>moviesPrepService<span class="pl-pds">'</span></span>];
<span class="pl-k">function</span> <span class="pl-en">Avengers</span> (<span class="pl-smi">moviesPrepService</span>) {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;
    <span class="pl-smi">vm</span>.<span class="pl-smi">movies</span> <span class="pl-k">=</span> <span class="pl-smi">moviesPrepService</span>.<span class="pl-smi">movies</span>;
}</pre></div>

            <p>注意：下面这个例子展示了命名函数的路由解决，这种方式对于调试和处理依赖注入更加方便。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* even better */</span>

<span class="pl-c">// route-config.js</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">config</span>(config);

<span class="pl-k">function</span> <span class="pl-en">config</span>(<span class="pl-smi">$routeProvider</span>) {
    $routeProvider
        .<span class="pl-en">when</span>(<span class="pl-s"><span class="pl-pds">'</span>/avengers<span class="pl-pds">'</span></span>, {
            templateUrl<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>avengers.html<span class="pl-pds">'</span></span>,
            controller<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Avengers<span class="pl-pds">'</span></span>,
            controllerAs<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>vm<span class="pl-pds">'</span></span>,
            resolve<span class="pl-k">:</span> {
                moviesPrepService<span class="pl-k">:</span> moviesPrepService
            }
        });
}

<span class="pl-k">function</span> <span class="pl-en">moviesPrepService</span>(<span class="pl-smi">movieService</span>) {
    <span class="pl-k">return</span> <span class="pl-smi">movieService</span>.<span class="pl-en">getMovies</span>();
}

<span class="pl-c">// avengers.js</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>Avengers<span class="pl-pds">'</span></span>, Avengers);

<span class="pl-smi">Avengers</span>.<span class="pl-smi">$inject</span> <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>moviesPrepService<span class="pl-pds">'</span></span>];
<span class="pl-k">function</span> <span class="pl-en">Avengers</span>(<span class="pl-smi">moviesPrepService</span>) {
      <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;
      <span class="pl-smi">vm</span>.<span class="pl-smi">movies</span> <span class="pl-k">=</span> <span class="pl-smi">moviesPrepService</span>.<span class="pl-smi">movies</span>;
}</pre></div>

            <p>注意：示例代码中的<code>movieService</code>不符合安全压缩的做法，可以到<a href="#%E6%89%8B%E5%8A%A8%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5">手动依赖注入</a>和<a href="#%E5%8E%8B%E7%BC%A9%E5%92%8C%E6%B3%A8%E9%87%8A">压缩和注释</a>部分学习如何安全压缩。</p></li>
    </ul>

    <p><strong><a href="#%E7%9B%AE%E5%BD%95">返回顶部</a></strong></p>

    <h2><a id="user-content-手动依赖注入" class="anchor" href="#手动依赖注入" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>手动依赖注入</h2>

    <h3><a id="user-content-压缩的不安全性" class="anchor" href="#压缩的不安全性" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>压缩的不安全性</h3>

    <h6><a id="user-content-style-y090" class="anchor" href="#style-y090" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y090">Y090</a>]</h6>

    <ul>
        <li><p>声明依赖时避免使用缩写语法。</p>

            <p><em>为什么？</em>：组件的参数（例如controller、factory等等）将会被转换成各种乱七八糟错误的变量。例如，<code>common</code>和<code>dataservice</code>可能会变成<code>a</code>或者<code>b</code>，但是这些转换后的变量在Angular中是找不到的。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid - not minification-safe*/</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>Dashboard<span class="pl-pds">'</span></span>, Dashboard);

<span class="pl-k">function</span> <span class="pl-en">Dashboard</span>(<span class="pl-smi">common</span>, <span class="pl-smi">dataservice</span>) {
}</pre></div>

            <p>这一段代码在压缩时会产生错误的变量，因此在运行时就会报错。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid - not minification-safe*/</span>
<span class="pl-smi">angular</span>.<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>).<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>Dashboard<span class="pl-pds">'</span></span>, d);<span class="pl-k">function</span> <span class="pl-en">d</span>(<span class="pl-smi">a</span>, <span class="pl-smi">b</span>) { }</pre></div></li>
    </ul>

    <h3><a id="user-content-手动添加依赖" class="anchor" href="#手动添加依赖" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>手动添加依赖</h3>

    <h6><a id="user-content-style-y091" class="anchor" href="#style-y091" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y091">Y091</a>]</h6>

    <ul>
        <li><p>用<code>$inject</code>手动添加Angular组件所需的依赖。</p>

            <p><em>为什么？</em>：这种技术反映了使用<a href="https://github.com/olov/ng-annotate"><code>ng-annotate</code></a>的技术，这就是我推荐的对依赖关系进行自动化创建安全压缩的方式，如果<code>ng-annotate</code>检测到已经有了注入，那么它就不会再次重复执行。</p>

            <p><em>为什么？</em>：可以避免依赖变成其它Angular找不到的变量，例如，<code>common</code>和<code>dataservice</code>可能会变成<code>a</code>或者<code>b</code>。</p>

            <p><em>为什么？</em>：避免创建内嵌的依赖，因为一个数组太长不利于阅读，此外，内嵌的方式也会让人感到困惑，比如数组是一系列的字符串，但是最后一个却是组件的function。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>Dashboard<span class="pl-pds">'</span></span>,
        [<span class="pl-s"><span class="pl-pds">'</span>$location<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>$routeParams<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>common<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>dataservice<span class="pl-pds">'</span></span>,
            <span class="pl-k">function</span> <span class="pl-en">Dashboard</span>(<span class="pl-smi">$location</span>, <span class="pl-smi">$routeParams</span>, <span class="pl-smi">common</span>, <span class="pl-smi">dataservice</span>) {}
        ]);</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>Dashboard<span class="pl-pds">'</span></span>,
      [<span class="pl-s"><span class="pl-pds">'</span>$location<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>$routeParams<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>common<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>dataservice<span class="pl-pds">'</span></span>, Dashboard]);

<span class="pl-k">function</span> <span class="pl-en">Dashboard</span>(<span class="pl-smi">$location</span>, <span class="pl-smi">$routeParams</span>, <span class="pl-smi">common</span>, <span class="pl-smi">dataservice</span>) {
}</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>Dashboard<span class="pl-pds">'</span></span>, Dashboard);

<span class="pl-smi">Dashboard</span>.<span class="pl-smi">$inject</span> <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>$location<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>$routeParams<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>common<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>dataservice<span class="pl-pds">'</span></span>];

<span class="pl-k">function</span> <span class="pl-en">Dashboard</span>(<span class="pl-smi">$location</span>, <span class="pl-smi">$routeParams</span>, <span class="pl-smi">common</span>, <span class="pl-smi">dataservice</span>) {
}</pre></div>

            <p>注意：当你的函数处于return语句后面，那么<code>$inject</code>是无法访问的（这会在directive中发生），你可以通过把Controller移到directive外面来解决这个问题。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* avoid */</span>
<span class="pl-c">// inside a directive definition</span>
<span class="pl-k">function</span> <span class="pl-en">outer</span>() {
    <span class="pl-k">var</span> ddo <span class="pl-k">=</span> {
        controller<span class="pl-k">:</span> DashboardPanelController,
        controllerAs<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>vm<span class="pl-pds">'</span></span>
    };
    <span class="pl-k">return</span> ddo;

    <span class="pl-smi">DashboardPanelController</span>.<span class="pl-smi">$inject</span> <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>logger<span class="pl-pds">'</span></span>]; <span class="pl-c">// Unreachable</span>
    <span class="pl-k">function</span> <span class="pl-en">DashboardPanelController</span>(<span class="pl-smi">logger</span>) {
    }
}</pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
<span class="pl-c">// outside a directive definition</span>
<span class="pl-k">function</span> <span class="pl-en">outer</span>() {
    <span class="pl-k">var</span> ddo <span class="pl-k">=</span> {
        controller<span class="pl-k">:</span> DashboardPanelController,
        controllerAs<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>vm<span class="pl-pds">'</span></span>
    };
    <span class="pl-k">return</span> ddo;
}

<span class="pl-smi">DashboardPanelController</span>.<span class="pl-smi">$inject</span> <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>logger<span class="pl-pds">'</span></span>];
<span class="pl-k">function</span> <span class="pl-en">DashboardPanelController</span>(<span class="pl-smi">logger</span>) {
}</pre></div></li>
    </ul>

    <h3><a id="user-content-手动确定路由解析器依赖" class="anchor" href="#手动确定路由解析器依赖" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>手动确定路由解析器依赖</h3>

    <h6><a id="user-content-style-y092" class="anchor" href="#style-y092" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y092">Y092</a>]</h6>

    <ul>
        <li><p>用<code>$inject</code>手动给Angular组件添加路由解析器依赖。</p>

            <p><em>为什么？</em>：这种技术打破了路由解析的匿名函数的形式，易读。</p>

            <p><em>为什么？</em>：<code>$inject</code>语句可以让任何依赖都可以安全压缩。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
<span class="pl-k">function</span> <span class="pl-en">config</span> (<span class="pl-smi">$routeProvider</span>) {
    $routeProvider
        .<span class="pl-en">when</span>(<span class="pl-s"><span class="pl-pds">'</span>/avengers<span class="pl-pds">'</span></span>, {
            templateUrl<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>avengers.html<span class="pl-pds">'</span></span>,
            controller<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>AvengersController<span class="pl-pds">'</span></span>,
            controllerAs<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>vm<span class="pl-pds">'</span></span>,
            resolve<span class="pl-k">:</span> {
                moviesPrepService<span class="pl-k">:</span> moviesPrepService
            }
        });
}

<span class="pl-smi">moviesPrepService</span>.<span class="pl-smi">$inject</span> <span class="pl-k">=</span>  [<span class="pl-s"><span class="pl-pds">'</span>movieService<span class="pl-pds">'</span></span>];
<span class="pl-k">function</span> <span class="pl-en">moviesPrepService</span>(<span class="pl-smi">movieService</span>) {
    <span class="pl-k">return</span> <span class="pl-smi">movieService</span>.<span class="pl-en">getMovies</span>();
}</pre></div></li>
    </ul>

    <p><strong><a href="#%E7%9B%AE%E5%BD%95">返回顶部</a></strong></p>

    <h2><a id="user-content-压缩和注释" class="anchor" href="#压缩和注释" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>压缩和注释</h2>

    <h3><a id="user-content-ng-annotate" class="anchor" href="#ng-annotate" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ng-annotate</h3>

    <h6><a id="user-content-style-y100" class="anchor" href="#style-y100" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y100">Y100</a>]</h6>

    <ul>
        <li><p>在<a href="http://gulpjs.com">Gulp</a>或<a href="http://gruntjs.com">Grunt</a>中使用<a href="//github.com/olov/ng-annotate">ng-annotate</a>，用<code>/** @ngInject */</code>对需要自动依赖注入的function进行注释。</p>

            <p><em>为什么？</em>：可以避免代码中的依赖使用到任何不安全的写法。</p>

            <p><em>为什么？</em>：不推荐用<a href="https://github.com/btford/ngmin"><code>ng-min</code></a>。</p>

            <blockquote>
                <p>我更喜欢Gulp，因为我觉得它是易写易读易调试的。</p>
            </blockquote>

            <p>下面的代码没有注入依赖，显然压缩是不安全的。</p>

            <div class="highlight highlight-source-js"><pre>angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>Avengers<span class="pl-pds">'</span></span>, Avengers);

<span class="pl-c">/* @ngInject */</span>
<span class="pl-k">function</span> <span class="pl-en">Avengers</span> (<span class="pl-smi">storageService</span>, <span class="pl-smi">avengerService</span>) {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;
    <span class="pl-smi">vm</span>.<span class="pl-smi">heroSearch</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>;
    <span class="pl-smi">vm</span>.<span class="pl-smi">storeHero</span> <span class="pl-k">=</span> storeHero;

    <span class="pl-k">function</span> <span class="pl-en">storeHero</span>(){
      <span class="pl-k">var</span> hero <span class="pl-k">=</span> <span class="pl-smi">avengerService</span>.<span class="pl-c1">find</span>(<span class="pl-smi">vm</span>.<span class="pl-smi">heroSearch</span>);
      <span class="pl-smi">storageService</span>.<span class="pl-en">save</span>(<span class="pl-smi">hero</span>.<span class="pl-c1">name</span>, hero);
    }
}</pre></div>

            <p>当上面的代码通过ng-annotate运行时，就会产生如下的带有<code>$inject</code>注释的输出结果，这样的话压缩就会安全了。</p>

            <div class="highlight highlight-source-js"><pre>angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app<span class="pl-pds">'</span></span>)
    .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>Avengers<span class="pl-pds">'</span></span>, Avengers);

<span class="pl-c">/* @ngInject */</span>
<span class="pl-k">function</span> <span class="pl-en">Avengers</span> (<span class="pl-smi">storageService</span>, <span class="pl-smi">avengerService</span>) {
    <span class="pl-k">var</span> vm <span class="pl-k">=</span> <span class="pl-v">this</span>;
    <span class="pl-smi">vm</span>.<span class="pl-smi">heroSearch</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>;
    <span class="pl-smi">vm</span>.<span class="pl-smi">storeHero</span> <span class="pl-k">=</span> storeHero;

    <span class="pl-k">function</span> <span class="pl-en">storeHero</span>(){
      <span class="pl-k">var</span> hero <span class="pl-k">=</span> <span class="pl-smi">avengerService</span>.<span class="pl-c1">find</span>(<span class="pl-smi">vm</span>.<span class="pl-smi">heroSearch</span>);
      <span class="pl-smi">storageService</span>.<span class="pl-en">save</span>(<span class="pl-smi">hero</span>.<span class="pl-c1">name</span>, hero);
    }
}

<span class="pl-smi">Avengers</span>.<span class="pl-smi">$inject</span> <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>storageService<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>avengerService<span class="pl-pds">'</span></span>];</pre></div>

            <p>注意：如果<code>ng-annotate</code>检测到已经有注入了（例如发现了<code>@ngInject</code>），就不会重复生成<code>$inject</code>代码了。</p>

            <p>注意：路由的函数前面也可以用<code>/* @ngInject */</code></p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">// Using @ngInject annotations</span>
<span class="pl-k">function</span> <span class="pl-en">config</span>(<span class="pl-smi">$routeProvider</span>) {
    $routeProvider
        .<span class="pl-en">when</span>(<span class="pl-s"><span class="pl-pds">'</span>/avengers<span class="pl-pds">'</span></span>, {
            templateUrl<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>avengers.html<span class="pl-pds">'</span></span>,
            controller<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Avengers<span class="pl-pds">'</span></span>,
            controllerAs<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>vm<span class="pl-pds">'</span></span>,
            resolve<span class="pl-k">:</span> { <span class="pl-c">/* @ngInject */</span>
                <span class="pl-en">moviesPrepService</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">movieService</span>) {
                    <span class="pl-k">return</span> <span class="pl-smi">movieService</span>.<span class="pl-en">getMovies</span>();
                }
            }
        });
}</pre></div>

            <blockquote>
                <p>注意：从Angular 1.3开始，你就可以用<a href="https://docs.angularjs.org/api/ng/directive/ngApp"><code>ngApp</code></a>指令的 <code>ngStrictDi</code>参数来检测任何可能失去依赖的地方，当以“strict-di”模式创建injector时，会导致应用程序无法调用不使用显示函数注释的函数（这也许无法安全压缩）。记录在控制台的调试信息可以帮助追踪出问题的代码。我只在需要调试的时候才会用到<code>ng-strict-di</code>。
                    <code>&lt;body ng-app="APP" ng-strict-di&gt;</code></p>
            </blockquote></li>
    </ul>

    <h3><a id="user-content-使用gulp或grunt结合ng-annotate" class="anchor" href="#使用gulp或grunt结合ng-annotate" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用Gulp或Grunt结合ng-annotate</h3>

    <h6><a id="user-content-style-y101" class="anchor" href="#style-y101" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y101">Y101</a>]</h6>

    <ul>
        <li><p>在自动化任务中使用<a href="https://www.npmjs.org/package/gulp-ng-annotate">gulp-ng-annotate</a>或<a href="https://www.npmjs.org/package/grunt-ng-annotate">grunt-ng-annotate</a>，把<code>/* @ngInject */</code>注入到任何有依赖关系函数的前面。</p>

            <p><em>为什么？</em>：ng-annotate会捕获大部分的依赖关系，但是有时候需要借助于<code>/* @ngInject */</code>语法提示。</p>

            <p>下面的代码是gulp任务使用ngAnnotate的例子。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-smi">gulp</span>.<span class="pl-en">task</span>(<span class="pl-s"><span class="pl-pds">'</span>js<span class="pl-pds">'</span></span>, [<span class="pl-s"><span class="pl-pds">'</span>jshint<span class="pl-pds">'</span></span>], <span class="pl-k">function</span>() {
    <span class="pl-k">var</span> source <span class="pl-k">=</span> <span class="pl-smi">pkg</span>.<span class="pl-smi">paths</span>.<span class="pl-smi">js</span>;

    <span class="pl-k">return</span> <span class="pl-smi">gulp</span>.<span class="pl-en">src</span>(source)
        .<span class="pl-en">pipe</span>(<span class="pl-smi">sourcemaps</span>.<span class="pl-en">init</span>())
        .<span class="pl-en">pipe</span>(<span class="pl-en">concat</span>(<span class="pl-s"><span class="pl-pds">'</span>all.min.js<span class="pl-pds">'</span></span>, {newLine<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>;<span class="pl-pds">'</span></span>}))
        <span class="pl-c">// Annotate before uglify so the code get's min'd properly.</span>
        .<span class="pl-en">pipe</span>(<span class="pl-en">ngAnnotate</span>({
            <span class="pl-c">// true helps add where @ngInject is not used. It infers.</span>
            <span class="pl-c">// Doesn't work with resolve, so we must be explicit there</span>
            add<span class="pl-k">:</span> <span class="pl-c1">true</span>
        }))
        .<span class="pl-en">pipe</span>(<span class="pl-smi">bytediff</span>.<span class="pl-c1">start</span>())
        .<span class="pl-en">pipe</span>(<span class="pl-en">uglify</span>({mangle<span class="pl-k">:</span> <span class="pl-c1">true</span>}))
        .<span class="pl-en">pipe</span>(<span class="pl-smi">bytediff</span>.<span class="pl-c1">stop</span>())
        .<span class="pl-en">pipe</span>(<span class="pl-smi">sourcemaps</span>.<span class="pl-c1">write</span>(<span class="pl-s"><span class="pl-pds">'</span>./<span class="pl-pds">'</span></span>))
        .<span class="pl-en">pipe</span>(<span class="pl-smi">gulp</span>.<span class="pl-en">dest</span>(<span class="pl-smi">pkg</span>.<span class="pl-smi">paths</span>.<span class="pl-smi">dev</span>));
});
</pre></div></li>
    </ul>

    <p><strong><a href="#%E7%9B%AE%E5%BD%95">返回顶部</a></strong></p>

    <h2><a id="user-content-异常处理" class="anchor" href="#异常处理" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>异常处理</h2>

    <h3><a id="user-content-修饰符" class="anchor" href="#修饰符" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>修饰符</h3>

    <h6><a id="user-content-style-y110" class="anchor" href="#style-y110" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y110">Y110</a>]</h6>

    <ul>
        <li><p>使用一个<a href="https://docs.angularjs.org/api/auto/service/$provide#decorator">decorator</a>，在配置的时候用<a href="https://docs.angularjs.org/api/auto/service/$provide"><code>$provide</code></a>服务，当发生异常时，在<a href="https://docs.angularjs.org/api/ng/service/$exceptionHandler"><code>$exceptionHandler</code></a>服务中执行自定义的处理方法。</p>

            <p><em>为什么？</em>：在开发时和运行时提供了一种统一的方式来处理未被捕获的Angular异常。</p>

            <p>注：另一个选项是用来覆盖service的，这个可以代替decorator，这是一个非常nice的选项，但是如果你想保持默认行为，那么推荐你扩展一个decorator。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>blocks.exception<span class="pl-pds">'</span></span>)
    .<span class="pl-en">config</span>(exceptionConfig);

<span class="pl-smi">exceptionConfig</span>.<span class="pl-smi">$inject</span> <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>$provide<span class="pl-pds">'</span></span>];

<span class="pl-k">function</span> <span class="pl-en">exceptionConfig</span>(<span class="pl-smi">$provide</span>) {
    <span class="pl-smi">$provide</span>.<span class="pl-en">decorator</span>(<span class="pl-s"><span class="pl-pds">'</span>$exceptionHandler<span class="pl-pds">'</span></span>, extendExceptionHandler);
}

<span class="pl-smi">extendExceptionHandler</span>.<span class="pl-smi">$inject</span> <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>$delegate<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>toastr<span class="pl-pds">'</span></span>];

<span class="pl-k">function</span> <span class="pl-en">extendExceptionHandler</span>(<span class="pl-smi">$delegate</span>, <span class="pl-smi">toastr</span>) {
    <span class="pl-k">return</span> <span class="pl-k">function</span>(<span class="pl-smi">exception</span>, <span class="pl-smi">cause</span>) {
        <span class="pl-en">$delegate</span>(exception, cause);
        <span class="pl-k">var</span> errorData <span class="pl-k">=</span> {
          exception<span class="pl-k">:</span> exception,
          cause<span class="pl-k">:</span> cause
        };
        <span class="pl-c">/**</span>
<span class="pl-c">         * Could add the error to a service's collection,</span>
<span class="pl-c">         * add errors to $rootScope, log errors to remote web server,</span>
<span class="pl-c">         * or log locally. Or throw hard. It is entirely up to you.</span>
<span class="pl-c">         * throw exception;</span>
<span class="pl-c">         */</span>
        <span class="pl-smi">toastr</span>.<span class="pl-en">error</span>(<span class="pl-smi">exception</span>.<span class="pl-smi">msg</span>, errorData);
    };
}</pre></div></li>
    </ul>

    <h3><a id="user-content-异常捕获器" class="anchor" href="#异常捕获器" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>异常捕获器</h3>

    <h6><a id="user-content-style-y111" class="anchor" href="#style-y111" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y111">Y111</a>]</h6>

    <ul>
        <li><p>创建一个暴露了一个接口的factory来捕获异常并以合适方式处理异常。</p>

            <p><em>为什么？</em>：提供了一个统一的方法来捕获代码中抛出的异常。</p>

            <p>注：异常捕获器对特殊异常的捕获和反应是非常友好的，例如，使用XHR从远程服务获取数据时，你想要捕获所有异常并做出不同的反应。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>blocks.exception<span class="pl-pds">'</span></span>)
    .<span class="pl-en">factory</span>(<span class="pl-s"><span class="pl-pds">'</span>exception<span class="pl-pds">'</span></span>, exception);

<span class="pl-smi">exception</span>.<span class="pl-smi">$inject</span> <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>logger<span class="pl-pds">'</span></span>];

<span class="pl-k">function</span> <span class="pl-en">exception</span>(<span class="pl-smi">logger</span>) {
    <span class="pl-k">var</span> service <span class="pl-k">=</span> {
        catcher<span class="pl-k">:</span> catcher
    };
    <span class="pl-k">return</span> service;

    <span class="pl-k">function</span> <span class="pl-en">catcher</span>(<span class="pl-smi">message</span>) {
        <span class="pl-k">return</span> <span class="pl-k">function</span>(<span class="pl-smi">reason</span>) {
            <span class="pl-smi">logger</span>.<span class="pl-en">error</span>(message, reason);
        };
    }
}</pre></div></li>
    </ul>

    <h3><a id="user-content-路由错误" class="anchor" href="#路由错误" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>路由错误</h3>

    <h6><a id="user-content-style-y112" class="anchor" href="#style-y112" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y112">Y112</a>]</h6>

    <ul>
        <li><p>用<a href="https://docs.angularjs.org/api/ngRoute/service/$route#$routeChangeError"><code>$routeChangeError</code></a>来处理并打印出所有的路由错误信息。</p>

            <p><em>为什么？</em>：提供一个统一的方式来处理所有的路由错误。</p>

            <p><em>为什么？</em>：当一个路由发生错误的时候，可以给展示一个提示信息，提高用户体验。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/* recommended */</span>
<span class="pl-k">var</span> handlingRouteChangeError <span class="pl-k">=</span> <span class="pl-c1">false</span>;

<span class="pl-k">function</span> <span class="pl-en">handleRoutingErrors</span>() {
    <span class="pl-c">/**</span>
<span class="pl-c">     * Route cancellation:</span>
<span class="pl-c">     * On routing error, go to the dashboard.</span>
<span class="pl-c">     * Provide an exit clause if it tries to do it twice.</span>
<span class="pl-c">     */</span>
    <span class="pl-smi">$rootScope</span>.<span class="pl-en">$on</span>(<span class="pl-s"><span class="pl-pds">'</span>$routeChangeError<span class="pl-pds">'</span></span>,
        <span class="pl-k">function</span>(<span class="pl-c1">event</span>, <span class="pl-smi">current</span>, <span class="pl-smi">previous</span>, <span class="pl-smi">rejection</span>) {
            <span class="pl-k">if</span> (handlingRouteChangeError) { <span class="pl-k">return</span>; }
            handlingRouteChangeError <span class="pl-k">=</span> <span class="pl-c1">true</span>;
            <span class="pl-k">var</span> destination <span class="pl-k">=</span> (current <span class="pl-k">&amp;&amp;</span> (<span class="pl-smi">current</span>.<span class="pl-c1">title</span> <span class="pl-k">||</span>
                <span class="pl-smi">current</span>.<span class="pl-c1">name</span> <span class="pl-k">||</span> <span class="pl-smi">current</span>.<span class="pl-smi">loadedTemplateUrl</span>)) <span class="pl-k">||</span>
                <span class="pl-s"><span class="pl-pds">'</span>unknown target<span class="pl-pds">'</span></span>;
            <span class="pl-k">var</span> msg <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Error routing to <span class="pl-pds">'</span></span> <span class="pl-k">+</span> destination <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span>. <span class="pl-pds">'</span></span> <span class="pl-k">+</span>
                (<span class="pl-smi">rejection</span>.<span class="pl-smi">msg</span> <span class="pl-k">||</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>);

            <span class="pl-c">/**</span>
<span class="pl-c">             * Optionally log using a custom service or $log.</span>
<span class="pl-c">             * (Don't forget to inject custom service)</span>
<span class="pl-c">             */</span>
            <span class="pl-smi">logger</span>.<span class="pl-en">warning</span>(msg, [current]);

            <span class="pl-c">/**</span>
<span class="pl-c">             * On routing error, go to another route/state.</span>
<span class="pl-c">             */</span>
            <span class="pl-smi">$location</span>.<span class="pl-en">path</span>(<span class="pl-s"><span class="pl-pds">'</span>/<span class="pl-pds">'</span></span>);

        }
    );
}</pre></div></li>
    </ul>

    <p><strong><a href="#%E7%9B%AE%E5%BD%95">返回顶部</a></strong></p>

    <h2><a id="user-content-命名" class="anchor" href="#命名" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>命名</h2>

    <h3><a id="user-content-命名原则" class="anchor" href="#命名原则" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>命名原则</h3>

    <h6><a id="user-content-style-y120" class="anchor" href="#style-y120" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y120">Y120</a>]</h6>

    <ul>
        <li><p>遵循以描述组件功能，然后是类型（可选）的方式来给所有的组件提供统一的命名，我推荐的做法是<code>feature.type.js</code>。大多数文件都有2个名字。</p>

            <ul>
                <li>  文件名 (<code>avengers.controller.js</code>)</li>
                <li>  带有Angular的注册组件名 (<code>AvengersController</code>)</li>
            </ul>

            <p><em>为什么？</em>：命名约定有助于为一目了然地找到内容提供一个统一的方式，在项目中和团队中保持统一性是非常重要的，保持统一性对于跨公司来说提供了巨大的效率。</p>

            <p><em>为什么？</em>：命名约定应该只为代码的检索和沟通提供方便。</p></li>
    </ul>

    <h3><a id="user-content-功能文件命名" class="anchor" href="#功能文件命名" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>功能文件命名</h3>

    <h6><a id="user-content-style-y121" class="anchor" href="#style-y121" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y121">Y121</a>]</h6>

    <ul>
        <li><p>遵循以“描述组件功能.类型（可选）”的方式来给所有的组件提供统一的命名，我推荐的做法是<code>feature.type.js</code>。</p>

            <p><em>为什么？</em>：为快速识别组件提供了统一的方式。</p>

            <p><em>为什么？</em>：为任何自动化的任务提供模式匹配。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/**</span>
<span class="pl-c"> * common options</span>
<span class="pl-c"> */</span>

<span class="pl-c">// Controllers</span>
<span class="pl-smi">avengers</span>.<span class="pl-smi">js</span>
<span class="pl-smi">avengers</span>.<span class="pl-smi">controller</span>.<span class="pl-smi">js</span>
<span class="pl-smi">avengersController</span>.<span class="pl-smi">js</span>

<span class="pl-c">// Services/Factories</span>
<span class="pl-smi">logger</span>.<span class="pl-smi">js</span>
<span class="pl-smi">logger</span>.<span class="pl-smi">service</span>.<span class="pl-smi">js</span>
<span class="pl-smi">loggerService</span>.<span class="pl-smi">js</span></pre></div>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/**</span>
<span class="pl-c"> * recommended</span>
<span class="pl-c"> */</span>

<span class="pl-c">// controllers</span>
<span class="pl-smi">avengers</span>.<span class="pl-smi">controller</span>.<span class="pl-smi">js</span>
<span class="pl-smi">avengers</span>.<span class="pl-smi">controller</span>.<span class="pl-smi">spec</span>.<span class="pl-smi">js</span>

<span class="pl-c">// services/factories</span>
<span class="pl-smi">logger</span>.<span class="pl-smi">service</span>.<span class="pl-smi">js</span>
<span class="pl-smi">logger</span>.<span class="pl-smi">service</span>.<span class="pl-smi">spec</span>.<span class="pl-smi">js</span>

<span class="pl-c">// constants</span>
<span class="pl-smi">constants</span>.<span class="pl-smi">js</span>

<span class="pl-c">// module definition</span>
<span class="pl-smi">avengers</span>.<span class="pl-smi">module</span>.<span class="pl-smi">js</span>

<span class="pl-c">// routes</span>
<span class="pl-smi">avengers</span>.<span class="pl-smi">routes</span>.<span class="pl-smi">js</span>
<span class="pl-smi">avengers</span>.<span class="pl-smi">routes</span>.<span class="pl-smi">spec</span>.<span class="pl-smi">js</span>

<span class="pl-c">// configuration</span>
<span class="pl-smi">avengers</span>.<span class="pl-smi">config</span>.<span class="pl-smi">js</span>

<span class="pl-c">// directives</span>
avenger<span class="pl-k">-</span><span class="pl-smi">profile</span>.<span class="pl-smi">directive</span>.<span class="pl-smi">js</span>
avenger<span class="pl-k">-</span><span class="pl-smi">profile</span>.<span class="pl-smi">directive</span>.<span class="pl-smi">spec</span>.<span class="pl-smi">js</span></pre></div>

            <p>注意：另外一种常见的约定就是不要用<code>controller</code>这个词来给controller文件命名，例如不要用<code>avengers.controller.js</code>，而是用<code>avengers.js</code>。所有其它的约定都坚持使用类型作为后缀，但是controller是组件中最为常用的类型，因此这种做法的好处貌似仅仅是节省了打字，但是仍然很容易识别。我建议你为你的团队选择一种约定，并且要保持统一性。我喜欢的命名方式是<code>avengers.controller.js</code>。</p>

            <div class="highlight highlight-source-js"><pre>  <span class="pl-c">/**</span>
<span class="pl-c">   * recommended</span>
<span class="pl-c">   */</span>
  <span class="pl-c">// Controllers</span>
  <span class="pl-smi">avengers</span>.<span class="pl-smi">js</span>
  <span class="pl-smi">avengers</span>.<span class="pl-smi">spec</span>.<span class="pl-smi">js</span></pre></div></li>
    </ul>

    <h3><a id="user-content-测试文件命名" class="anchor" href="#测试文件命名" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试文件命名</h3>

    <h6><a id="user-content-style-y122" class="anchor" href="#style-y122" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y122">Y122</a>]</h6>

    <ul>
        <li><p>和组件命名差不多，带上一个<code>spec</code>后缀。</p>

            <p><em>为什么？</em>：为快速识别组件提供统一的方式。</p>

            <p><em>为什么？</em>：为<a href="http://karma-runner.github.io/">karma</a>或是其它测试运行器提供模式匹配。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/**</span>
<span class="pl-c"> * recommended</span>
<span class="pl-c"> */</span>
<span class="pl-smi">avengers</span>.<span class="pl-smi">controller</span>.<span class="pl-smi">spec</span>.<span class="pl-smi">js</span>
<span class="pl-smi">logger</span>.<span class="pl-smi">service</span>.<span class="pl-smi">spec</span>.<span class="pl-smi">js</span>
<span class="pl-smi">avengers</span>.<span class="pl-smi">routes</span>.<span class="pl-smi">spec</span>.<span class="pl-smi">js</span>
avenger<span class="pl-k">-</span><span class="pl-smi">profile</span>.<span class="pl-smi">directive</span>.<span class="pl-smi">spec</span>.<span class="pl-smi">js</span></pre></div></li>
    </ul>

    <h3><a id="user-content-controller命名" class="anchor" href="#controller命名" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Controller命名</h3>

    <h6><a id="user-content-style-y123" class="anchor" href="#style-y123" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y123">Y123</a>]</h6>

    <ul>
        <li><p>为所有controller提供统一的名称，先特征后名字，鉴于controller是构造函数，所以要采用UpperCamelCase（每个单词首字母大写）的方式。</p>

            <p><em>为什么？</em>：为快速识别和引用controller提供统一的方式。</p>

            <p><em>为什么？</em>：UpperCamelCase是常规的识别一个可以用构造函数来实例化的对象的方式。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/**</span>
<span class="pl-c"> * recommended</span>
<span class="pl-c"> */</span>

<span class="pl-c">// avengers.controller.js</span>
angular
    .<span class="pl-smi">module</span>
    .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>HeroAvengersController<span class="pl-pds">'</span></span>, HeroAvengersController);

<span class="pl-k">function</span> <span class="pl-en">HeroAvengers</span>(){ }</pre></div></li>
    </ul>

    <h3><a id="user-content-controller命名后缀" class="anchor" href="#controller命名后缀" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Controller命名后缀</h3>

    <h6><a id="user-content-style-y124" class="anchor" href="#style-y124" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y124">Y124</a>]</h6>

    <ul>
        <li><p>使用<code>Controller</code>。</p>

            <p><em>为什么？</em>：<code>Controller</code>使用更广泛、更明确、更具有描述性。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/**</span>
<span class="pl-c"> * recommended</span>
<span class="pl-c"> */</span>

<span class="pl-c">// avengers.controller.js</span>
angular
    .<span class="pl-smi">module</span>
    .<span class="pl-en">controller</span>(<span class="pl-s"><span class="pl-pds">'</span>AvengersController<span class="pl-pds">'</span></span>, AvengersController);

<span class="pl-k">function</span> <span class="pl-en">AvengersController</span>(){ }</pre></div></li>
    </ul>

    <h3><a id="user-content-factory命名" class="anchor" href="#factory命名" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Factory命名</h3>

    <h6><a id="user-content-style-y125" class="anchor" href="#style-y125" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y125">Y125</a>]</h6>

    <ul>
        <li><p>一样要统一，对service和factory使用camel-casing（驼峰式，第一个单词首字母小写，后面单词首字母大写）方式。避免使用<code>$</code>前缀。</p>

            <p><em>为什么？</em>：可以快速识别和引用factory。</p>

            <p><em>为什么？</em>：避免与内部使用<code>$</code>前缀的服务发生冲突。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/**</span>
<span class="pl-c"> * recommended</span>
<span class="pl-c"> */</span>

<span class="pl-c">// logger.service.js</span>
angular
    .<span class="pl-smi">module</span>
    .<span class="pl-en">factory</span>(<span class="pl-s"><span class="pl-pds">'</span>logger<span class="pl-pds">'</span></span>, logger);

<span class="pl-k">function</span> <span class="pl-en">logger</span>(){ }</pre></div></li>
    </ul>

    <h3><a id="user-content-directive组件命名" class="anchor" href="#directive组件命名" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Directive组件命名</h3>

    <h6><a id="user-content-style-y126" class="anchor" href="#style-y126" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y126">Y126</a>]</h6>

    <ul>
        <li><p>使用camel-case方式，用一个短的前缀来描述directive在哪个区域使用（一些例子中是使用公司前缀或是项目前缀）。</p>

            <p><em>为什么？</em>：可以快速识别和引用controller。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">/**</span>
<span class="pl-c"> * recommended</span>
<span class="pl-c"> */</span>

<span class="pl-c">// avenger-profile.directive.js</span>
angular
    .<span class="pl-smi">module</span>
    .<span class="pl-en">directive</span>(<span class="pl-s"><span class="pl-pds">'</span>xxAvengerProfile<span class="pl-pds">'</span></span>, xxAvengerProfile);

<span class="pl-c">// usage is &lt;xx-avenger-profile&gt; &lt;/xx-avenger-profile&gt;</span>

<span class="pl-k">function</span> <span class="pl-en">xxAvengerProfile</span>(){ }</pre></div></li>
    </ul>

    <h3><a id="user-content-模块" class="anchor" href="#模块" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模块</h3>

    <h6><a id="user-content-style-y127" class="anchor" href="#style-y127" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y127">Y127</a>]</h6>

    <ul>
        <li><p>当有很多的模块时，主模块文件命名成<code>app.module.js</code>，其它依赖模块以它们代表的内容来命名。例如，一个管理员模块命名成<code>admin.module.js</code>，它们各自的注册模块名字就是<code>app</code>和<code>admin</code>。</p>

            <p><em>为什么？</em>：给多模块的应用提供统一的方式，这也是为了扩展大型应用。</p>

            <p><em>为什么？</em>：对使用任务来自动化加载所有模块的定义（先）和其它所有的angular文件（后）提供了一种简单的方式。</p></li>
    </ul>

    <h3><a id="user-content-配置" class="anchor" href="#配置" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>配置</h3>

    <h6><a id="user-content-style-y128" class="anchor" href="#style-y128" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y128">Y128</a>]</h6>

    <ul>
        <li><p>把一个模块的配置独立到它自己的文件中，以这个模块为基础命名。<code>app</code>模块的配置文件命名成<code>app.config.js</code>（或是<code>config.js</code>），<code>admin.module.js</code>的配置文件命名成<code>admin.config.js</code>。</p>

            <p><em>为什么？</em>：把配置从模块定义、组件和活跃代码中分离出来。</p>

            <p><em>为什么？</em>：为设置模块的配置提供了一个可识别的地方。</p></li>
    </ul>

    <h3><a id="user-content-路由" class="anchor" href="#路由" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>路由</h3>

    <h6><a id="user-content-style-y129" class="anchor" href="#style-y129" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y129">Y129</a>]</h6>

    <ul>
        <li>把路由的配置独立到单独的文件。主模块的路由可能是<code>app.route.js</code>，<code>admin</code>模块的路由可能是<code>admin.route.js</code>。即使是在很小的应用中，我也喜欢把路由的配置从其余的配置中分离出来。</li>
    </ul>

    <p><strong><a href="#%E7%9B%AE%E5%BD%95">返回顶部</a></strong></p>

    <h2><a id="user-content-常量" class="anchor" href="#常量" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>常量</h2>

    <h3><a id="user-content-供应全局变量" class="anchor" href="#供应全局变量" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>供应全局变量</h3>

    <h6><a id="user-content-style-y240" class="anchor" href="#style-y240" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y240">Y240</a>]</h6>

    <ul>
        <li><p>为供应库中的全局变量创建一个Angular常量。</p>

            <p><em>为什么？</em>：提供一种注入到供应库的方法，否则就是全局变量。通过让你更容易地了解你的组件之间的依赖关系来提高代码的可测试性。这还允许你模拟这些依赖关系，这是很有意义的。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">// constants.js</span>

<span class="pl-c">/* global toastr:false, moment:false */</span>
(<span class="pl-k">function</span>() {
    <span class="pl-s"><span class="pl-pds">'</span>use strict<span class="pl-pds">'</span></span>;

    angular
        .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app.core<span class="pl-pds">'</span></span>)
        .<span class="pl-en">constant</span>(<span class="pl-s"><span class="pl-pds">'</span>toastr<span class="pl-pds">'</span></span>, toastr)
        .<span class="pl-en">constant</span>(<span class="pl-s"><span class="pl-pds">'</span>moment<span class="pl-pds">'</span></span>, moment);
})();</pre></div></li>
    </ul>

    <h6><a id="user-content-style-y241" class="anchor" href="#style-y241" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>[Style <a href="#style-y241">Y241</a>]</h6>

    <ul>
        <li><p>对于一些不需要变动，也不需要从其它service中获取的值，使用常量定义，当一些常量只是在一个模块中使用但是有可能会在其它应用中使用的话，把它们写到一个以当前的模块命名的文件中。把常量集合到一起是非常有必要的，你可以把它们写到<code>constants.js</code>的文件中。</p>

            <p><em>为什么？</em>：一个可能变化的值，即使变动的很少，也会从service中重新被检索，因此你不需要修改源代码。例如，一个数据服务的url可以被放到一个常量中，但是更好的的做法是把它放到一个web service中。</p>

            <p><em>为什么？</em>：常量可以被注入到任何angular组件中，包括providers。</p>

            <p><em>为什么？</em>：当一个应用程序被分割成很多可以在其它应用程序中复用的小模块时，每个独立的模块都应该可以操作它自己包含的相关常量。</p>

            <div class="highlight highlight-source-js"><pre><span class="pl-c">// Constants used by the entire app</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app.core<span class="pl-pds">'</span></span>)
    .<span class="pl-en">constant</span>(<span class="pl-s"><span class="pl-pds">'</span>moment<span class="pl-pds">'</span></span>, moment);

<span class="pl-c">// Constants used only by the sales module</span>
angular
    .<span class="pl-en">module</span>(<span class="pl-s"><span class="pl-pds">'</span>app.sales<span class="pl-pds">'</span></span>)
    .<span class="pl-en">constant</span>(<span class="pl-s"><span class="pl-pds">'</span>events<span class="pl-pds">'</span></span>, {
        ORDER_CREATED<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>event_order_created<span class="pl-pds">'</span></span>,
        INVENTORY_DEPLETED<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>event_inventory_depleted<span class="pl-pds">'</span></span>
    });</pre></div></li>
    </ul>

    <p><strong><a href="#%E7%9B%AE%E5%BD%95">返回顶部</a></strong></p>
</article>
</div>